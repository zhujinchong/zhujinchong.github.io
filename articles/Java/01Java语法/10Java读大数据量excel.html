<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>1. Excel2003与Excel2007 | Make each day count, Make learning a habit.</title>
    <meta name="description" content="一只程序猿">
    <link rel="preload stylesheet" href="/assets/style.054597be.css" as="style">
    
    <script type="module" src="/assets/app.dc5e2f50.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.2ed14f66.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/assets/chunks/framework.2516552c.js">
    <link rel="modulepreload" href="/assets/chunks/theme.2359dc4a.js">
    <link rel="modulepreload" href="/assets/articles_Java_01Java语法_10Java读大数据量excel.md.a481ce92.lean.js">
    <link rel="icon" href="/img/home.svg">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-5a346dfe><!--[--><!--]--><!--[--><span tabindex="-1" data-v-0f60ec36></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-0f60ec36> Skip to content </a><!--]--><!----><header class="VPNav" data-v-5a346dfe data-v-ae24b3ad><div class="VPNavBar has-sidebar" data-v-ae24b3ad data-v-a0fd61f4><div class="container" data-v-a0fd61f4><div class="title" data-v-a0fd61f4><div class="VPNavBarTitle has-sidebar" data-v-a0fd61f4 data-v-86d1bed8><a class="title" href="/" data-v-86d1bed8><!--[--><!--]--><!----><!--[-->Home<!--]--><!--[--><!--]--></a></div></div><div class="content" data-v-a0fd61f4><div class="curtain" data-v-a0fd61f4></div><div class="content-body" data-v-a0fd61f4><!--[--><!--]--><div class="VPNavBarSearch search" data-v-a0fd61f4><!----></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-a0fd61f4 data-v-7f418b0f><span id="main-nav-aria-label" class="visually-hidden" data-v-7f418b0f>Main Navigation</span><!--[--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-7f418b0f data-v-9c007e85><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-9c007e85><span class="text" data-v-9c007e85><!----><span data-v-9c007e85>Java</span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-9c007e85><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-9c007e85><div class="VPMenu" data-v-9c007e85 data-v-e7ea1737><div class="items" data-v-e7ea1737><!--[--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/articles/Java/01Java语法/" data-v-43f1e123><!--[-->01Java语法<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/articles/Java/02HTML+CSS+JS+XML/" data-v-43f1e123><!--[-->02HTML+CSS+JS+XML<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/articles/Java/03JavaWeb基础tomcat servlet jsp/" data-v-43f1e123><!--[-->03JavaWeb基础tomcat servlet jsp<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/articles/Java/05Maven/" data-v-43f1e123><!--[-->05Maven<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/articles/Java/20mysql/" data-v-43f1e123><!--[-->20mysql<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/articles/Java/22JanusGraph/" data-v-43f1e123><!--[-->22JanusGraph<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/articles/Java/30设计模式/" data-v-43f1e123><!--[-->30设计模式<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/articles/Java/31Java并发编程/" data-v-43f1e123><!--[-->31Java并发编程<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/articles/Java/51SpringBoot/" data-v-43f1e123><!--[-->51SpringBoot<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/articles/Java/52SpringCloud/" data-v-43f1e123><!--[-->52SpringCloud<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/articles/Java/53Arthus/" data-v-43f1e123><!--[-->53Arthus<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/articles/Java/60kafka/" data-v-43f1e123><!--[-->60kafka<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/articles/Java/61ElasticSearch/" data-v-43f1e123><!--[-->61ElasticSearch<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/articles/Java/65redis/" data-v-43f1e123><!--[-->65redis<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/articles/Java/65vue/" data-v-43f1e123><!--[-->65vue<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/articles/Java/66jenkins/" data-v-43f1e123><!--[-->66jenkins<!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-7f418b0f data-v-9c007e85><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-9c007e85><span class="text" data-v-9c007e85><!----><span data-v-9c007e85>blog</span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-9c007e85><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-9c007e85><div class="VPMenu" data-v-9c007e85 data-v-e7ea1737><div class="items" data-v-e7ea1737><!--[--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/articles/blog/Huggingface教程/" data-v-43f1e123><!--[-->Huggingface教程<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/articles/blog/vitepress/" data-v-43f1e123><!--[-->vitepress<!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/articles/windows/" tabindex="0" data-v-7f418b0f data-v-42ef59de><!--[--><span data-v-42ef59de>windows</span><!--]--></a><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-7f418b0f data-v-9c007e85><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-9c007e85><span class="text" data-v-9c007e85><!----><span data-v-9c007e85>全栈</span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-9c007e85><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-9c007e85><div class="VPMenu" data-v-9c007e85 data-v-e7ea1737><div class="items" data-v-e7ea1737><!--[--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/articles/全栈/Docker/" data-v-43f1e123><!--[-->Docker<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/articles/全栈/Git/" data-v-43f1e123><!--[-->Git<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/articles/全栈/Linux/" data-v-43f1e123><!--[-->Linux<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/articles/全栈/Nginx/" data-v-43f1e123><!--[-->Nginx<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/articles/全栈/k8s/" data-v-43f1e123><!--[-->k8s<!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-7f418b0f data-v-9c007e85><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-9c007e85><span class="text" data-v-9c007e85><!----><span data-v-9c007e85>算法</span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-9c007e85><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-9c007e85><div class="VPMenu" data-v-9c007e85 data-v-e7ea1737><div class="items" data-v-e7ea1737><!--[--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/articles/算法/01python语法&amp;工具/" data-v-43f1e123><!--[-->01python语法&amp;工具<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/articles/算法/10白板推导系列/" data-v-43f1e123><!--[-->10白板推导系列<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/articles/算法/11强化学习/" data-v-43f1e123><!--[-->11强化学习<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/articles/算法/12LLM/" data-v-43f1e123><!--[-->12LLM<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/articles/算法/12机器学习笔记/" data-v-43f1e123><!--[-->12机器学习笔记<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/articles/算法/21模型部署/" data-v-43f1e123><!--[-->21模型部署<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/articles/算法/22模型训练和微调/" data-v-43f1e123><!--[-->22模型训练和微调<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/articles/算法/23LangChain/" data-v-43f1e123><!--[-->23LangChain<!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/about/" tabindex="0" data-v-7f418b0f data-v-42ef59de><!--[--><span data-v-42ef59de>About</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-a0fd61f4 data-v-e6aabb21><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="toggle dark mode" aria-checked="false" data-v-e6aabb21 data-v-ce54a7d1 data-v-b1685198><span class="check" data-v-b1685198><span class="icon" data-v-b1685198><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-ce54a7d1><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-ce54a7d1><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div><!----><div class="VPFlyout VPNavBarExtra extra" data-v-a0fd61f4 data-v-40855f84 data-v-9c007e85><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-9c007e85><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-9c007e85><circle cx="12" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="5" cy="12" r="2"></circle></svg></button><div class="menu" data-v-9c007e85><div class="VPMenu" data-v-9c007e85 data-v-e7ea1737><!----><!--[--><!--[--><!----><div class="group" data-v-40855f84><div class="item appearance" data-v-40855f84><p class="label" data-v-40855f84>Appearance</p><div class="appearance-action" data-v-40855f84><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="toggle dark mode" aria-checked="false" data-v-40855f84 data-v-ce54a7d1 data-v-b1685198><span class="check" data-v-b1685198><span class="icon" data-v-b1685198><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-ce54a7d1><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-ce54a7d1><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div></div></div><!----><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-a0fd61f4 data-v-e5dd9c1c><span class="container" data-v-e5dd9c1c><span class="top" data-v-e5dd9c1c></span><span class="middle" data-v-e5dd9c1c></span><span class="bottom" data-v-e5dd9c1c></span></span></button></div></div></div></div><!----></header><div class="VPLocalNav reached-top" data-v-5a346dfe data-v-79c8c1df><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-79c8c1df><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="menu-icon" data-v-79c8c1df><path d="M17,11H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,11,17,11z"></path><path d="M21,7H3C2.4,7,2,6.6,2,6s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,7,21,7z"></path><path d="M21,15H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,15,21,15z"></path><path d="M17,19H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,19,17,19z"></path></svg><span class="menu-text" data-v-79c8c1df>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-79c8c1df data-v-1c15a60a><button data-v-1c15a60a>Return to top</button><!----></div></div><aside class="VPSidebar" data-v-5a346dfe data-v-b00e2fdd><div class="curtain" data-v-b00e2fdd></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-b00e2fdd><span class="visually-hidden" id="sidebar-aria-label" data-v-b00e2fdd> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="group" data-v-b00e2fdd><section class="VPSidebarItem level-0 has-active" data-v-b00e2fdd data-v-e31bd47b><div class="item" role="button" tabindex="0" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><h2 class="text" data-v-e31bd47b>01Java语法</h2><!----></div><div class="items" data-v-e31bd47b><!--[--><div class="VPSidebarItem level-1 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/articles/Java/01Java%E8%AF%AD%E6%B3%95/02Java8%E5%AE%9E%E6%88%98.html" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>02Java8实战</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/articles/Java/01Java%E8%AF%AD%E6%B3%95/10Java%E8%AF%BB%E5%A4%A7%E6%95%B0%E6%8D%AE%E9%87%8Fcsv.html" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>10Java读大数据量csv</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/articles/Java/01Java%E8%AF%AD%E6%B3%95/10Java%E8%AF%BB%E5%A4%A7%E6%95%B0%E6%8D%AE%E9%87%8Fexcel.html" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>10Java读大数据量excel</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/articles/Java/01Java%E8%AF%AD%E6%B3%95/10Web%E5%89%8D%E5%90%8E%E7%AB%AF%E5%A4%A7%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%92%8C%E6%8E%A5%E6%94%B6.html" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>10Web前后端大文件上传和接收</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/articles/Java/01Java%E8%AF%AD%E6%B3%95/11Java%E7%BA%BF%E7%A8%8B%E6%B1%A0%E7%9A%84%E4%BD%BF%E7%94%A8.html" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>11Java线程池的使用</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/articles/Java/01Java%E8%AF%AD%E6%B3%95/12Java%E6%AD%A3%E5%88%99%E5%8C%96.html" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>12Java正则化</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-5a346dfe data-v-669faec9><div class="VPDoc has-sidebar has-aside" data-v-669faec9 data-v-6b87e69f><!--[--><!--]--><div class="container" data-v-6b87e69f><div class="aside" data-v-6b87e69f><div class="aside-curtain" data-v-6b87e69f></div><div class="aside-container" data-v-6b87e69f><div class="aside-content" data-v-6b87e69f><div class="VPDocAside" data-v-6b87e69f data-v-3f215769><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline" role="navigation" data-v-3f215769 data-v-d330b1bb><div class="content" data-v-d330b1bb><div class="outline-marker" data-v-d330b1bb></div><div class="outline-title" role="heading" aria-level="2" data-v-d330b1bb>On this page</div><nav aria-labelledby="doc-outline-aria-label" data-v-d330b1bb><span class="visually-hidden" id="doc-outline-aria-label" data-v-d330b1bb> Table of Contents for current page </span><ul class="root" data-v-d330b1bb data-v-d0ee3533><!--[--><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-3f215769></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-6b87e69f><div class="content-container" data-v-6b87e69f><!--[--><!--]--><!----><main class="main" data-v-6b87e69f><div style="position:relative;" class="vp-doc _articles_Java_01Java%E8%AF%AD%E6%B3%95_10Java%E8%AF%BB%E5%A4%A7%E6%95%B0%E6%8D%AE%E9%87%8Fexcel" data-v-6b87e69f><div><p>本文主要是用于POI解析大文件Excel容易出现内存溢出的现象而提出解决方案，故此解决了大数据量的Excel文件解析的难度，在此拿出来贡献给大家，谢谢！</p><h1 id="_1-excel2003与excel2007" tabindex="-1">1. Excel2003与Excel2007 <a class="header-anchor" href="#_1-excel2003与excel2007" aria-label="Permalink to &quot;1. Excel2003与Excel2007&quot;">​</a></h1><p>2003版最大行数是65536行，最大列数是256列。 2007版及以后的版本最大行数是1048576行，最大列数是16384列。 excel2003是以二进制的方式存储，这种格式不易被其他软件读取使用；而excel2007采用了基于XML的ooxml开放文档标准，ooxml使用XML和ZIP技术结合进行文件存储，XML是一个基于文本的格式，而且ZIP容器支持内容的压缩，所以其一大优势是可以大大减小文件的尺寸。</p><h1 id="_2-poi解析excel" tabindex="-1">2. POI解析Excel <a class="header-anchor" href="#_2-poi解析excel" aria-label="Permalink to &quot;2. POI解析Excel&quot;">​</a></h1><p>Apache POI是Apache软件基金会的开放源码函式库，POI提供API给Java程序对Microsoft Office格式档案读和写的功能。</p><p>POI<strong>读取</strong>Excel有两种模式，一种是用户模式，一种是SAX事件驱动模式，将xlsx格式的文档转换成CSV格式后进行读取。用户模式API接口丰富，使用POI的API可以很容易读取Excel，但用户模式消耗的内存很大，当遇到很大sheet、大数据网格，假空行、公式等问题时，很容易导致内存溢出。POI官方推荐解决内存溢出的方式使用CVS格式解析，即SAX事件驱动模式。</p><p>用户模式提供的方法：</p><ul><li>HSSFWorkbook － 提供读写Microsoft Excel格式档案的功能。(2003版本，xls)</li><li>XSSFWorkbook － 提供读写Microsoft Excel OOXML格式档案的功能。(2007版本，xlsx)</li></ul><p>如果是大数据量，上面HSSF和XSSF容易内存溢出。所以POI3.8提供了SXSSFWorkbook类，采用缓存方式进行大批量写文件。SAX事件驱动模式读取大文件。</p><h1 id="_3-poi版本" tabindex="-1">3. POI版本 <a class="header-anchor" href="#_3-poi版本" aria-label="Permalink to &quot;3. POI版本&quot;">​</a></h1><p>POI3.17版本和POI3.9版本差别巨大，因为项目已才用3.9版本，不好升级，所以解决POI3.9版本大文件读的问题。</p><p><strong>如果方便请采用POI3.17版本，另外可以使用Hutools或者Alibaba EasyExcel工具读写大文件，他们都是基于POI3.17，调用更方便。</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">&lt;dependency&gt;</span></span>
<span class="line"><span style="color:#e1e4e8;">    &lt;groupId&gt;org.apache.poi&lt;/groupId&gt;</span></span>
<span class="line"><span style="color:#e1e4e8;">    &lt;artifactId&gt;poi-ooxml&lt;/artifactId&gt;</span></span>
<span class="line"><span style="color:#e1e4e8;">    &lt;version&gt;3.9&lt;/version&gt;</span></span>
<span class="line"><span style="color:#e1e4e8;">&lt;/dependency&gt;</span></span>
<span class="line"><span style="color:#e1e4e8;">&lt;dependency&gt;</span></span>
<span class="line"><span style="color:#e1e4e8;">    &lt;groupId&gt;org.apache.poi&lt;/groupId&gt;</span></span>
<span class="line"><span style="color:#e1e4e8;">    &lt;artifactId&gt;poi&lt;/artifactId&gt;</span></span>
<span class="line"><span style="color:#e1e4e8;">    &lt;version&gt;3.9&lt;/version&gt;</span></span>
<span class="line"><span style="color:#e1e4e8;">&lt;/dependency&gt;</span></span>
<span class="line"><span style="color:#e1e4e8;">&lt;!--有xercesImpl才可以用sax--&gt;</span></span>
<span class="line"><span style="color:#e1e4e8;">&lt;dependency&gt;</span></span>
<span class="line"><span style="color:#e1e4e8;">    &lt;groupId&gt;xerces&lt;/groupId&gt;</span></span>
<span class="line"><span style="color:#e1e4e8;">    &lt;artifactId&gt;xercesImpl&lt;/artifactId&gt;</span></span>
<span class="line"><span style="color:#e1e4e8;">    &lt;version&gt;2.9.1&lt;/version&gt;</span></span>
<span class="line"><span style="color:#e1e4e8;">&lt;/dependency&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">&lt;dependency&gt;</span></span>
<span class="line"><span style="color:#24292e;">    &lt;groupId&gt;org.apache.poi&lt;/groupId&gt;</span></span>
<span class="line"><span style="color:#24292e;">    &lt;artifactId&gt;poi-ooxml&lt;/artifactId&gt;</span></span>
<span class="line"><span style="color:#24292e;">    &lt;version&gt;3.9&lt;/version&gt;</span></span>
<span class="line"><span style="color:#24292e;">&lt;/dependency&gt;</span></span>
<span class="line"><span style="color:#24292e;">&lt;dependency&gt;</span></span>
<span class="line"><span style="color:#24292e;">    &lt;groupId&gt;org.apache.poi&lt;/groupId&gt;</span></span>
<span class="line"><span style="color:#24292e;">    &lt;artifactId&gt;poi&lt;/artifactId&gt;</span></span>
<span class="line"><span style="color:#24292e;">    &lt;version&gt;3.9&lt;/version&gt;</span></span>
<span class="line"><span style="color:#24292e;">&lt;/dependency&gt;</span></span>
<span class="line"><span style="color:#24292e;">&lt;!--有xercesImpl才可以用sax--&gt;</span></span>
<span class="line"><span style="color:#24292e;">&lt;dependency&gt;</span></span>
<span class="line"><span style="color:#24292e;">    &lt;groupId&gt;xerces&lt;/groupId&gt;</span></span>
<span class="line"><span style="color:#24292e;">    &lt;artifactId&gt;xercesImpl&lt;/artifactId&gt;</span></span>
<span class="line"><span style="color:#24292e;">    &lt;version&gt;2.9.1&lt;/version&gt;</span></span>
<span class="line"><span style="color:#24292e;">&lt;/dependency&gt;</span></span></code></pre></div><h1 id="_4-代码" tabindex="-1">4. 代码 <a class="header-anchor" href="#_4-代码" aria-label="Permalink to &quot;4. 代码&quot;">​</a></h1><p>注意：</p><ul><li>2007代码只支持字符串和数字。</li><li>2003代码虽然有公式，但是没有进行测试。</li><li>2003代码会遍历所有sheet；2007代码可以仅仅读取指定sheet。</li></ul><h2 id="_1-业务逻辑接口" tabindex="-1">1. 业务逻辑接口 <a class="header-anchor" href="#_1-业务逻辑接口" aria-label="Permalink to &quot;1. 业务逻辑接口&quot;">​</a></h2><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">public interface ExcelRowReaderInterface {</span></span>
<span class="line"><span style="color:#e1e4e8;">    void getRows(int sheetIndex, int curRow, List&lt;String&gt; rowlist);</span></span>
<span class="line"><span style="color:#e1e4e8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">public interface ExcelRowReaderInterface {</span></span>
<span class="line"><span style="color:#24292e;">    void getRows(int sheetIndex, int curRow, List&lt;String&gt; rowlist);</span></span>
<span class="line"><span style="color:#24292e;">}</span></span></code></pre></div><h2 id="_2-读excel2003" tabindex="-1">2. 读Excel2003 <a class="header-anchor" href="#_2-读excel2003" aria-label="Permalink to &quot;2. 读Excel2003&quot;">​</a></h2><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">import org.apache.poi.hssf.eventusermodel.EventWorkbookBuilder.SheetRecordCollectingListener;</span></span>
<span class="line"><span style="color:#e1e4e8;">import org.apache.poi.hssf.eventusermodel.FormatTrackingHSSFListener;</span></span>
<span class="line"><span style="color:#e1e4e8;">import org.apache.poi.hssf.eventusermodel.HSSFEventFactory;</span></span>
<span class="line"><span style="color:#e1e4e8;">import org.apache.poi.hssf.eventusermodel.HSSFListener;</span></span>
<span class="line"><span style="color:#e1e4e8;">import org.apache.poi.hssf.eventusermodel.HSSFRequest;</span></span>
<span class="line"><span style="color:#e1e4e8;">import org.apache.poi.hssf.eventusermodel.MissingRecordAwareHSSFListener;</span></span>
<span class="line"><span style="color:#e1e4e8;">import org.apache.poi.hssf.eventusermodel.dummyrecord.LastCellOfRowDummyRecord;</span></span>
<span class="line"><span style="color:#e1e4e8;">import org.apache.poi.hssf.eventusermodel.dummyrecord.MissingCellDummyRecord;</span></span>
<span class="line"><span style="color:#e1e4e8;">import org.apache.poi.hssf.model.HSSFFormulaParser;</span></span>
<span class="line"><span style="color:#e1e4e8;">import org.apache.poi.hssf.record.BOFRecord;</span></span>
<span class="line"><span style="color:#e1e4e8;">import org.apache.poi.hssf.record.BlankRecord;</span></span>
<span class="line"><span style="color:#e1e4e8;">import org.apache.poi.hssf.record.BoolErrRecord;</span></span>
<span class="line"><span style="color:#e1e4e8;">import org.apache.poi.hssf.record.BoundSheetRecord;</span></span>
<span class="line"><span style="color:#e1e4e8;">import org.apache.poi.hssf.record.FormulaRecord;</span></span>
<span class="line"><span style="color:#e1e4e8;">import org.apache.poi.hssf.record.LabelRecord;</span></span>
<span class="line"><span style="color:#e1e4e8;">import org.apache.poi.hssf.record.LabelSSTRecord;</span></span>
<span class="line"><span style="color:#e1e4e8;">import org.apache.poi.hssf.record.NumberRecord;</span></span>
<span class="line"><span style="color:#e1e4e8;">import org.apache.poi.hssf.record.Record;</span></span>
<span class="line"><span style="color:#e1e4e8;">import org.apache.poi.hssf.record.SSTRecord;</span></span>
<span class="line"><span style="color:#e1e4e8;">import org.apache.poi.hssf.record.StringRecord;</span></span>
<span class="line"><span style="color:#e1e4e8;">import org.apache.poi.hssf.usermodel.HSSFWorkbook;</span></span>
<span class="line"><span style="color:#e1e4e8;">import org.apache.poi.poifs.filesystem.POIFSFileSystem;</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">import java.io.File;</span></span>
<span class="line"><span style="color:#e1e4e8;">import java.io.FileInputStream;</span></span>
<span class="line"><span style="color:#e1e4e8;">import java.io.IOException;</span></span>
<span class="line"><span style="color:#e1e4e8;">import java.util.ArrayList;</span></span>
<span class="line"><span style="color:#e1e4e8;">import java.util.Arrays;</span></span>
<span class="line"><span style="color:#e1e4e8;">import java.util.Collections;</span></span>
<span class="line"><span style="color:#e1e4e8;">import java.util.List;</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">public class ExcelReader03EventModel implements HSSFListener {</span></span>
<span class="line"><span style="color:#e1e4e8;">    private int minColumns = -1;</span></span>
<span class="line"><span style="color:#e1e4e8;">    private int maxColNum;   // 第一行确定maxColNum</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">    private POIFSFileSystem fs;</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">    private int lastRowNumber;</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">    private int lastColumnNumber;</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">    /**</span></span>
<span class="line"><span style="color:#e1e4e8;">     * Should we output the formula, or the value it has?</span></span>
<span class="line"><span style="color:#e1e4e8;">     */</span></span>
<span class="line"><span style="color:#e1e4e8;">    private boolean outputFormulaValues = true;</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">    /**</span></span>
<span class="line"><span style="color:#e1e4e8;">     * For parsing Formulas</span></span>
<span class="line"><span style="color:#e1e4e8;">     */</span></span>
<span class="line"><span style="color:#e1e4e8;">    private SheetRecordCollectingListener workbookBuildingListener;</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">    // excel2003工作薄</span></span>
<span class="line"><span style="color:#e1e4e8;">    private HSSFWorkbook stubWorkbook;</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">    // Records we pick up as we process</span></span>
<span class="line"><span style="color:#e1e4e8;">    private SSTRecord sstRecord;</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">    private FormatTrackingHSSFListener formatListener;</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">    // 表索引</span></span>
<span class="line"><span style="color:#e1e4e8;">    private int sheetIndex = -1;</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">    private int onSheet = -1;</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">    private BoundSheetRecord[] orderedBSRs;</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">    @SuppressWarnings(&quot;unchecked&quot;)</span></span>
<span class="line"><span style="color:#e1e4e8;">    private ArrayList boundSheetRecords = new ArrayList();</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">    // For handling formulas with string results</span></span>
<span class="line"><span style="color:#e1e4e8;">    private int nextRow;</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">    private int nextColumn;</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">    private boolean outputNextStringRecord;</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">    // 当前行</span></span>
<span class="line"><span style="color:#e1e4e8;">    private int curRow = 0;</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">    // 存储行记录的容器</span></span>
<span class="line"><span style="color:#e1e4e8;">    private List&lt;String&gt; rowlist = new ArrayList&lt;String&gt;();</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">    @SuppressWarnings(&quot;unused&quot;)</span></span>
<span class="line"><span style="color:#e1e4e8;">    private String sheetName;</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">    private ExcelRowReaderInterface rowReader;</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">    public ExcelReader03EventModel(ExcelRowReaderInterface rowReader) {</span></span>
<span class="line"><span style="color:#e1e4e8;">        this.rowReader = rowReader;</span></span>
<span class="line"><span style="color:#e1e4e8;">    }</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">    /**</span></span>
<span class="line"><span style="color:#e1e4e8;">     * 遍历excel下所有的sheet</span></span>
<span class="line"><span style="color:#e1e4e8;">     */</span></span>
<span class="line"><span style="color:#e1e4e8;">    public void processOneSheet(File file, int onSheet) throws IOException {</span></span>
<span class="line"><span style="color:#e1e4e8;">        this.onSheet = onSheet;</span></span>
<span class="line"><span style="color:#e1e4e8;">        this.fs = new POIFSFileSystem(new FileInputStream(file));</span></span>
<span class="line"><span style="color:#e1e4e8;">        MissingRecordAwareHSSFListener listener = new MissingRecordAwareHSSFListener(this);</span></span>
<span class="line"><span style="color:#e1e4e8;">        formatListener = new FormatTrackingHSSFListener(listener);</span></span>
<span class="line"><span style="color:#e1e4e8;">        HSSFEventFactory factory = new HSSFEventFactory();</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">        HSSFRequest request = new HSSFRequest();</span></span>
<span class="line"><span style="color:#e1e4e8;">        if (outputFormulaValues) {</span></span>
<span class="line"><span style="color:#e1e4e8;">            request.addListenerForAllRecords(formatListener);</span></span>
<span class="line"><span style="color:#e1e4e8;">        } else {</span></span>
<span class="line"><span style="color:#e1e4e8;">            workbookBuildingListener = new SheetRecordCollectingListener(formatListener);</span></span>
<span class="line"><span style="color:#e1e4e8;">            request.addListenerForAllRecords(workbookBuildingListener);</span></span>
<span class="line"><span style="color:#e1e4e8;">        }</span></span>
<span class="line"><span style="color:#e1e4e8;">        factory.processWorkbookEvents(request, fs);</span></span>
<span class="line"><span style="color:#e1e4e8;">    }</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">    public void processAllSheet(File file) throws IOException {</span></span>
<span class="line"><span style="color:#e1e4e8;">        this.fs = new POIFSFileSystem(new FileInputStream(file));</span></span>
<span class="line"><span style="color:#e1e4e8;">        MissingRecordAwareHSSFListener listener = new MissingRecordAwareHSSFListener(this);</span></span>
<span class="line"><span style="color:#e1e4e8;">        formatListener = new FormatTrackingHSSFListener(listener);</span></span>
<span class="line"><span style="color:#e1e4e8;">        HSSFEventFactory factory = new HSSFEventFactory();</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">        HSSFRequest request = new HSSFRequest();</span></span>
<span class="line"><span style="color:#e1e4e8;">        if (outputFormulaValues) {</span></span>
<span class="line"><span style="color:#e1e4e8;">            request.addListenerForAllRecords(formatListener);</span></span>
<span class="line"><span style="color:#e1e4e8;">        } else {</span></span>
<span class="line"><span style="color:#e1e4e8;">            workbookBuildingListener = new SheetRecordCollectingListener(formatListener);</span></span>
<span class="line"><span style="color:#e1e4e8;">            request.addListenerForAllRecords(workbookBuildingListener);</span></span>
<span class="line"><span style="color:#e1e4e8;">        }</span></span>
<span class="line"><span style="color:#e1e4e8;">        factory.processWorkbookEvents(request, fs);</span></span>
<span class="line"><span style="color:#e1e4e8;">    }</span></span>
<span class="line"><span style="color:#e1e4e8;">     /**</span></span>
<span class="line"><span style="color:#e1e4e8;">     * HSSFListener 监听方法，处理 Record</span></span>
<span class="line"><span style="color:#e1e4e8;">     */</span></span>
<span class="line"><span style="color:#e1e4e8;">    @Override</span></span>
<span class="line"><span style="color:#e1e4e8;">    @SuppressWarnings(&quot;unchecked&quot;)</span></span>
<span class="line"><span style="color:#e1e4e8;">    public void processRecord(Record record) {</span></span>
<span class="line"><span style="color:#e1e4e8;">        // 此处是我提取出来的，可以和下面switch代码合并。</span></span>
<span class="line"><span style="color:#e1e4e8;">        // 提取的原因是读取指定sheet，否则代码会遍历所有sheet</span></span>
<span class="line"><span style="color:#e1e4e8;">        switch (record.getSid()) {</span></span>
<span class="line"><span style="color:#e1e4e8;">            case BoundSheetRecord.sid:</span></span>
<span class="line"><span style="color:#e1e4e8;">                boundSheetRecords.add(record);</span></span>
<span class="line"><span style="color:#e1e4e8;">                break;</span></span>
<span class="line"><span style="color:#e1e4e8;">            case SSTRecord.sid:</span></span>
<span class="line"><span style="color:#e1e4e8;">                sstRecord = (SSTRecord) record;</span></span>
<span class="line"><span style="color:#e1e4e8;">                break;</span></span>
<span class="line"><span style="color:#e1e4e8;">            case BOFRecord.sid:</span></span>
<span class="line"><span style="color:#e1e4e8;">                BOFRecord br = (BOFRecord) record;</span></span>
<span class="line"><span style="color:#e1e4e8;">                if (br.getType() == BOFRecord.TYPE_WORKSHEET) {</span></span>
<span class="line"><span style="color:#e1e4e8;">                    // 如果有需要，则建立子工作薄</span></span>
<span class="line"><span style="color:#e1e4e8;">                    if (workbookBuildingListener != null &amp;&amp; stubWorkbook == null) {</span></span>
<span class="line"><span style="color:#e1e4e8;">                        stubWorkbook = workbookBuildingListener.getStubHSSFWorkbook();</span></span>
<span class="line"><span style="color:#e1e4e8;">                    }</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">                    sheetIndex++;</span></span>
<span class="line"><span style="color:#e1e4e8;">                    if (orderedBSRs == null) {</span></span>
<span class="line"><span style="color:#e1e4e8;">                        orderedBSRs = BoundSheetRecord.orderByBofPosition(boundSheetRecords);</span></span>
<span class="line"><span style="color:#e1e4e8;">                    }</span></span>
<span class="line"><span style="color:#e1e4e8;">                    sheetName = orderedBSRs[sheetIndex].getSheetname();</span></span>
<span class="line"><span style="color:#e1e4e8;">                }</span></span>
<span class="line"><span style="color:#e1e4e8;">                break;</span></span>
<span class="line"><span style="color:#e1e4e8;">            default:</span></span>
<span class="line"><span style="color:#e1e4e8;">                break;</span></span>
<span class="line"><span style="color:#e1e4e8;">        }</span></span>
<span class="line"><span style="color:#e1e4e8;">        if (this.onSheet != -1 &amp;&amp; this.sheetIndex &gt; this.onSheet) {</span></span>
<span class="line"><span style="color:#e1e4e8;">            return;</span></span>
<span class="line"><span style="color:#e1e4e8;">        }</span></span>
<span class="line"><span style="color:#e1e4e8;">        if (this.onSheet == -1 || this.sheetIndex == this.onSheet) {</span></span>
<span class="line"><span style="color:#e1e4e8;">            int thisRow = -1;</span></span>
<span class="line"><span style="color:#e1e4e8;">            int thisColumn = -1;</span></span>
<span class="line"><span style="color:#e1e4e8;">            String thisStr = null;</span></span>
<span class="line"><span style="color:#e1e4e8;">            String value = null;</span></span>
<span class="line"><span style="color:#e1e4e8;">            switch (record.getSid()) {</span></span>
<span class="line"><span style="color:#e1e4e8;">                case BlankRecord.sid:</span></span>
<span class="line"><span style="color:#e1e4e8;">                    BlankRecord brec = (BlankRecord) record;</span></span>
<span class="line"><span style="color:#e1e4e8;">                    thisRow = brec.getRow();</span></span>
<span class="line"><span style="color:#e1e4e8;">                    thisColumn = brec.getColumn();</span></span>
<span class="line"><span style="color:#e1e4e8;">                    thisStr = &quot;&quot;;</span></span>
<span class="line"><span style="color:#e1e4e8;">                    rowlist.add(thisColumn, thisStr);</span></span>
<span class="line"><span style="color:#e1e4e8;">                    break;</span></span>
<span class="line"><span style="color:#e1e4e8;">                case BoolErrRecord.sid: // 单元格为布尔类型</span></span>
<span class="line"><span style="color:#e1e4e8;">                    BoolErrRecord berec = (BoolErrRecord) record;</span></span>
<span class="line"><span style="color:#e1e4e8;">                    thisRow = berec.getRow();</span></span>
<span class="line"><span style="color:#e1e4e8;">                    thisColumn = berec.getColumn();</span></span>
<span class="line"><span style="color:#e1e4e8;">                    thisStr = berec.getBooleanValue() + &quot;&quot;;</span></span>
<span class="line"><span style="color:#e1e4e8;">                    rowlist.add(thisColumn, thisStr);</span></span>
<span class="line"><span style="color:#e1e4e8;">                    break;</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">                case FormulaRecord.sid: // 单元格为公式类型</span></span>
<span class="line"><span style="color:#e1e4e8;">                    FormulaRecord frec = (FormulaRecord) record;</span></span>
<span class="line"><span style="color:#e1e4e8;">                    thisRow = frec.getRow();</span></span>
<span class="line"><span style="color:#e1e4e8;">                    thisColumn = frec.getColumn();</span></span>
<span class="line"><span style="color:#e1e4e8;">                    if (outputFormulaValues) {</span></span>
<span class="line"><span style="color:#e1e4e8;">                        if (Double.isNaN(frec.getValue())) {</span></span>
<span class="line"><span style="color:#e1e4e8;">                            // Formula result is a string</span></span>
<span class="line"><span style="color:#e1e4e8;">                            // This is stored in the next record</span></span>
<span class="line"><span style="color:#e1e4e8;">                            outputNextStringRecord = true;</span></span>
<span class="line"><span style="color:#e1e4e8;">                            nextRow = frec.getRow();</span></span>
<span class="line"><span style="color:#e1e4e8;">                            nextColumn = frec.getColumn();</span></span>
<span class="line"><span style="color:#e1e4e8;">                        } else {</span></span>
<span class="line"><span style="color:#e1e4e8;">                            thisStr = formatListener.formatNumberDateCell(frec);</span></span>
<span class="line"><span style="color:#e1e4e8;">                        }</span></span>
<span class="line"><span style="color:#e1e4e8;">                    } else {</span></span>
<span class="line"><span style="color:#e1e4e8;">                        thisStr = &#39;&quot;&#39; + HSSFFormulaParser.toFormulaString(stubWorkbook, frec.getParsedExpression()) + &#39;&quot;&#39;;</span></span>
<span class="line"><span style="color:#e1e4e8;">                    }</span></span>
<span class="line"><span style="color:#e1e4e8;">                    rowlist.add(thisColumn, thisStr);</span></span>
<span class="line"><span style="color:#e1e4e8;">                    break;</span></span>
<span class="line"><span style="color:#e1e4e8;">                case StringRecord.sid:// 单元格中公式的字符串</span></span>
<span class="line"><span style="color:#e1e4e8;">                    if (outputNextStringRecord) {</span></span>
<span class="line"><span style="color:#e1e4e8;">                        // String for formula</span></span>
<span class="line"><span style="color:#e1e4e8;">                        StringRecord srec = (StringRecord) record;</span></span>
<span class="line"><span style="color:#e1e4e8;">                        thisStr = srec.getString();</span></span>
<span class="line"><span style="color:#e1e4e8;">                        thisRow = nextRow;</span></span>
<span class="line"><span style="color:#e1e4e8;">                        thisColumn = nextColumn;</span></span>
<span class="line"><span style="color:#e1e4e8;">                        outputNextStringRecord = false;</span></span>
<span class="line"><span style="color:#e1e4e8;">                    }</span></span>
<span class="line"><span style="color:#e1e4e8;">                    break;</span></span>
<span class="line"><span style="color:#e1e4e8;">                case LabelRecord.sid:</span></span>
<span class="line"><span style="color:#e1e4e8;">                    LabelRecord lrec = (LabelRecord) record;</span></span>
<span class="line"><span style="color:#e1e4e8;">                    curRow = thisRow = lrec.getRow();</span></span>
<span class="line"><span style="color:#e1e4e8;">                    thisColumn = lrec.getColumn();</span></span>
<span class="line"><span style="color:#e1e4e8;">                    value = lrec.getValue().trim();</span></span>
<span class="line"><span style="color:#e1e4e8;">                    value = value.equals(&quot;&quot;) ? &quot; &quot; : value;</span></span>
<span class="line"><span style="color:#e1e4e8;">                    this.rowlist.add(thisColumn, value);</span></span>
<span class="line"><span style="color:#e1e4e8;">                    break;</span></span>
<span class="line"><span style="color:#e1e4e8;">                case LabelSSTRecord.sid: // 单元格为字符串类型</span></span>
<span class="line"><span style="color:#e1e4e8;">                    LabelSSTRecord lsrec = (LabelSSTRecord) record;</span></span>
<span class="line"><span style="color:#e1e4e8;">                    curRow = thisRow = lsrec.getRow();</span></span>
<span class="line"><span style="color:#e1e4e8;">                    thisColumn = lsrec.getColumn();</span></span>
<span class="line"><span style="color:#e1e4e8;">                    if (sstRecord == null) {</span></span>
<span class="line"><span style="color:#e1e4e8;">                        rowlist.add(thisColumn, &quot; &quot;);</span></span>
<span class="line"><span style="color:#e1e4e8;">                    } else {</span></span>
<span class="line"><span style="color:#e1e4e8;">                        value = sstRecord.getString(lsrec.getSSTIndex()).toString().trim();</span></span>
<span class="line"><span style="color:#e1e4e8;">                        value = value.equals(&quot;&quot;) ? &quot; &quot; : value;</span></span>
<span class="line"><span style="color:#e1e4e8;">                        rowlist.add(thisColumn, value);</span></span>
<span class="line"><span style="color:#e1e4e8;">                    }</span></span>
<span class="line"><span style="color:#e1e4e8;">                    break;</span></span>
<span class="line"><span style="color:#e1e4e8;">                   case NumberRecord.sid: // 单元格为数字类型</span></span>
<span class="line"><span style="color:#e1e4e8;">                    NumberRecord numrec = (NumberRecord) record;</span></span>
<span class="line"><span style="color:#e1e4e8;">                    curRow = thisRow = numrec.getRow();</span></span>
<span class="line"><span style="color:#e1e4e8;">                    thisColumn = numrec.getColumn();</span></span>
<span class="line"><span style="color:#e1e4e8;">                    value = formatListener.formatNumberDateCell(numrec).trim();</span></span>
<span class="line"><span style="color:#e1e4e8;">                    value = value.equals(&quot;&quot;) ? &quot; &quot; : value;</span></span>
<span class="line"><span style="color:#e1e4e8;">                    // 向容器加入列值</span></span>
<span class="line"><span style="color:#e1e4e8;">                    rowlist.add(thisColumn, value);</span></span>
<span class="line"><span style="color:#e1e4e8;">                    break;</span></span>
<span class="line"><span style="color:#e1e4e8;">                default:</span></span>
<span class="line"><span style="color:#e1e4e8;">                    break;</span></span>
<span class="line"><span style="color:#e1e4e8;">            }</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">            // 遇到新行的操作</span></span>
<span class="line"><span style="color:#e1e4e8;">            if (thisRow != -1 &amp;&amp; thisRow != lastRowNumber) {</span></span>
<span class="line"><span style="color:#e1e4e8;">                lastColumnNumber = -1;</span></span>
<span class="line"><span style="color:#e1e4e8;">            }</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">            // 空值的操作</span></span>
<span class="line"><span style="color:#e1e4e8;">            if (record instanceof MissingCellDummyRecord) {</span></span>
<span class="line"><span style="color:#e1e4e8;">                MissingCellDummyRecord mc = (MissingCellDummyRecord) record;</span></span>
<span class="line"><span style="color:#e1e4e8;">                curRow = thisRow = mc.getRow();</span></span>
<span class="line"><span style="color:#e1e4e8;">                thisColumn = mc.getColumn();</span></span>
<span class="line"><span style="color:#e1e4e8;">                rowlist.add(thisColumn, &quot; &quot;);</span></span>
<span class="line"><span style="color:#e1e4e8;">            }</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">            // 取最大行</span></span>
<span class="line"><span style="color:#e1e4e8;">            if (thisRow == 0) {</span></span>
<span class="line"><span style="color:#e1e4e8;">                maxColNum = thisColumn + 1;</span></span>
<span class="line"><span style="color:#e1e4e8;">            }</span></span>
<span class="line"><span style="color:#e1e4e8;">            // 更新行和列的值</span></span>
<span class="line"><span style="color:#e1e4e8;">            if (thisRow &gt; -1) {</span></span>
<span class="line"><span style="color:#e1e4e8;">                lastRowNumber = thisRow;</span></span>
<span class="line"><span style="color:#e1e4e8;">            }</span></span>
<span class="line"><span style="color:#e1e4e8;">            if (thisColumn &gt; -1) {</span></span>
<span class="line"><span style="color:#e1e4e8;">                lastColumnNumber = thisColumn;</span></span>
<span class="line"><span style="color:#e1e4e8;">            }</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">            // 行结束时的操作</span></span>
<span class="line"><span style="color:#e1e4e8;">            if (record instanceof LastCellOfRowDummyRecord) {</span></span>
<span class="line"><span style="color:#e1e4e8;">                if (minColumns &gt; 0) {</span></span>
<span class="line"><span style="color:#e1e4e8;">                    // 列值重新置空</span></span>
<span class="line"><span style="color:#e1e4e8;">                    if (lastColumnNumber == -1) {</span></span>
<span class="line"><span style="color:#e1e4e8;">                        lastColumnNumber = 0;</span></span>
<span class="line"><span style="color:#e1e4e8;">                    }</span></span>
<span class="line"><span style="color:#e1e4e8;">                }</span></span>
<span class="line"><span style="color:#e1e4e8;">                lastColumnNumber = -1;</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">                // 每行结束时， 调用getRows() 方法</span></span>
<span class="line"><span style="color:#e1e4e8;">                if (rowlist.size() &lt; maxColNum) {</span></span>
<span class="line"><span style="color:#e1e4e8;">                    for (int i = rowlist.size(); i &lt; maxColNum; i++) {</span></span>
<span class="line"><span style="color:#e1e4e8;">                        rowlist.add(&quot;&quot;);</span></span>
<span class="line"><span style="color:#e1e4e8;">                    }</span></span>
<span class="line"><span style="color:#e1e4e8;">                }</span></span>
<span class="line"><span style="color:#e1e4e8;">                List&lt;String&gt; curList = new ArrayList&lt;&gt;(rowlist.size());</span></span>
<span class="line"><span style="color:#e1e4e8;">                for (String s : rowlist) {</span></span>
<span class="line"><span style="color:#e1e4e8;">                    curList.add(s);</span></span>
<span class="line"><span style="color:#e1e4e8;">                }</span></span>
<span class="line"><span style="color:#e1e4e8;">                rowReader.getRows(sheetIndex, curRow, curList);</span></span>
<span class="line"><span style="color:#e1e4e8;">                // 清空容器</span></span>
<span class="line"><span style="color:#e1e4e8;">                rowlist.clear();</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">            }</span></span>
<span class="line"><span style="color:#e1e4e8;">        }</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">    }</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">    public static void main(String[] args) {</span></span>
<span class="line"><span style="color:#e1e4e8;">        ExcelRowReaderInterface rowReader = new ExcelRowReaderImpl();</span></span>
<span class="line"><span style="color:#e1e4e8;">        try {</span></span>
<span class="line"><span style="color:#e1e4e8;">            ExcelReader03EventModel excelReader03EventModel = new ExcelReader03EventModel(rowReader);</span></span>
<span class="line"><span style="color:#e1e4e8;">            excelReader03EventModel.processAllSheet(new File(&quot;D://test//BTS Information.xls&quot;));</span></span>
<span class="line"><span style="color:#e1e4e8;">        } catch (Exception e) {</span></span>
<span class="line"><span style="color:#e1e4e8;">            e.printStackTrace();</span></span>
<span class="line"><span style="color:#e1e4e8;">        }</span></span>
<span class="line"><span style="color:#e1e4e8;">    }</span></span>
<span class="line"><span style="color:#e1e4e8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">import org.apache.poi.hssf.eventusermodel.EventWorkbookBuilder.SheetRecordCollectingListener;</span></span>
<span class="line"><span style="color:#24292e;">import org.apache.poi.hssf.eventusermodel.FormatTrackingHSSFListener;</span></span>
<span class="line"><span style="color:#24292e;">import org.apache.poi.hssf.eventusermodel.HSSFEventFactory;</span></span>
<span class="line"><span style="color:#24292e;">import org.apache.poi.hssf.eventusermodel.HSSFListener;</span></span>
<span class="line"><span style="color:#24292e;">import org.apache.poi.hssf.eventusermodel.HSSFRequest;</span></span>
<span class="line"><span style="color:#24292e;">import org.apache.poi.hssf.eventusermodel.MissingRecordAwareHSSFListener;</span></span>
<span class="line"><span style="color:#24292e;">import org.apache.poi.hssf.eventusermodel.dummyrecord.LastCellOfRowDummyRecord;</span></span>
<span class="line"><span style="color:#24292e;">import org.apache.poi.hssf.eventusermodel.dummyrecord.MissingCellDummyRecord;</span></span>
<span class="line"><span style="color:#24292e;">import org.apache.poi.hssf.model.HSSFFormulaParser;</span></span>
<span class="line"><span style="color:#24292e;">import org.apache.poi.hssf.record.BOFRecord;</span></span>
<span class="line"><span style="color:#24292e;">import org.apache.poi.hssf.record.BlankRecord;</span></span>
<span class="line"><span style="color:#24292e;">import org.apache.poi.hssf.record.BoolErrRecord;</span></span>
<span class="line"><span style="color:#24292e;">import org.apache.poi.hssf.record.BoundSheetRecord;</span></span>
<span class="line"><span style="color:#24292e;">import org.apache.poi.hssf.record.FormulaRecord;</span></span>
<span class="line"><span style="color:#24292e;">import org.apache.poi.hssf.record.LabelRecord;</span></span>
<span class="line"><span style="color:#24292e;">import org.apache.poi.hssf.record.LabelSSTRecord;</span></span>
<span class="line"><span style="color:#24292e;">import org.apache.poi.hssf.record.NumberRecord;</span></span>
<span class="line"><span style="color:#24292e;">import org.apache.poi.hssf.record.Record;</span></span>
<span class="line"><span style="color:#24292e;">import org.apache.poi.hssf.record.SSTRecord;</span></span>
<span class="line"><span style="color:#24292e;">import org.apache.poi.hssf.record.StringRecord;</span></span>
<span class="line"><span style="color:#24292e;">import org.apache.poi.hssf.usermodel.HSSFWorkbook;</span></span>
<span class="line"><span style="color:#24292e;">import org.apache.poi.poifs.filesystem.POIFSFileSystem;</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">import java.io.File;</span></span>
<span class="line"><span style="color:#24292e;">import java.io.FileInputStream;</span></span>
<span class="line"><span style="color:#24292e;">import java.io.IOException;</span></span>
<span class="line"><span style="color:#24292e;">import java.util.ArrayList;</span></span>
<span class="line"><span style="color:#24292e;">import java.util.Arrays;</span></span>
<span class="line"><span style="color:#24292e;">import java.util.Collections;</span></span>
<span class="line"><span style="color:#24292e;">import java.util.List;</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">public class ExcelReader03EventModel implements HSSFListener {</span></span>
<span class="line"><span style="color:#24292e;">    private int minColumns = -1;</span></span>
<span class="line"><span style="color:#24292e;">    private int maxColNum;   // 第一行确定maxColNum</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">    private POIFSFileSystem fs;</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">    private int lastRowNumber;</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">    private int lastColumnNumber;</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">    /**</span></span>
<span class="line"><span style="color:#24292e;">     * Should we output the formula, or the value it has?</span></span>
<span class="line"><span style="color:#24292e;">     */</span></span>
<span class="line"><span style="color:#24292e;">    private boolean outputFormulaValues = true;</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">    /**</span></span>
<span class="line"><span style="color:#24292e;">     * For parsing Formulas</span></span>
<span class="line"><span style="color:#24292e;">     */</span></span>
<span class="line"><span style="color:#24292e;">    private SheetRecordCollectingListener workbookBuildingListener;</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">    // excel2003工作薄</span></span>
<span class="line"><span style="color:#24292e;">    private HSSFWorkbook stubWorkbook;</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">    // Records we pick up as we process</span></span>
<span class="line"><span style="color:#24292e;">    private SSTRecord sstRecord;</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">    private FormatTrackingHSSFListener formatListener;</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">    // 表索引</span></span>
<span class="line"><span style="color:#24292e;">    private int sheetIndex = -1;</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">    private int onSheet = -1;</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">    private BoundSheetRecord[] orderedBSRs;</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">    @SuppressWarnings(&quot;unchecked&quot;)</span></span>
<span class="line"><span style="color:#24292e;">    private ArrayList boundSheetRecords = new ArrayList();</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">    // For handling formulas with string results</span></span>
<span class="line"><span style="color:#24292e;">    private int nextRow;</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">    private int nextColumn;</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">    private boolean outputNextStringRecord;</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">    // 当前行</span></span>
<span class="line"><span style="color:#24292e;">    private int curRow = 0;</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">    // 存储行记录的容器</span></span>
<span class="line"><span style="color:#24292e;">    private List&lt;String&gt; rowlist = new ArrayList&lt;String&gt;();</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">    @SuppressWarnings(&quot;unused&quot;)</span></span>
<span class="line"><span style="color:#24292e;">    private String sheetName;</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">    private ExcelRowReaderInterface rowReader;</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">    public ExcelReader03EventModel(ExcelRowReaderInterface rowReader) {</span></span>
<span class="line"><span style="color:#24292e;">        this.rowReader = rowReader;</span></span>
<span class="line"><span style="color:#24292e;">    }</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">    /**</span></span>
<span class="line"><span style="color:#24292e;">     * 遍历excel下所有的sheet</span></span>
<span class="line"><span style="color:#24292e;">     */</span></span>
<span class="line"><span style="color:#24292e;">    public void processOneSheet(File file, int onSheet) throws IOException {</span></span>
<span class="line"><span style="color:#24292e;">        this.onSheet = onSheet;</span></span>
<span class="line"><span style="color:#24292e;">        this.fs = new POIFSFileSystem(new FileInputStream(file));</span></span>
<span class="line"><span style="color:#24292e;">        MissingRecordAwareHSSFListener listener = new MissingRecordAwareHSSFListener(this);</span></span>
<span class="line"><span style="color:#24292e;">        formatListener = new FormatTrackingHSSFListener(listener);</span></span>
<span class="line"><span style="color:#24292e;">        HSSFEventFactory factory = new HSSFEventFactory();</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">        HSSFRequest request = new HSSFRequest();</span></span>
<span class="line"><span style="color:#24292e;">        if (outputFormulaValues) {</span></span>
<span class="line"><span style="color:#24292e;">            request.addListenerForAllRecords(formatListener);</span></span>
<span class="line"><span style="color:#24292e;">        } else {</span></span>
<span class="line"><span style="color:#24292e;">            workbookBuildingListener = new SheetRecordCollectingListener(formatListener);</span></span>
<span class="line"><span style="color:#24292e;">            request.addListenerForAllRecords(workbookBuildingListener);</span></span>
<span class="line"><span style="color:#24292e;">        }</span></span>
<span class="line"><span style="color:#24292e;">        factory.processWorkbookEvents(request, fs);</span></span>
<span class="line"><span style="color:#24292e;">    }</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">    public void processAllSheet(File file) throws IOException {</span></span>
<span class="line"><span style="color:#24292e;">        this.fs = new POIFSFileSystem(new FileInputStream(file));</span></span>
<span class="line"><span style="color:#24292e;">        MissingRecordAwareHSSFListener listener = new MissingRecordAwareHSSFListener(this);</span></span>
<span class="line"><span style="color:#24292e;">        formatListener = new FormatTrackingHSSFListener(listener);</span></span>
<span class="line"><span style="color:#24292e;">        HSSFEventFactory factory = new HSSFEventFactory();</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">        HSSFRequest request = new HSSFRequest();</span></span>
<span class="line"><span style="color:#24292e;">        if (outputFormulaValues) {</span></span>
<span class="line"><span style="color:#24292e;">            request.addListenerForAllRecords(formatListener);</span></span>
<span class="line"><span style="color:#24292e;">        } else {</span></span>
<span class="line"><span style="color:#24292e;">            workbookBuildingListener = new SheetRecordCollectingListener(formatListener);</span></span>
<span class="line"><span style="color:#24292e;">            request.addListenerForAllRecords(workbookBuildingListener);</span></span>
<span class="line"><span style="color:#24292e;">        }</span></span>
<span class="line"><span style="color:#24292e;">        factory.processWorkbookEvents(request, fs);</span></span>
<span class="line"><span style="color:#24292e;">    }</span></span>
<span class="line"><span style="color:#24292e;">     /**</span></span>
<span class="line"><span style="color:#24292e;">     * HSSFListener 监听方法，处理 Record</span></span>
<span class="line"><span style="color:#24292e;">     */</span></span>
<span class="line"><span style="color:#24292e;">    @Override</span></span>
<span class="line"><span style="color:#24292e;">    @SuppressWarnings(&quot;unchecked&quot;)</span></span>
<span class="line"><span style="color:#24292e;">    public void processRecord(Record record) {</span></span>
<span class="line"><span style="color:#24292e;">        // 此处是我提取出来的，可以和下面switch代码合并。</span></span>
<span class="line"><span style="color:#24292e;">        // 提取的原因是读取指定sheet，否则代码会遍历所有sheet</span></span>
<span class="line"><span style="color:#24292e;">        switch (record.getSid()) {</span></span>
<span class="line"><span style="color:#24292e;">            case BoundSheetRecord.sid:</span></span>
<span class="line"><span style="color:#24292e;">                boundSheetRecords.add(record);</span></span>
<span class="line"><span style="color:#24292e;">                break;</span></span>
<span class="line"><span style="color:#24292e;">            case SSTRecord.sid:</span></span>
<span class="line"><span style="color:#24292e;">                sstRecord = (SSTRecord) record;</span></span>
<span class="line"><span style="color:#24292e;">                break;</span></span>
<span class="line"><span style="color:#24292e;">            case BOFRecord.sid:</span></span>
<span class="line"><span style="color:#24292e;">                BOFRecord br = (BOFRecord) record;</span></span>
<span class="line"><span style="color:#24292e;">                if (br.getType() == BOFRecord.TYPE_WORKSHEET) {</span></span>
<span class="line"><span style="color:#24292e;">                    // 如果有需要，则建立子工作薄</span></span>
<span class="line"><span style="color:#24292e;">                    if (workbookBuildingListener != null &amp;&amp; stubWorkbook == null) {</span></span>
<span class="line"><span style="color:#24292e;">                        stubWorkbook = workbookBuildingListener.getStubHSSFWorkbook();</span></span>
<span class="line"><span style="color:#24292e;">                    }</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">                    sheetIndex++;</span></span>
<span class="line"><span style="color:#24292e;">                    if (orderedBSRs == null) {</span></span>
<span class="line"><span style="color:#24292e;">                        orderedBSRs = BoundSheetRecord.orderByBofPosition(boundSheetRecords);</span></span>
<span class="line"><span style="color:#24292e;">                    }</span></span>
<span class="line"><span style="color:#24292e;">                    sheetName = orderedBSRs[sheetIndex].getSheetname();</span></span>
<span class="line"><span style="color:#24292e;">                }</span></span>
<span class="line"><span style="color:#24292e;">                break;</span></span>
<span class="line"><span style="color:#24292e;">            default:</span></span>
<span class="line"><span style="color:#24292e;">                break;</span></span>
<span class="line"><span style="color:#24292e;">        }</span></span>
<span class="line"><span style="color:#24292e;">        if (this.onSheet != -1 &amp;&amp; this.sheetIndex &gt; this.onSheet) {</span></span>
<span class="line"><span style="color:#24292e;">            return;</span></span>
<span class="line"><span style="color:#24292e;">        }</span></span>
<span class="line"><span style="color:#24292e;">        if (this.onSheet == -1 || this.sheetIndex == this.onSheet) {</span></span>
<span class="line"><span style="color:#24292e;">            int thisRow = -1;</span></span>
<span class="line"><span style="color:#24292e;">            int thisColumn = -1;</span></span>
<span class="line"><span style="color:#24292e;">            String thisStr = null;</span></span>
<span class="line"><span style="color:#24292e;">            String value = null;</span></span>
<span class="line"><span style="color:#24292e;">            switch (record.getSid()) {</span></span>
<span class="line"><span style="color:#24292e;">                case BlankRecord.sid:</span></span>
<span class="line"><span style="color:#24292e;">                    BlankRecord brec = (BlankRecord) record;</span></span>
<span class="line"><span style="color:#24292e;">                    thisRow = brec.getRow();</span></span>
<span class="line"><span style="color:#24292e;">                    thisColumn = brec.getColumn();</span></span>
<span class="line"><span style="color:#24292e;">                    thisStr = &quot;&quot;;</span></span>
<span class="line"><span style="color:#24292e;">                    rowlist.add(thisColumn, thisStr);</span></span>
<span class="line"><span style="color:#24292e;">                    break;</span></span>
<span class="line"><span style="color:#24292e;">                case BoolErrRecord.sid: // 单元格为布尔类型</span></span>
<span class="line"><span style="color:#24292e;">                    BoolErrRecord berec = (BoolErrRecord) record;</span></span>
<span class="line"><span style="color:#24292e;">                    thisRow = berec.getRow();</span></span>
<span class="line"><span style="color:#24292e;">                    thisColumn = berec.getColumn();</span></span>
<span class="line"><span style="color:#24292e;">                    thisStr = berec.getBooleanValue() + &quot;&quot;;</span></span>
<span class="line"><span style="color:#24292e;">                    rowlist.add(thisColumn, thisStr);</span></span>
<span class="line"><span style="color:#24292e;">                    break;</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">                case FormulaRecord.sid: // 单元格为公式类型</span></span>
<span class="line"><span style="color:#24292e;">                    FormulaRecord frec = (FormulaRecord) record;</span></span>
<span class="line"><span style="color:#24292e;">                    thisRow = frec.getRow();</span></span>
<span class="line"><span style="color:#24292e;">                    thisColumn = frec.getColumn();</span></span>
<span class="line"><span style="color:#24292e;">                    if (outputFormulaValues) {</span></span>
<span class="line"><span style="color:#24292e;">                        if (Double.isNaN(frec.getValue())) {</span></span>
<span class="line"><span style="color:#24292e;">                            // Formula result is a string</span></span>
<span class="line"><span style="color:#24292e;">                            // This is stored in the next record</span></span>
<span class="line"><span style="color:#24292e;">                            outputNextStringRecord = true;</span></span>
<span class="line"><span style="color:#24292e;">                            nextRow = frec.getRow();</span></span>
<span class="line"><span style="color:#24292e;">                            nextColumn = frec.getColumn();</span></span>
<span class="line"><span style="color:#24292e;">                        } else {</span></span>
<span class="line"><span style="color:#24292e;">                            thisStr = formatListener.formatNumberDateCell(frec);</span></span>
<span class="line"><span style="color:#24292e;">                        }</span></span>
<span class="line"><span style="color:#24292e;">                    } else {</span></span>
<span class="line"><span style="color:#24292e;">                        thisStr = &#39;&quot;&#39; + HSSFFormulaParser.toFormulaString(stubWorkbook, frec.getParsedExpression()) + &#39;&quot;&#39;;</span></span>
<span class="line"><span style="color:#24292e;">                    }</span></span>
<span class="line"><span style="color:#24292e;">                    rowlist.add(thisColumn, thisStr);</span></span>
<span class="line"><span style="color:#24292e;">                    break;</span></span>
<span class="line"><span style="color:#24292e;">                case StringRecord.sid:// 单元格中公式的字符串</span></span>
<span class="line"><span style="color:#24292e;">                    if (outputNextStringRecord) {</span></span>
<span class="line"><span style="color:#24292e;">                        // String for formula</span></span>
<span class="line"><span style="color:#24292e;">                        StringRecord srec = (StringRecord) record;</span></span>
<span class="line"><span style="color:#24292e;">                        thisStr = srec.getString();</span></span>
<span class="line"><span style="color:#24292e;">                        thisRow = nextRow;</span></span>
<span class="line"><span style="color:#24292e;">                        thisColumn = nextColumn;</span></span>
<span class="line"><span style="color:#24292e;">                        outputNextStringRecord = false;</span></span>
<span class="line"><span style="color:#24292e;">                    }</span></span>
<span class="line"><span style="color:#24292e;">                    break;</span></span>
<span class="line"><span style="color:#24292e;">                case LabelRecord.sid:</span></span>
<span class="line"><span style="color:#24292e;">                    LabelRecord lrec = (LabelRecord) record;</span></span>
<span class="line"><span style="color:#24292e;">                    curRow = thisRow = lrec.getRow();</span></span>
<span class="line"><span style="color:#24292e;">                    thisColumn = lrec.getColumn();</span></span>
<span class="line"><span style="color:#24292e;">                    value = lrec.getValue().trim();</span></span>
<span class="line"><span style="color:#24292e;">                    value = value.equals(&quot;&quot;) ? &quot; &quot; : value;</span></span>
<span class="line"><span style="color:#24292e;">                    this.rowlist.add(thisColumn, value);</span></span>
<span class="line"><span style="color:#24292e;">                    break;</span></span>
<span class="line"><span style="color:#24292e;">                case LabelSSTRecord.sid: // 单元格为字符串类型</span></span>
<span class="line"><span style="color:#24292e;">                    LabelSSTRecord lsrec = (LabelSSTRecord) record;</span></span>
<span class="line"><span style="color:#24292e;">                    curRow = thisRow = lsrec.getRow();</span></span>
<span class="line"><span style="color:#24292e;">                    thisColumn = lsrec.getColumn();</span></span>
<span class="line"><span style="color:#24292e;">                    if (sstRecord == null) {</span></span>
<span class="line"><span style="color:#24292e;">                        rowlist.add(thisColumn, &quot; &quot;);</span></span>
<span class="line"><span style="color:#24292e;">                    } else {</span></span>
<span class="line"><span style="color:#24292e;">                        value = sstRecord.getString(lsrec.getSSTIndex()).toString().trim();</span></span>
<span class="line"><span style="color:#24292e;">                        value = value.equals(&quot;&quot;) ? &quot; &quot; : value;</span></span>
<span class="line"><span style="color:#24292e;">                        rowlist.add(thisColumn, value);</span></span>
<span class="line"><span style="color:#24292e;">                    }</span></span>
<span class="line"><span style="color:#24292e;">                    break;</span></span>
<span class="line"><span style="color:#24292e;">                   case NumberRecord.sid: // 单元格为数字类型</span></span>
<span class="line"><span style="color:#24292e;">                    NumberRecord numrec = (NumberRecord) record;</span></span>
<span class="line"><span style="color:#24292e;">                    curRow = thisRow = numrec.getRow();</span></span>
<span class="line"><span style="color:#24292e;">                    thisColumn = numrec.getColumn();</span></span>
<span class="line"><span style="color:#24292e;">                    value = formatListener.formatNumberDateCell(numrec).trim();</span></span>
<span class="line"><span style="color:#24292e;">                    value = value.equals(&quot;&quot;) ? &quot; &quot; : value;</span></span>
<span class="line"><span style="color:#24292e;">                    // 向容器加入列值</span></span>
<span class="line"><span style="color:#24292e;">                    rowlist.add(thisColumn, value);</span></span>
<span class="line"><span style="color:#24292e;">                    break;</span></span>
<span class="line"><span style="color:#24292e;">                default:</span></span>
<span class="line"><span style="color:#24292e;">                    break;</span></span>
<span class="line"><span style="color:#24292e;">            }</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">            // 遇到新行的操作</span></span>
<span class="line"><span style="color:#24292e;">            if (thisRow != -1 &amp;&amp; thisRow != lastRowNumber) {</span></span>
<span class="line"><span style="color:#24292e;">                lastColumnNumber = -1;</span></span>
<span class="line"><span style="color:#24292e;">            }</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">            // 空值的操作</span></span>
<span class="line"><span style="color:#24292e;">            if (record instanceof MissingCellDummyRecord) {</span></span>
<span class="line"><span style="color:#24292e;">                MissingCellDummyRecord mc = (MissingCellDummyRecord) record;</span></span>
<span class="line"><span style="color:#24292e;">                curRow = thisRow = mc.getRow();</span></span>
<span class="line"><span style="color:#24292e;">                thisColumn = mc.getColumn();</span></span>
<span class="line"><span style="color:#24292e;">                rowlist.add(thisColumn, &quot; &quot;);</span></span>
<span class="line"><span style="color:#24292e;">            }</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">            // 取最大行</span></span>
<span class="line"><span style="color:#24292e;">            if (thisRow == 0) {</span></span>
<span class="line"><span style="color:#24292e;">                maxColNum = thisColumn + 1;</span></span>
<span class="line"><span style="color:#24292e;">            }</span></span>
<span class="line"><span style="color:#24292e;">            // 更新行和列的值</span></span>
<span class="line"><span style="color:#24292e;">            if (thisRow &gt; -1) {</span></span>
<span class="line"><span style="color:#24292e;">                lastRowNumber = thisRow;</span></span>
<span class="line"><span style="color:#24292e;">            }</span></span>
<span class="line"><span style="color:#24292e;">            if (thisColumn &gt; -1) {</span></span>
<span class="line"><span style="color:#24292e;">                lastColumnNumber = thisColumn;</span></span>
<span class="line"><span style="color:#24292e;">            }</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">            // 行结束时的操作</span></span>
<span class="line"><span style="color:#24292e;">            if (record instanceof LastCellOfRowDummyRecord) {</span></span>
<span class="line"><span style="color:#24292e;">                if (minColumns &gt; 0) {</span></span>
<span class="line"><span style="color:#24292e;">                    // 列值重新置空</span></span>
<span class="line"><span style="color:#24292e;">                    if (lastColumnNumber == -1) {</span></span>
<span class="line"><span style="color:#24292e;">                        lastColumnNumber = 0;</span></span>
<span class="line"><span style="color:#24292e;">                    }</span></span>
<span class="line"><span style="color:#24292e;">                }</span></span>
<span class="line"><span style="color:#24292e;">                lastColumnNumber = -1;</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">                // 每行结束时， 调用getRows() 方法</span></span>
<span class="line"><span style="color:#24292e;">                if (rowlist.size() &lt; maxColNum) {</span></span>
<span class="line"><span style="color:#24292e;">                    for (int i = rowlist.size(); i &lt; maxColNum; i++) {</span></span>
<span class="line"><span style="color:#24292e;">                        rowlist.add(&quot;&quot;);</span></span>
<span class="line"><span style="color:#24292e;">                    }</span></span>
<span class="line"><span style="color:#24292e;">                }</span></span>
<span class="line"><span style="color:#24292e;">                List&lt;String&gt; curList = new ArrayList&lt;&gt;(rowlist.size());</span></span>
<span class="line"><span style="color:#24292e;">                for (String s : rowlist) {</span></span>
<span class="line"><span style="color:#24292e;">                    curList.add(s);</span></span>
<span class="line"><span style="color:#24292e;">                }</span></span>
<span class="line"><span style="color:#24292e;">                rowReader.getRows(sheetIndex, curRow, curList);</span></span>
<span class="line"><span style="color:#24292e;">                // 清空容器</span></span>
<span class="line"><span style="color:#24292e;">                rowlist.clear();</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">            }</span></span>
<span class="line"><span style="color:#24292e;">        }</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">    }</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">    public static void main(String[] args) {</span></span>
<span class="line"><span style="color:#24292e;">        ExcelRowReaderInterface rowReader = new ExcelRowReaderImpl();</span></span>
<span class="line"><span style="color:#24292e;">        try {</span></span>
<span class="line"><span style="color:#24292e;">            ExcelReader03EventModel excelReader03EventModel = new ExcelReader03EventModel(rowReader);</span></span>
<span class="line"><span style="color:#24292e;">            excelReader03EventModel.processAllSheet(new File(&quot;D://test//BTS Information.xls&quot;));</span></span>
<span class="line"><span style="color:#24292e;">        } catch (Exception e) {</span></span>
<span class="line"><span style="color:#24292e;">            e.printStackTrace();</span></span>
<span class="line"><span style="color:#24292e;">        }</span></span>
<span class="line"><span style="color:#24292e;">    }</span></span>
<span class="line"><span style="color:#24292e;">}</span></span></code></pre></div><h2 id="_3-读excel2007" tabindex="-1">3. 读Excel2007 <a class="header-anchor" href="#_3-读excel2007" aria-label="Permalink to &quot;3. 读Excel2007&quot;">​</a></h2><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">import org.apache.poi.openxml4j.exceptions.OpenXML4JException;</span></span>
<span class="line"><span style="color:#e1e4e8;">import org.apache.poi.openxml4j.opc.OPCPackage;</span></span>
<span class="line"><span style="color:#e1e4e8;">import org.apache.poi.xssf.eventusermodel.XSSFReader;</span></span>
<span class="line"><span style="color:#e1e4e8;">import org.apache.poi.xssf.model.SharedStringsTable;</span></span>
<span class="line"><span style="color:#e1e4e8;">import org.apache.poi.xssf.usermodel.XSSFRichTextString;</span></span>
<span class="line"><span style="color:#e1e4e8;">import org.xml.sax.*;</span></span>
<span class="line"><span style="color:#e1e4e8;">import org.xml.sax.helpers.DefaultHandler;</span></span>
<span class="line"><span style="color:#e1e4e8;">import org.xml.sax.helpers.XMLReaderFactory;</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">import java.io.File;</span></span>
<span class="line"><span style="color:#e1e4e8;">import java.io.IOException;</span></span>
<span class="line"><span style="color:#e1e4e8;">import java.io.InputStream;</span></span>
<span class="line"><span style="color:#e1e4e8;">import java.util.ArrayList;</span></span>
<span class="line"><span style="color:#e1e4e8;">import java.util.Iterator;</span></span>
<span class="line"><span style="color:#e1e4e8;">import java.util.List;</span></span>
<span class="line"><span style="color:#e1e4e8;">import java.util.regex.Pattern;</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">public class ExcelReader07EventModel {</span></span>
<span class="line"><span style="color:#e1e4e8;">    private int currentRow = -1;</span></span>
<span class="line"><span style="color:#e1e4e8;">    private int sheetIndex = -1;</span></span>
<span class="line"><span style="color:#e1e4e8;">    private int maxColNum;</span></span>
<span class="line"><span style="color:#e1e4e8;">    private List&lt;IndexValue&gt; rowData;</span></span>
<span class="line"><span style="color:#e1e4e8;">    private ExcelRowReaderInterface rowReader;</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">    public ExcelReader07EventModel(ExcelRowReaderInterface rowReader) throws Exception {</span></span>
<span class="line"><span style="color:#e1e4e8;">        this.rowReader = rowReader;</span></span>
<span class="line"><span style="color:#e1e4e8;">    }</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">    // onSheet从1开始</span></span>
<span class="line"><span style="color:#e1e4e8;">    public void processOneSheet(File file, int onSheet) throws Exception {</span></span>
<span class="line"><span style="color:#e1e4e8;">        OPCPackage pkg = OPCPackage.open(file);</span></span>
<span class="line"><span style="color:#e1e4e8;">        XSSFReader r = new XSSFReader(pkg);</span></span>
<span class="line"><span style="color:#e1e4e8;">        SharedStringsTable sst = r.getSharedStringsTable();</span></span>
<span class="line"><span style="color:#e1e4e8;">        XMLReader parser = fetchSheetParser(sst);</span></span>
<span class="line"><span style="color:#e1e4e8;">        sheetIndex = onSheet;</span></span>
<span class="line"><span style="color:#e1e4e8;">        InputStream sheet1 = r.getSheet(&quot;rId&quot; + (onSheet + 1));</span></span>
<span class="line"><span style="color:#e1e4e8;">        InputSource sheetSource = new InputSource(sheet1);</span></span>
<span class="line"><span style="color:#e1e4e8;">        parser.parse(sheetSource);</span></span>
<span class="line"><span style="color:#e1e4e8;">        sheet1.close();</span></span>
<span class="line"><span style="color:#e1e4e8;">    }</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">    public void processAllSheet(File file) throws IOException, OpenXML4JException, SAXException {</span></span>
<span class="line"><span style="color:#e1e4e8;">        OPCPackage pkg = OPCPackage.open(file);</span></span>
<span class="line"><span style="color:#e1e4e8;">        XSSFReader xssfReader = new XSSFReader(pkg);</span></span>
<span class="line"><span style="color:#e1e4e8;">        SharedStringsTable sst = xssfReader.getSharedStringsTable();</span></span>
<span class="line"><span style="color:#e1e4e8;">        XMLReader parser = this.fetchSheetParser(sst);</span></span>
<span class="line"><span style="color:#e1e4e8;">        Iterator&lt;InputStream&gt; sheets = xssfReader.getSheetsData();</span></span>
<span class="line"><span style="color:#e1e4e8;">        while (sheets.hasNext()) {</span></span>
<span class="line"><span style="color:#e1e4e8;">            sheetIndex++;</span></span>
<span class="line"><span style="color:#e1e4e8;">            InputStream sheet = sheets.next();</span></span>
<span class="line"><span style="color:#e1e4e8;">            InputSource sheetSource = new InputSource(sheet);</span></span>
<span class="line"><span style="color:#e1e4e8;">            parser.parse(sheetSource);</span></span>
<span class="line"><span style="color:#e1e4e8;">            sheet.close();</span></span>
<span class="line"><span style="color:#e1e4e8;">        }</span></span>
<span class="line"><span style="color:#e1e4e8;">    }</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">    private XMLReader fetchSheetParser(SharedStringsTable sst) throws SAXException {</span></span>
<span class="line"><span style="color:#e1e4e8;">        XMLReader parser = XMLReaderFactory.createXMLReader(&quot;org.apache.xerces.parsers.SAXParser&quot;);</span></span>
<span class="line"><span style="color:#e1e4e8;">        ContentHandler handler = new PagingHandler(sst);</span></span>
<span class="line"><span style="color:#e1e4e8;">        parser.setContentHandler(handler);</span></span>
<span class="line"><span style="color:#e1e4e8;">        return parser;</span></span>
<span class="line"><span style="color:#e1e4e8;">    }</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">    private class PagingHandler extends DefaultHandler {</span></span>
<span class="line"><span style="color:#e1e4e8;">        private SharedStringsTable sst;</span></span>
<span class="line"><span style="color:#e1e4e8;">        private String lastContents;</span></span>
<span class="line"><span style="color:#e1e4e8;">        private boolean nextIsString;</span></span>
<span class="line"><span style="color:#e1e4e8;">        private String index = null;</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">        private PagingHandler(SharedStringsTable sst) {</span></span>
<span class="line"><span style="color:#e1e4e8;">            this.sst = sst;</span></span>
<span class="line"><span style="color:#e1e4e8;">        }</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">        /**</span></span>
<span class="line"><span style="color:#e1e4e8;">         * 每个单元格开始时的处理</span></span>
<span class="line"><span style="color:#e1e4e8;">         */</span></span>
<span class="line"><span style="color:#e1e4e8;">        @Override</span></span>
<span class="line"><span style="color:#e1e4e8;">        public void startElement(String uri, String localName, String name, Attributes attributes) throws SAXException {</span></span>
<span class="line"><span style="color:#e1e4e8;">            // c =&gt; cell</span></span>
<span class="line"><span style="color:#e1e4e8;">            if (name.equals(&quot;c&quot;)) {</span></span>
<span class="line"><span style="color:#e1e4e8;">                index = attributes.getValue(&quot;r&quot;);</span></span>
<span class="line"><span style="color:#e1e4e8;">                // System.out.println(index);</span></span>
<span class="line"><span style="color:#e1e4e8;">                //这是一个新行</span></span>
<span class="line"><span style="color:#e1e4e8;">                if (Pattern.compile(&quot;^A[0-9]+$&quot;).matcher(index).find()) {</span></span>
<span class="line"><span style="color:#e1e4e8;">                    //存储上一行数据</span></span>
<span class="line"><span style="color:#e1e4e8;">                    if (rowData != null &amp;&amp; !rowData.isEmpty()) {</span></span>
<span class="line"><span style="color:#e1e4e8;">                        try {</span></span>
<span class="line"><span style="color:#e1e4e8;">                            List&lt;String&gt; myDataList = getMyDataList();</span></span>
<span class="line"><span style="color:#e1e4e8;">                            rowReader.getRows(sheetIndex, currentRow, myDataList);</span></span>
<span class="line"><span style="color:#e1e4e8;">                        } catch (Exception e) {</span></span>
<span class="line"><span style="color:#e1e4e8;">                            e.printStackTrace();</span></span>
<span class="line"><span style="color:#e1e4e8;">                        }</span></span>
<span class="line"><span style="color:#e1e4e8;">                    }</span></span>
<span class="line"><span style="color:#e1e4e8;">                    rowData = new ArrayList&lt;IndexValue&gt;();//新行要先清除上一行的数据</span></span>
<span class="line"><span style="color:#e1e4e8;">                    currentRow++;//当前行+1</span></span>
<span class="line"><span style="color:#e1e4e8;">                }</span></span>
<span class="line"><span style="color:#e1e4e8;">                // Figure out if the value is an index in the SST</span></span>
<span class="line"><span style="color:#e1e4e8;">                String cellType = attributes.getValue(&quot;t&quot;);</span></span>
<span class="line"><span style="color:#e1e4e8;">                if (cellType != null &amp;&amp; cellType.equals(&quot;s&quot;)) {</span></span>
<span class="line"><span style="color:#e1e4e8;">                    nextIsString = true;</span></span>
<span class="line"><span style="color:#e1e4e8;">                } else {</span></span>
<span class="line"><span style="color:#e1e4e8;">                    nextIsString = false;</span></span>
<span class="line"><span style="color:#e1e4e8;">                }</span></span>
<span class="line"><span style="color:#e1e4e8;">            }</span></span>
<span class="line"><span style="color:#e1e4e8;">            // Clear contents cache</span></span>
<span class="line"><span style="color:#e1e4e8;">            lastContents = &quot;&quot;;</span></span>
<span class="line"><span style="color:#e1e4e8;">        }</span></span>
<span class="line"><span style="color:#e1e4e8;">                //每个单元格结束时的处理</span></span>
<span class="line"><span style="color:#e1e4e8;">        @Override</span></span>
<span class="line"><span style="color:#e1e4e8;">        public void endElement(String uri, String localName, String name) throws SAXException {</span></span>
<span class="line"><span style="color:#e1e4e8;">            if (nextIsString) {</span></span>
<span class="line"><span style="color:#e1e4e8;">                int idx = Integer.parseInt(lastContents);</span></span>
<span class="line"><span style="color:#e1e4e8;">                lastContents = new XSSFRichTextString(sst.getEntryAt(idx)).toString();</span></span>
<span class="line"><span style="color:#e1e4e8;">                nextIsString = false;</span></span>
<span class="line"><span style="color:#e1e4e8;">            }</span></span>
<span class="line"><span style="color:#e1e4e8;">            if (name.equals(&quot;v&quot;)) {</span></span>
<span class="line"><span style="color:#e1e4e8;">                // System.out.println(lastContents);</span></span>
<span class="line"><span style="color:#e1e4e8;">                rowData.add(new IndexValue(index, lastContents));</span></span>
<span class="line"><span style="color:#e1e4e8;">            }</span></span>
<span class="line"><span style="color:#e1e4e8;">        }</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">        @Override</span></span>
<span class="line"><span style="color:#e1e4e8;">        public void characters(char[] ch, int start, int length) throws SAXException {</span></span>
<span class="line"><span style="color:#e1e4e8;">            lastContents += new String(ch, start, length);</span></span>
<span class="line"><span style="color:#e1e4e8;">        }</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">        @Override</span></span>
<span class="line"><span style="color:#e1e4e8;">        public void endDocument() throws SAXException {</span></span>
<span class="line"><span style="color:#e1e4e8;">            if (rowData != null &amp;&amp; !rowData.isEmpty()) {</span></span>
<span class="line"><span style="color:#e1e4e8;">                try {</span></span>
<span class="line"><span style="color:#e1e4e8;">                    List&lt;String&gt; myDataList = getMyDataList();</span></span>
<span class="line"><span style="color:#e1e4e8;">                    rowReader.getRows(sheetIndex, currentRow, myDataList);</span></span>
<span class="line"><span style="color:#e1e4e8;">                } catch (Exception e) {</span></span>
<span class="line"><span style="color:#e1e4e8;">                    e.printStackTrace();</span></span>
<span class="line"><span style="color:#e1e4e8;">                }</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">            }</span></span>
<span class="line"><span style="color:#e1e4e8;">        }</span></span>
<span class="line"><span style="color:#e1e4e8;">    }</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">    private class IndexValue {</span></span>
<span class="line"><span style="color:#e1e4e8;">        String v_index;</span></span>
<span class="line"><span style="color:#e1e4e8;">        String v_value;</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">        public IndexValue(String v_index, String v_value) {</span></span>
<span class="line"><span style="color:#e1e4e8;">            super();</span></span>
<span class="line"><span style="color:#e1e4e8;">            this.v_index = v_index;</span></span>
<span class="line"><span style="color:#e1e4e8;">            this.v_value = v_value;</span></span>
<span class="line"><span style="color:#e1e4e8;">        }</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">        @Override</span></span>
<span class="line"><span style="color:#e1e4e8;">        public String toString() {</span></span>
<span class="line"><span style="color:#e1e4e8;">            return &quot;IndexValue [v_index=&quot; + v_index + &quot;, v_value=&quot; + v_value + &quot;]&quot;;</span></span>
<span class="line"><span style="color:#e1e4e8;">        }</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">        public int getLevel(IndexValue p) {</span></span>
<span class="line"><span style="color:#e1e4e8;">            char[] other = p.v_index.replaceAll(&quot;[0-9]&quot;, &quot;&quot;).toUpperCase().toCharArray();</span></span>
<span class="line"><span style="color:#e1e4e8;">            char[] self = this.v_index.replaceAll(&quot;[0-9]&quot;, &quot;&quot;).toUpperCase().toCharArray();</span></span>
<span class="line"><span style="color:#e1e4e8;">            int self_num = 0;</span></span>
<span class="line"><span style="color:#e1e4e8;">            int other_num = 0;</span></span>
<span class="line"><span style="color:#e1e4e8;">            for (int i = 0; i &lt; self.length; i++) {</span></span>
<span class="line"><span style="color:#e1e4e8;">                self_num = self_num * 26 + (self[i] - 64);</span></span>
<span class="line"><span style="color:#e1e4e8;">            }</span></span>
<span class="line"><span style="color:#e1e4e8;">            for (int i = 0; i &lt; other.length; i++) {</span></span>
<span class="line"><span style="color:#e1e4e8;">                other_num = other_num * 26 + (other[i] - 64);</span></span>
<span class="line"><span style="color:#e1e4e8;">            }</span></span>
<span class="line"><span style="color:#e1e4e8;">            return self_num - other_num;</span></span>
<span class="line"><span style="color:#e1e4e8;">        }</span></span>
<span class="line"><span style="color:#e1e4e8;">    }</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">    /**</span></span>
<span class="line"><span style="color:#e1e4e8;">     * 获取真实的数据（处理空格）</span></span>
<span class="line"><span style="color:#e1e4e8;">     */</span></span>
<span class="line"><span style="color:#e1e4e8;">    public List&lt;String&gt; getMyDataList() throws Exception {</span></span>
<span class="line"><span style="color:#e1e4e8;">        List&lt;String&gt; myDataList = new ArrayList&lt;&gt;();</span></span>
<span class="line"><span style="color:#e1e4e8;">        if (rowData == null || rowData.size() &lt;= 0) {</span></span>
<span class="line"><span style="color:#e1e4e8;">            return myDataList;</span></span>
<span class="line"><span style="color:#e1e4e8;">        }</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">        int j = 0;</span></span>
<span class="line"><span style="color:#e1e4e8;">        for (; j &lt; rowData.size() - 1; j++) {</span></span>
<span class="line"><span style="color:#e1e4e8;">            //获取当前值,并存储</span></span>
<span class="line"><span style="color:#e1e4e8;">            IndexValue current = rowData.get(j);</span></span>
<span class="line"><span style="color:#e1e4e8;">            myDataList.add(current.v_value);</span></span>
<span class="line"><span style="color:#e1e4e8;">            //预存下一个</span></span>
<span class="line"><span style="color:#e1e4e8;">            IndexValue next = rowData.get(j + 1);</span></span>
<span class="line"><span style="color:#e1e4e8;">            //获取差值</span></span>
<span class="line"><span style="color:#e1e4e8;">            int level = next.getLevel(current);</span></span>
<span class="line"><span style="color:#e1e4e8;">            if (level &lt;= 0) {</span></span>
<span class="line"><span style="color:#e1e4e8;">                throw new Exception(&quot;超出处理范围&quot;);</span></span>
<span class="line"><span style="color:#e1e4e8;">            }</span></span>
<span class="line"><span style="color:#e1e4e8;">            for (int k = 0; k &lt; level - 1; k++) {</span></span>
<span class="line"><span style="color:#e1e4e8;">                myDataList.add(&quot;&quot;);</span></span>
<span class="line"><span style="color:#e1e4e8;">            }</span></span>
<span class="line"><span style="color:#e1e4e8;">        }</span></span>
<span class="line"><span style="color:#e1e4e8;">        myDataList.add(rowData.get(j).v_value);</span></span>
<span class="line"><span style="color:#e1e4e8;">        if (currentRow == 0) {</span></span>
<span class="line"><span style="color:#e1e4e8;">            maxColNum = myDataList.size();</span></span>
<span class="line"><span style="color:#e1e4e8;">        }</span></span>
<span class="line"><span style="color:#e1e4e8;">        for (int i = myDataList.size(); i &lt; maxColNum; i++) {</span></span>
<span class="line"><span style="color:#e1e4e8;">            myDataList.add(&quot;&quot;);</span></span>
<span class="line"><span style="color:#e1e4e8;">        }</span></span>
<span class="line"><span style="color:#e1e4e8;">        return myDataList;</span></span>
<span class="line"><span style="color:#e1e4e8;">    }</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">    public static void main(String[] args) throws Exception {</span></span>
<span class="line"><span style="color:#e1e4e8;">        File file = new File(&quot;D:\\test\\zjctest07.xlsx&quot;);</span></span>
<span class="line"><span style="color:#e1e4e8;">        ExcelRowReaderImpl excelRowReader = new ExcelRowReaderImpl();</span></span>
<span class="line"><span style="color:#e1e4e8;">        ExcelReader07EventModel test = new ExcelReader07EventModel(excelRowReader);</span></span>
<span class="line"><span style="color:#e1e4e8;">        test.processOneSheet(file, 0);</span></span>
<span class="line"><span style="color:#e1e4e8;">    }</span></span>
<span class="line"><span style="color:#e1e4e8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">import org.apache.poi.openxml4j.exceptions.OpenXML4JException;</span></span>
<span class="line"><span style="color:#24292e;">import org.apache.poi.openxml4j.opc.OPCPackage;</span></span>
<span class="line"><span style="color:#24292e;">import org.apache.poi.xssf.eventusermodel.XSSFReader;</span></span>
<span class="line"><span style="color:#24292e;">import org.apache.poi.xssf.model.SharedStringsTable;</span></span>
<span class="line"><span style="color:#24292e;">import org.apache.poi.xssf.usermodel.XSSFRichTextString;</span></span>
<span class="line"><span style="color:#24292e;">import org.xml.sax.*;</span></span>
<span class="line"><span style="color:#24292e;">import org.xml.sax.helpers.DefaultHandler;</span></span>
<span class="line"><span style="color:#24292e;">import org.xml.sax.helpers.XMLReaderFactory;</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">import java.io.File;</span></span>
<span class="line"><span style="color:#24292e;">import java.io.IOException;</span></span>
<span class="line"><span style="color:#24292e;">import java.io.InputStream;</span></span>
<span class="line"><span style="color:#24292e;">import java.util.ArrayList;</span></span>
<span class="line"><span style="color:#24292e;">import java.util.Iterator;</span></span>
<span class="line"><span style="color:#24292e;">import java.util.List;</span></span>
<span class="line"><span style="color:#24292e;">import java.util.regex.Pattern;</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">public class ExcelReader07EventModel {</span></span>
<span class="line"><span style="color:#24292e;">    private int currentRow = -1;</span></span>
<span class="line"><span style="color:#24292e;">    private int sheetIndex = -1;</span></span>
<span class="line"><span style="color:#24292e;">    private int maxColNum;</span></span>
<span class="line"><span style="color:#24292e;">    private List&lt;IndexValue&gt; rowData;</span></span>
<span class="line"><span style="color:#24292e;">    private ExcelRowReaderInterface rowReader;</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">    public ExcelReader07EventModel(ExcelRowReaderInterface rowReader) throws Exception {</span></span>
<span class="line"><span style="color:#24292e;">        this.rowReader = rowReader;</span></span>
<span class="line"><span style="color:#24292e;">    }</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">    // onSheet从1开始</span></span>
<span class="line"><span style="color:#24292e;">    public void processOneSheet(File file, int onSheet) throws Exception {</span></span>
<span class="line"><span style="color:#24292e;">        OPCPackage pkg = OPCPackage.open(file);</span></span>
<span class="line"><span style="color:#24292e;">        XSSFReader r = new XSSFReader(pkg);</span></span>
<span class="line"><span style="color:#24292e;">        SharedStringsTable sst = r.getSharedStringsTable();</span></span>
<span class="line"><span style="color:#24292e;">        XMLReader parser = fetchSheetParser(sst);</span></span>
<span class="line"><span style="color:#24292e;">        sheetIndex = onSheet;</span></span>
<span class="line"><span style="color:#24292e;">        InputStream sheet1 = r.getSheet(&quot;rId&quot; + (onSheet + 1));</span></span>
<span class="line"><span style="color:#24292e;">        InputSource sheetSource = new InputSource(sheet1);</span></span>
<span class="line"><span style="color:#24292e;">        parser.parse(sheetSource);</span></span>
<span class="line"><span style="color:#24292e;">        sheet1.close();</span></span>
<span class="line"><span style="color:#24292e;">    }</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">    public void processAllSheet(File file) throws IOException, OpenXML4JException, SAXException {</span></span>
<span class="line"><span style="color:#24292e;">        OPCPackage pkg = OPCPackage.open(file);</span></span>
<span class="line"><span style="color:#24292e;">        XSSFReader xssfReader = new XSSFReader(pkg);</span></span>
<span class="line"><span style="color:#24292e;">        SharedStringsTable sst = xssfReader.getSharedStringsTable();</span></span>
<span class="line"><span style="color:#24292e;">        XMLReader parser = this.fetchSheetParser(sst);</span></span>
<span class="line"><span style="color:#24292e;">        Iterator&lt;InputStream&gt; sheets = xssfReader.getSheetsData();</span></span>
<span class="line"><span style="color:#24292e;">        while (sheets.hasNext()) {</span></span>
<span class="line"><span style="color:#24292e;">            sheetIndex++;</span></span>
<span class="line"><span style="color:#24292e;">            InputStream sheet = sheets.next();</span></span>
<span class="line"><span style="color:#24292e;">            InputSource sheetSource = new InputSource(sheet);</span></span>
<span class="line"><span style="color:#24292e;">            parser.parse(sheetSource);</span></span>
<span class="line"><span style="color:#24292e;">            sheet.close();</span></span>
<span class="line"><span style="color:#24292e;">        }</span></span>
<span class="line"><span style="color:#24292e;">    }</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">    private XMLReader fetchSheetParser(SharedStringsTable sst) throws SAXException {</span></span>
<span class="line"><span style="color:#24292e;">        XMLReader parser = XMLReaderFactory.createXMLReader(&quot;org.apache.xerces.parsers.SAXParser&quot;);</span></span>
<span class="line"><span style="color:#24292e;">        ContentHandler handler = new PagingHandler(sst);</span></span>
<span class="line"><span style="color:#24292e;">        parser.setContentHandler(handler);</span></span>
<span class="line"><span style="color:#24292e;">        return parser;</span></span>
<span class="line"><span style="color:#24292e;">    }</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">    private class PagingHandler extends DefaultHandler {</span></span>
<span class="line"><span style="color:#24292e;">        private SharedStringsTable sst;</span></span>
<span class="line"><span style="color:#24292e;">        private String lastContents;</span></span>
<span class="line"><span style="color:#24292e;">        private boolean nextIsString;</span></span>
<span class="line"><span style="color:#24292e;">        private String index = null;</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">        private PagingHandler(SharedStringsTable sst) {</span></span>
<span class="line"><span style="color:#24292e;">            this.sst = sst;</span></span>
<span class="line"><span style="color:#24292e;">        }</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">        /**</span></span>
<span class="line"><span style="color:#24292e;">         * 每个单元格开始时的处理</span></span>
<span class="line"><span style="color:#24292e;">         */</span></span>
<span class="line"><span style="color:#24292e;">        @Override</span></span>
<span class="line"><span style="color:#24292e;">        public void startElement(String uri, String localName, String name, Attributes attributes) throws SAXException {</span></span>
<span class="line"><span style="color:#24292e;">            // c =&gt; cell</span></span>
<span class="line"><span style="color:#24292e;">            if (name.equals(&quot;c&quot;)) {</span></span>
<span class="line"><span style="color:#24292e;">                index = attributes.getValue(&quot;r&quot;);</span></span>
<span class="line"><span style="color:#24292e;">                // System.out.println(index);</span></span>
<span class="line"><span style="color:#24292e;">                //这是一个新行</span></span>
<span class="line"><span style="color:#24292e;">                if (Pattern.compile(&quot;^A[0-9]+$&quot;).matcher(index).find()) {</span></span>
<span class="line"><span style="color:#24292e;">                    //存储上一行数据</span></span>
<span class="line"><span style="color:#24292e;">                    if (rowData != null &amp;&amp; !rowData.isEmpty()) {</span></span>
<span class="line"><span style="color:#24292e;">                        try {</span></span>
<span class="line"><span style="color:#24292e;">                            List&lt;String&gt; myDataList = getMyDataList();</span></span>
<span class="line"><span style="color:#24292e;">                            rowReader.getRows(sheetIndex, currentRow, myDataList);</span></span>
<span class="line"><span style="color:#24292e;">                        } catch (Exception e) {</span></span>
<span class="line"><span style="color:#24292e;">                            e.printStackTrace();</span></span>
<span class="line"><span style="color:#24292e;">                        }</span></span>
<span class="line"><span style="color:#24292e;">                    }</span></span>
<span class="line"><span style="color:#24292e;">                    rowData = new ArrayList&lt;IndexValue&gt;();//新行要先清除上一行的数据</span></span>
<span class="line"><span style="color:#24292e;">                    currentRow++;//当前行+1</span></span>
<span class="line"><span style="color:#24292e;">                }</span></span>
<span class="line"><span style="color:#24292e;">                // Figure out if the value is an index in the SST</span></span>
<span class="line"><span style="color:#24292e;">                String cellType = attributes.getValue(&quot;t&quot;);</span></span>
<span class="line"><span style="color:#24292e;">                if (cellType != null &amp;&amp; cellType.equals(&quot;s&quot;)) {</span></span>
<span class="line"><span style="color:#24292e;">                    nextIsString = true;</span></span>
<span class="line"><span style="color:#24292e;">                } else {</span></span>
<span class="line"><span style="color:#24292e;">                    nextIsString = false;</span></span>
<span class="line"><span style="color:#24292e;">                }</span></span>
<span class="line"><span style="color:#24292e;">            }</span></span>
<span class="line"><span style="color:#24292e;">            // Clear contents cache</span></span>
<span class="line"><span style="color:#24292e;">            lastContents = &quot;&quot;;</span></span>
<span class="line"><span style="color:#24292e;">        }</span></span>
<span class="line"><span style="color:#24292e;">                //每个单元格结束时的处理</span></span>
<span class="line"><span style="color:#24292e;">        @Override</span></span>
<span class="line"><span style="color:#24292e;">        public void endElement(String uri, String localName, String name) throws SAXException {</span></span>
<span class="line"><span style="color:#24292e;">            if (nextIsString) {</span></span>
<span class="line"><span style="color:#24292e;">                int idx = Integer.parseInt(lastContents);</span></span>
<span class="line"><span style="color:#24292e;">                lastContents = new XSSFRichTextString(sst.getEntryAt(idx)).toString();</span></span>
<span class="line"><span style="color:#24292e;">                nextIsString = false;</span></span>
<span class="line"><span style="color:#24292e;">            }</span></span>
<span class="line"><span style="color:#24292e;">            if (name.equals(&quot;v&quot;)) {</span></span>
<span class="line"><span style="color:#24292e;">                // System.out.println(lastContents);</span></span>
<span class="line"><span style="color:#24292e;">                rowData.add(new IndexValue(index, lastContents));</span></span>
<span class="line"><span style="color:#24292e;">            }</span></span>
<span class="line"><span style="color:#24292e;">        }</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">        @Override</span></span>
<span class="line"><span style="color:#24292e;">        public void characters(char[] ch, int start, int length) throws SAXException {</span></span>
<span class="line"><span style="color:#24292e;">            lastContents += new String(ch, start, length);</span></span>
<span class="line"><span style="color:#24292e;">        }</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">        @Override</span></span>
<span class="line"><span style="color:#24292e;">        public void endDocument() throws SAXException {</span></span>
<span class="line"><span style="color:#24292e;">            if (rowData != null &amp;&amp; !rowData.isEmpty()) {</span></span>
<span class="line"><span style="color:#24292e;">                try {</span></span>
<span class="line"><span style="color:#24292e;">                    List&lt;String&gt; myDataList = getMyDataList();</span></span>
<span class="line"><span style="color:#24292e;">                    rowReader.getRows(sheetIndex, currentRow, myDataList);</span></span>
<span class="line"><span style="color:#24292e;">                } catch (Exception e) {</span></span>
<span class="line"><span style="color:#24292e;">                    e.printStackTrace();</span></span>
<span class="line"><span style="color:#24292e;">                }</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">            }</span></span>
<span class="line"><span style="color:#24292e;">        }</span></span>
<span class="line"><span style="color:#24292e;">    }</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">    private class IndexValue {</span></span>
<span class="line"><span style="color:#24292e;">        String v_index;</span></span>
<span class="line"><span style="color:#24292e;">        String v_value;</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">        public IndexValue(String v_index, String v_value) {</span></span>
<span class="line"><span style="color:#24292e;">            super();</span></span>
<span class="line"><span style="color:#24292e;">            this.v_index = v_index;</span></span>
<span class="line"><span style="color:#24292e;">            this.v_value = v_value;</span></span>
<span class="line"><span style="color:#24292e;">        }</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">        @Override</span></span>
<span class="line"><span style="color:#24292e;">        public String toString() {</span></span>
<span class="line"><span style="color:#24292e;">            return &quot;IndexValue [v_index=&quot; + v_index + &quot;, v_value=&quot; + v_value + &quot;]&quot;;</span></span>
<span class="line"><span style="color:#24292e;">        }</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">        public int getLevel(IndexValue p) {</span></span>
<span class="line"><span style="color:#24292e;">            char[] other = p.v_index.replaceAll(&quot;[0-9]&quot;, &quot;&quot;).toUpperCase().toCharArray();</span></span>
<span class="line"><span style="color:#24292e;">            char[] self = this.v_index.replaceAll(&quot;[0-9]&quot;, &quot;&quot;).toUpperCase().toCharArray();</span></span>
<span class="line"><span style="color:#24292e;">            int self_num = 0;</span></span>
<span class="line"><span style="color:#24292e;">            int other_num = 0;</span></span>
<span class="line"><span style="color:#24292e;">            for (int i = 0; i &lt; self.length; i++) {</span></span>
<span class="line"><span style="color:#24292e;">                self_num = self_num * 26 + (self[i] - 64);</span></span>
<span class="line"><span style="color:#24292e;">            }</span></span>
<span class="line"><span style="color:#24292e;">            for (int i = 0; i &lt; other.length; i++) {</span></span>
<span class="line"><span style="color:#24292e;">                other_num = other_num * 26 + (other[i] - 64);</span></span>
<span class="line"><span style="color:#24292e;">            }</span></span>
<span class="line"><span style="color:#24292e;">            return self_num - other_num;</span></span>
<span class="line"><span style="color:#24292e;">        }</span></span>
<span class="line"><span style="color:#24292e;">    }</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">    /**</span></span>
<span class="line"><span style="color:#24292e;">     * 获取真实的数据（处理空格）</span></span>
<span class="line"><span style="color:#24292e;">     */</span></span>
<span class="line"><span style="color:#24292e;">    public List&lt;String&gt; getMyDataList() throws Exception {</span></span>
<span class="line"><span style="color:#24292e;">        List&lt;String&gt; myDataList = new ArrayList&lt;&gt;();</span></span>
<span class="line"><span style="color:#24292e;">        if (rowData == null || rowData.size() &lt;= 0) {</span></span>
<span class="line"><span style="color:#24292e;">            return myDataList;</span></span>
<span class="line"><span style="color:#24292e;">        }</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">        int j = 0;</span></span>
<span class="line"><span style="color:#24292e;">        for (; j &lt; rowData.size() - 1; j++) {</span></span>
<span class="line"><span style="color:#24292e;">            //获取当前值,并存储</span></span>
<span class="line"><span style="color:#24292e;">            IndexValue current = rowData.get(j);</span></span>
<span class="line"><span style="color:#24292e;">            myDataList.add(current.v_value);</span></span>
<span class="line"><span style="color:#24292e;">            //预存下一个</span></span>
<span class="line"><span style="color:#24292e;">            IndexValue next = rowData.get(j + 1);</span></span>
<span class="line"><span style="color:#24292e;">            //获取差值</span></span>
<span class="line"><span style="color:#24292e;">            int level = next.getLevel(current);</span></span>
<span class="line"><span style="color:#24292e;">            if (level &lt;= 0) {</span></span>
<span class="line"><span style="color:#24292e;">                throw new Exception(&quot;超出处理范围&quot;);</span></span>
<span class="line"><span style="color:#24292e;">            }</span></span>
<span class="line"><span style="color:#24292e;">            for (int k = 0; k &lt; level - 1; k++) {</span></span>
<span class="line"><span style="color:#24292e;">                myDataList.add(&quot;&quot;);</span></span>
<span class="line"><span style="color:#24292e;">            }</span></span>
<span class="line"><span style="color:#24292e;">        }</span></span>
<span class="line"><span style="color:#24292e;">        myDataList.add(rowData.get(j).v_value);</span></span>
<span class="line"><span style="color:#24292e;">        if (currentRow == 0) {</span></span>
<span class="line"><span style="color:#24292e;">            maxColNum = myDataList.size();</span></span>
<span class="line"><span style="color:#24292e;">        }</span></span>
<span class="line"><span style="color:#24292e;">        for (int i = myDataList.size(); i &lt; maxColNum; i++) {</span></span>
<span class="line"><span style="color:#24292e;">            myDataList.add(&quot;&quot;);</span></span>
<span class="line"><span style="color:#24292e;">        }</span></span>
<span class="line"><span style="color:#24292e;">        return myDataList;</span></span>
<span class="line"><span style="color:#24292e;">    }</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">    public static void main(String[] args) throws Exception {</span></span>
<span class="line"><span style="color:#24292e;">        File file = new File(&quot;D:\\test\\zjctest07.xlsx&quot;);</span></span>
<span class="line"><span style="color:#24292e;">        ExcelRowReaderImpl excelRowReader = new ExcelRowReaderImpl();</span></span>
<span class="line"><span style="color:#24292e;">        ExcelReader07EventModel test = new ExcelReader07EventModel(excelRowReader);</span></span>
<span class="line"><span style="color:#24292e;">        test.processOneSheet(file, 0);</span></span>
<span class="line"><span style="color:#24292e;">    }</span></span>
<span class="line"><span style="color:#24292e;">}</span></span></code></pre></div><h2 id="_4-工具类" tabindex="-1">4. 工具类 <a class="header-anchor" href="#_4-工具类" aria-label="Permalink to &quot;4. 工具类&quot;">​</a></h2><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">public class ExcelReaderUtil {</span></span>
<span class="line"><span style="color:#e1e4e8;">    public static final String EXCEL03_EXTENSION = &quot;.xls&quot;;</span></span>
<span class="line"><span style="color:#e1e4e8;">    public static final String EXCEL07_EXTENSION = &quot;.xlsx&quot;;</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">    // sheetnum从0开始</span></span>
<span class="line"><span style="color:#e1e4e8;">    public static void readExcel(ExcelRowReaderInterface reader, File file, int sheetnum) throws Exception {</span></span>
<span class="line"><span style="color:#e1e4e8;">        String fileName = file.getName();</span></span>
<span class="line"><span style="color:#e1e4e8;">        if (fileName.endsWith(EXCEL03_EXTENSION)) {</span></span>
<span class="line"><span style="color:#e1e4e8;">            ExcelReader03EventModel excelReader03EventModel = new ExcelReader03EventModel(reader);</span></span>
<span class="line"><span style="color:#e1e4e8;">            excelReader03EventModel.processOneSheet(file, sheetnum);</span></span>
<span class="line"><span style="color:#e1e4e8;">        } else if (fileName.endsWith(EXCEL07_EXTENSION)) {</span></span>
<span class="line"><span style="color:#e1e4e8;">            ExcelReader07EventModel excelReader07EventModel = new ExcelReader07EventModel(reader);</span></span>
<span class="line"><span style="color:#e1e4e8;">            excelReader07EventModel.processOneSheet(file, sheetnum);</span></span>
<span class="line"><span style="color:#e1e4e8;">        } else {</span></span>
<span class="line"><span style="color:#e1e4e8;">            throw new Exception(&quot;文件格式错误，fileName的扩展名只能是xls或xlsx。&quot;);</span></span>
<span class="line"><span style="color:#e1e4e8;">        }</span></span>
<span class="line"><span style="color:#e1e4e8;">    }</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">    public static void readExcel(ExcelRowReaderInterface reader, File file) throws Exception {</span></span>
<span class="line"><span style="color:#e1e4e8;">        String fileName = file.getName();</span></span>
<span class="line"><span style="color:#e1e4e8;">        if (fileName.endsWith(EXCEL03_EXTENSION)) {</span></span>
<span class="line"><span style="color:#e1e4e8;">            ExcelReader03EventModel excelReader03EventModel = new ExcelReader03EventModel(reader);</span></span>
<span class="line"><span style="color:#e1e4e8;">            excelReader03EventModel.processAllSheet(file);</span></span>
<span class="line"><span style="color:#e1e4e8;">        } else if (fileName.endsWith(EXCEL07_EXTENSION)) {</span></span>
<span class="line"><span style="color:#e1e4e8;">            ExcelReader07EventModel excelReader07EventModel = new ExcelReader07EventModel(reader);</span></span>
<span class="line"><span style="color:#e1e4e8;">            excelReader07EventModel.processAllSheet(file);</span></span>
<span class="line"><span style="color:#e1e4e8;">        } else {</span></span>
<span class="line"><span style="color:#e1e4e8;">            throw new Exception(&quot;文件格式错误，fileName的扩展名只能是xls或xlsx。&quot;);</span></span>
<span class="line"><span style="color:#e1e4e8;">        }</span></span>
<span class="line"><span style="color:#e1e4e8;">    }</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">    public static void main(String[] args) throws Exception {</span></span>
<span class="line"><span style="color:#e1e4e8;">        ExcelRowReaderInterface rowReader = new ExcelRowReaderImpl();</span></span>
<span class="line"><span style="color:#e1e4e8;">        ExcelReaderUtil.readExcel(rowReader, new File(&quot;D:\\test\\zjctest03.xls&quot;), 0);</span></span>
<span class="line"><span style="color:#e1e4e8;">    }</span></span>
<span class="line"><span style="color:#e1e4e8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">public class ExcelReaderUtil {</span></span>
<span class="line"><span style="color:#24292e;">    public static final String EXCEL03_EXTENSION = &quot;.xls&quot;;</span></span>
<span class="line"><span style="color:#24292e;">    public static final String EXCEL07_EXTENSION = &quot;.xlsx&quot;;</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">    // sheetnum从0开始</span></span>
<span class="line"><span style="color:#24292e;">    public static void readExcel(ExcelRowReaderInterface reader, File file, int sheetnum) throws Exception {</span></span>
<span class="line"><span style="color:#24292e;">        String fileName = file.getName();</span></span>
<span class="line"><span style="color:#24292e;">        if (fileName.endsWith(EXCEL03_EXTENSION)) {</span></span>
<span class="line"><span style="color:#24292e;">            ExcelReader03EventModel excelReader03EventModel = new ExcelReader03EventModel(reader);</span></span>
<span class="line"><span style="color:#24292e;">            excelReader03EventModel.processOneSheet(file, sheetnum);</span></span>
<span class="line"><span style="color:#24292e;">        } else if (fileName.endsWith(EXCEL07_EXTENSION)) {</span></span>
<span class="line"><span style="color:#24292e;">            ExcelReader07EventModel excelReader07EventModel = new ExcelReader07EventModel(reader);</span></span>
<span class="line"><span style="color:#24292e;">            excelReader07EventModel.processOneSheet(file, sheetnum);</span></span>
<span class="line"><span style="color:#24292e;">        } else {</span></span>
<span class="line"><span style="color:#24292e;">            throw new Exception(&quot;文件格式错误，fileName的扩展名只能是xls或xlsx。&quot;);</span></span>
<span class="line"><span style="color:#24292e;">        }</span></span>
<span class="line"><span style="color:#24292e;">    }</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">    public static void readExcel(ExcelRowReaderInterface reader, File file) throws Exception {</span></span>
<span class="line"><span style="color:#24292e;">        String fileName = file.getName();</span></span>
<span class="line"><span style="color:#24292e;">        if (fileName.endsWith(EXCEL03_EXTENSION)) {</span></span>
<span class="line"><span style="color:#24292e;">            ExcelReader03EventModel excelReader03EventModel = new ExcelReader03EventModel(reader);</span></span>
<span class="line"><span style="color:#24292e;">            excelReader03EventModel.processAllSheet(file);</span></span>
<span class="line"><span style="color:#24292e;">        } else if (fileName.endsWith(EXCEL07_EXTENSION)) {</span></span>
<span class="line"><span style="color:#24292e;">            ExcelReader07EventModel excelReader07EventModel = new ExcelReader07EventModel(reader);</span></span>
<span class="line"><span style="color:#24292e;">            excelReader07EventModel.processAllSheet(file);</span></span>
<span class="line"><span style="color:#24292e;">        } else {</span></span>
<span class="line"><span style="color:#24292e;">            throw new Exception(&quot;文件格式错误，fileName的扩展名只能是xls或xlsx。&quot;);</span></span>
<span class="line"><span style="color:#24292e;">        }</span></span>
<span class="line"><span style="color:#24292e;">    }</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">    public static void main(String[] args) throws Exception {</span></span>
<span class="line"><span style="color:#24292e;">        ExcelRowReaderInterface rowReader = new ExcelRowReaderImpl();</span></span>
<span class="line"><span style="color:#24292e;">        ExcelReaderUtil.readExcel(rowReader, new File(&quot;D:\\test\\zjctest03.xls&quot;), 0);</span></span>
<span class="line"><span style="color:#24292e;">    }</span></span>
<span class="line"><span style="color:#24292e;">}</span></span></code></pre></div></div></div></main><footer class="VPDocFooter" data-v-6b87e69f data-v-ef5dee53><!--[--><!--]--><div class="edit-info" data-v-ef5dee53><div class="edit-link" data-v-ef5dee53><a class="VPLink link vp-external-link-icon no-icon edit-link-button" href="https://github.com/mingriyingying/mingriyingying.github.io/blob/master/docs/articles/Java/01Java语法/10Java读大数据量excel.md" target="_blank" rel="noreferrer" data-v-ef5dee53><!--[--><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="edit-link-icon" aria-label="edit icon" data-v-ef5dee53><path d="M18,23H4c-1.7,0-3-1.3-3-3V6c0-1.7,1.3-3,3-3h7c0.6,0,1,0.4,1,1s-0.4,1-1,1H4C3.4,5,3,5.4,3,6v14c0,0.6,0.4,1,1,1h14c0.6,0,1-0.4,1-1v-7c0-0.6,0.4-1,1-1s1,0.4,1,1v7C21,21.7,19.7,23,18,23z"></path><path d="M8,17c-0.3,0-0.5-0.1-0.7-0.3C7,16.5,6.9,16.1,7,15.8l1-4c0-0.2,0.1-0.3,0.3-0.5l9.5-9.5c1.2-1.2,3.2-1.2,4.4,0c1.2,1.2,1.2,3.2,0,4.4l-9.5,9.5c-0.1,0.1-0.3,0.2-0.5,0.3l-4,1C8.2,17,8.1,17,8,17zM9.9,12.5l-0.5,2.1l2.1-0.5l9.3-9.3c0.4-0.4,0.4-1.1,0-1.6c-0.4-0.4-1.2-0.4-1.6,0l0,0L9.9,12.5z M18.5,2.5L18.5,2.5L18.5,2.5z"></path></svg> Edit this page on GitHub<!--]--></a></div><div class="last-updated" data-v-ef5dee53><p class="VPLastUpdated" data-v-ef5dee53 data-v-7e05ebdb>Updated at: <time datetime="2023-10-24T16:32:39.000Z" data-v-7e05ebdb></time></p></div></div><!----></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"about_index.md\":\"071b339e\",\"articles_java_66jenkins_index.md\":\"6400198e\",\"articles_java_65vue_index.md\":\"9e63742a\",\"articles_java_01java语法_10java读大数据量csv.md\":\"c66cbbf6\",\"articles_java_01java语法_10java读大数据量excel.md\":\"a481ce92\",\"articles_java_01java语法_10web前后端大文件上传和接收.md\":\"f0eb19d1\",\"articles_java_01java语法_11java线程池的使用.md\":\"5f86e376\",\"articles_java_01java语法_12java正则化.md\":\"1a1b13a2\",\"articles_java_01java语法_index.md\":\"9d3f4eb4\",\"articles_java_51springboot_03日志slf4j.md\":\"dc4b9520\",\"articles_java_22janusgraph_index.md\":\"84ec1938\",\"articles_java_51springboot_04缓存redis.md\":\"d78a9161\",\"articles_java_51springboot_05安全shiro.md\":\"745f9a3d\",\"articles_java_51springboot_05安全springsecurity.md\":\"a4f69e18\",\"articles_java_51springboot_06分页pagehelper.md\":\"d8a3f64d\",\"articles_java_51springboot_10读文件.md\":\"8277ff09\",\"articles_java_51springboot_index.md\":\"bd5341c1\",\"articles_java_53arthus_index.md\":\"9a158468\",\"articles_java_65redis_index.md\":\"e53ca56c\",\"articles_java_65vue_01vue3_ts语法.md\":\"19b6c7b4\",\"articles_java_65vue_02vue3实战.md\":\"cb77f732\",\"articles_java_65redis_02redis集群搭建.md\":\"dc23c975\",\"articles_java_60kafka_index.md\":\"3fdc55ce\",\"articles_java_02html_css_js_xml_index.md\":\"6fe464d5\",\"articles_java_01java语法_02java8实战.md\":\"bf8ec5a4\",\"articles_windows_15miniconda_pycharm_cuda.md\":\"8e0c918d\",\"articles_blog_huggingface教程_01入门.md\":\"925b8b7c\",\"articles_blog_huggingface教程_01指令.md\":\"601c1b38\",\"articles_blog_huggingface教程_index.md\":\"2cb1e96c\",\"articles_blog_vitepress_02新环境如何配置.md\":\"8aa4e94a\",\"articles_blog_vitepress_03支持latex公式.md\":\"e9ff3336\",\"articles_blog_vitepress_04自定义首页_模板.md\":\"620247fa\",\"articles_blog_vitepress_05文档、项目分离.md\":\"51a88f8b\",\"articles_blog_vitepress_index.md\":\"d9849be8\",\"articles_windows_01常用软件.md\":\"23f9e458\",\"articles_windows_02latex与文献检索.md\":\"246cda4c\",\"articles_windows_10idea.md\":\"4f78b4da\",\"articles_windows_13tvbox.md\":\"ef3859e8\",\"articles_windows_14typora.md\":\"8644ffe3\",\"articles_windows_16欧拉系统安装gpu驱动.md\":\"2358753b\",\"articles_windows_index.md\":\"5b04b411\",\"articles_全栈_docker_index.md\":\"225eca89\",\"articles_全栈_git_00git教程.md\":\"571978db\",\"articles_全栈_git_index.md\":\"80254cf2\",\"articles_全栈_linux_01linux教程.md\":\"9623a07a\",\"articles_java_51springboot_01freemarker模板.md\":\"7b6f3a54\",\"articles_全栈_linux_02shell脚本.md\":\"e40ade31\",\"articles_全栈_linux_02shell脚本之服务启停脚本.md\":\"283963f6\",\"articles_全栈_linux_linux开发环境准备.md\":\"06a697cc\",\"articles_全栈_nginx_01nginx.md\":\"b7862d51\",\"articles_全栈_nginx_index.md\":\"f0fc9644\",\"articles_全栈_k8s_untitled.md\":\"2ee32ab8\",\"articles_全栈_k8s_index.md\":\"deba0e37\",\"articles_blog_vitepress_01vitepress_github搭建个人博客.md\":\"915a7d04\",\"articles_java_03javaweb基础tomcat servlet jsp_index.md\":\"93581fbd\",\"articles_全栈_k8s_k8s安装文档.md\":\"fe488f5b\",\"articles_全栈_k8s_k8s教程.md\":\"810e7d1f\",\"articles_算法_01python语法_工具_01python3语法.md\":\"2f6d9cf6\",\"articles_算法_01python语法_工具_03python常用库.md\":\"bb45a863\",\"articles_算法_01python语法_工具_10docx.md\":\"bfacfb5c\",\"articles_算法_01python语法_工具_index.md\":\"0cf850fe\",\"articles_java_65redis_01redis基础.md\":\"5ec8d9fa\",\"articles_算法_10白板推导系列_05降维.md\":\"c324d70c\",\"articles_java_05maven_index.md\":\"237fc99d\",\"articles_全栈_docker_docker教程.md\":\"60af2423\",\"articles_java_51springboot_07任务 之 异步 定时 邮件.md\":\"ccc097e9\",\"articles_java_52springcloud_index.md\":\"1bf6a5fa\",\"articles_算法_01python语法_工具_02np.array()和np.mat()区别.md\":\"19b51188\",\"articles_算法_10白板推导系列_01介绍.md\":\"194770b6\",\"articles_全栈_linux_03重要命令.md\":\"1e182741\",\"articles_全栈_linux_04linux性能监控.md\":\"e43f64c3\",\"articles_全栈_linux_index.md\":\"ad36c70f\",\"articles_java_51springboot_11日志.md\":\"2e58ef86\",\"articles_java_20mysql_index.md\":\"e11f072d\",\"articles_java_51springboot_00springboot.md\":\"7c09c63f\",\"articles_java_51springboot_02i18n国际化.md\":\"7c6cad01\",\"articles_算法_10白板推导系列_03线性回归.md\":\"3a7bf04d\",\"articles_算法_10白板推导系列_06支持向量机.md\":\"9e3f792d\",\"articles_算法_10白板推导系列_07指数族分布.md\":\"69e36049\",\"articles_java_61elasticsearch_index.md\":\"8a66f80d\",\"articles_算法_12llm_23llama.md\":\"e99c12d2\",\"articles_算法_11强化学习_01强化学习环境.md\":\"8d9559ad\",\"articles_算法_11强化学习_01深度强化学习-李宏毅.md\":\"7d0bceb9\",\"articles_算法_11强化学习_index.md\":\"59571df1\",\"articles_算法_12llm_00ai前期发展2016.md\":\"744de177\",\"articles_算法_12llm_00llm发展2017-2013.md\":\"69996d45\",\"articles_算法_12llm_00多模态.md\":\"f455cb96\",\"articles_算法_12llm_00综述.md\":\"50ae2f23\",\"articles_算法_12llm_01prtnet.md\":\"e8c7386b\",\"articles_算法_12llm_01seq2seq和attention.md\":\"ae2a2b76\",\"articles_算法_12llm_02word2vec.md\":\"c6609bdb\",\"articles_算法_12llm_03transformerxl.md\":\"c627ec0f\",\"articles_算法_12llm_03transformer详解.md\":\"df898996\",\"articles_算法_12llm_04bert1进化史.md\":\"dab98114\",\"articles_算法_12llm_04bert2详解.md\":\"0e52116f\",\"articles_算法_12llm_04学习分词技术subword.md\":\"b074a107\",\"articles_算法_12llm_05gpt01论文.md\":\"3b1a41c9\",\"articles_算法_12llm_05gpt02模型.md\":\"54724ebd\",\"articles_算法_12llm_06mtdnn.md\":\"b9f348cb\",\"articles_算法_12llm_06xlnet.md\":\"fa241dca\",\"articles_算法_12llm_09electra.md\":\"b01e156e\",\"articles_算法_12llm_10t5.md\":\"7d623246\",\"articles_算法_12llm_11t5.md\":\"1dfd7ab7\",\"articles_算法_12llm_11学习attention mask.md\":\"f61fa9e5\",\"articles_算法_12llm_12gpt3.md\":\"32e52599\",\"articles_算法_12llm_13flan.md\":\"27bb5b39\",\"articles_算法_12llm_15lamda.md\":\"f894f5a1\",\"articles_算法_12llm_16instructgpt.md\":\"29617c9c\",\"articles_算法_12llm_16opt.md\":\"f12a10f3\",\"articles_算法_12llm_17gpt-neox-20b.md\":\"2ab47805\",\"articles_算法_12llm_18ul2.md\":\"55f4e0eb\",\"articles_算法_12llm_19palm.md\":\"47b4df9e\",\"articles_算法_12llm_21flan-palm.md\":\"b69e3357\",\"articles_算法_12llm_21flan-t5.md\":\"b58df82b\",\"articles_算法_12llm_22bloom.md\":\"b48eac25\",\"articles_算法_12llm_22chatgpt.md\":\"e36cf60c\",\"articles_算法_12llm_22opt-iml.md\":\"f63e6b5f\",\"articles_算法_12llm_22mt0.md\":\"450995e4\",\"articles_算法_12llm_23gpt4.md\":\"ab85d034\",\"articles_算法_12llm_14t0.md\":\"9df014dc\",\"articles_算法_10白板推导系列_index.md\":\"8d085756\",\"articles_算法_10白板推导系列_08概率图模型.md\":\"522f299a\",\"articles_算法_12llm_07roberta.md\":\"f2051ee0\",\"articles_算法_10白板推导系列_04线性分类.md\":\"f02a3630\",\"articles_算法_12llm_08albert.md\":\"63332290\",\"articles_算法_10白板推导系列_14lds线性动态系统.md\":\"b5c29e28\",\"articles_算法_10白板推导系列_24approinference.md\":\"c3a24271\",\"articles_算法_10白板推导系列_12mcmc.md\":\"a56c1e8d\",\"articles_java_30设计模式_index.md\":\"27469773\",\"articles_java_31java并发编程_index.md\":\"3af9b864\",\"articles_算法_10白板推导系列_02高斯分布.md\":\"d115c084\",\"articles_算法_10白板推导系列_22nn.md\":\"4056037d\",\"articles_算法_10白板推导系列_11vi变分推断.md\":\"aca201ca\",\"articles_算法_10白板推导系列_09em.md\":\"180b9e3c\",\"articles_算法_12llm_25stanford alpaca.md\":\"dab0fe0a\",\"articles_算法_12llm_25vicuna.md\":\"d516ef4f\",\"articles_算法_12llm_26llama2.md\":\"9aed2258\",\"articles_算法_12llm_26llama2中的技术.md\":\"476889c9\",\"articles_算法_12llm_27interlm.md\":\"6ef64842\",\"articles_算法_12llm_28tigerbot.md\":\"8e97c56c\",\"articles_算法_12llm_39qwen.md\":\"1dad3f72\",\"articles_算法_12llm_41mbart.md\":\"a3c37c15\",\"articles_算法_10白板推导系列_15particlefilter粒子滤波.md\":\"bee4e43c\",\"articles_算法_12llm_43madlad-400.md\":\"c7389563\",\"articles_算法_12llm_index.md\":\"db06149d\",\"articles_算法_12机器学习笔记_00算法性能度量.md\":\"d5583567\",\"articles_算法_12机器学习笔记_01概述.md\":\"d305dc11\",\"articles_算法_12机器学习笔记_02梯度消失.md\":\"78fd6743\",\"articles_算法_12机器学习笔记_03逻辑回归.md\":\"e28e084e\",\"articles_算法_12机器学习笔记_04gbdt.md\":\"a571a326\",\"articles_算法_12机器学习笔记_10调参指南.md\":\"2b2a6946\",\"articles_算法_12机器学习笔记_11过拟合问题.md\":\"74c8186e\",\"articles_算法_12机器学习笔记_12bagging和随机森林.md\":\"cd040a9b\",\"articles_算法_12机器学习笔记_13adaboost.md\":\"d6fca3cf\",\"articles_算法_12机器学习笔记_14lightgbm.md\":\"d33c497d\",\"articles_算法_10白板推导系列_19高斯过程回归.md\":\"8370a362\",\"articles_算法_10白板推导系列_17高斯网络.md\":\"dba0daa5\",\"articles_算法_10白板推导系列_18贝叶斯线性回归.md\":\"d9467684\",\"articles_算法_12机器学习笔记_15xgboost.md\":\"5ec136b3\",\"articles_算法_12机器学习笔记_16lightgbm.md\":\"51e6430d\",\"articles_算法_12机器学习笔记_17catboost.md\":\"a4a5465c\",\"articles_算法_12机器学习笔记_index.md\":\"c96fa5a3\",\"articles_算法_21模型部署_00调研模型工业化部署.md\":\"3514e447\",\"articles_算法_21模型部署_02fastapi.md\":\"013ecf52\",\"articles_算法_21模型部署_02gradio.md\":\"e6ae947b\",\"articles_算法_21模型部署_03fasttransformer.md\":\"52161040\",\"articles_算法_21模型部署_index.md\":\"0630345b\",\"articles_算法_22模型训练和微调_00项目学习.md\":\"ab519863\",\"articles_算法_22模型训练和微调_01并行训练.md\":\"b780b325\",\"articles_算法_22模型训练和微调_02模型微调.md\":\"35bfd7d8\",\"articles_算法_22模型训练和微调_03chatglm微调学习.md\":\"47ce7bc7\",\"articles_算法_22模型训练和微调_04deepseepd rlhf.md\":\"21a5c86d\",\"articles_算法_22模型训练和微调_10各种包如何用.md\":\"3ac13d4f\",\"articles_算法_22模型训练和微调_index.md\":\"96d0bc99\",\"articles_算法_23langchain_00基于大语言模型知识问答应用落地实践.md\":\"5e7b2b34\",\"articles_算法_23langchain_01langchain入门.md\":\"b32ffe64\",\"articles_算法_23langchain_02工具总结.md\":\"7e8a3a36\",\"articles_算法_23langchain_03langchain检索.md\":\"87e941c9\",\"articles_算法_23langchain_index.md\":\"a8360c52\",\"index.md\":\"f2c84239\",\"articles_算法_12llm_42nllb-200.md\":\"75501633\",\"articles_算法_10白板推导系列_20rbm.md\":\"10a470ca\",\"articles_算法_12机器学习笔记_05adam.md\":\"61a6ff95\",\"articles_算法_10白板推导系列_21spectral谱聚类.md\":\"7d853696\",\"articles_算法_10白板推导系列_10gmm.md\":\"49ea0d4f\",\"articles_算法_12机器学习笔记_14adboost.md\":\"eac474d8\",\"articles_算法_10白板推导系列_23partitionfunction.md\":\"a082f893\",\"articles_算法_10白板推导系列_16crf.md\":\"b633016e\",\"articles_算法_10白板推导系列_13hmm.md\":\"9d5902c1\",\"articles_算法_10白板推导系列_总结.md\":\"d72070ea\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"明日盈盈\",\"titleTemplate\":\"Make each day count, Make learning a habit.\",\"description\":\"一只程序猿\",\"base\":\"/\",\"head\":[],\"appearance\":true,\"themeConfig\":{\"siteTitle\":\"Home\",\"nav\":[{\"text\":\"Java\",\"items\":[{\"text\":\"01Java语法\",\"link\":\"/articles/Java/01Java语法/\"},{\"text\":\"02HTML+CSS+JS+XML\",\"link\":\"/articles/Java/02HTML+CSS+JS+XML/\"},{\"text\":\"03JavaWeb基础tomcat servlet jsp\",\"link\":\"/articles/Java/03JavaWeb基础tomcat servlet jsp/\"},{\"text\":\"05Maven\",\"link\":\"/articles/Java/05Maven/\"},{\"text\":\"20mysql\",\"link\":\"/articles/Java/20mysql/\"},{\"text\":\"22JanusGraph\",\"link\":\"/articles/Java/22JanusGraph/\"},{\"text\":\"30设计模式\",\"link\":\"/articles/Java/30设计模式/\"},{\"text\":\"31Java并发编程\",\"link\":\"/articles/Java/31Java并发编程/\"},{\"text\":\"51SpringBoot\",\"link\":\"/articles/Java/51SpringBoot/\"},{\"text\":\"52SpringCloud\",\"link\":\"/articles/Java/52SpringCloud/\"},{\"text\":\"53Arthus\",\"link\":\"/articles/Java/53Arthus/\"},{\"text\":\"60kafka\",\"link\":\"/articles/Java/60kafka/\"},{\"text\":\"61ElasticSearch\",\"link\":\"/articles/Java/61ElasticSearch/\"},{\"text\":\"65redis\",\"link\":\"/articles/Java/65redis/\"},{\"text\":\"65vue\",\"link\":\"/articles/Java/65vue/\"},{\"text\":\"66jenkins\",\"link\":\"/articles/Java/66jenkins/\"}]},{\"text\":\"blog\",\"items\":[{\"text\":\"Huggingface教程\",\"link\":\"/articles/blog/Huggingface教程/\"},{\"text\":\"vitepress\",\"link\":\"/articles/blog/vitepress/\"}]},{\"text\":\"windows\",\"link\":\"/articles/windows/\"},{\"text\":\"全栈\",\"items\":[{\"text\":\"Docker\",\"link\":\"/articles/全栈/Docker/\"},{\"text\":\"Git\",\"link\":\"/articles/全栈/Git/\"},{\"text\":\"Linux\",\"link\":\"/articles/全栈/Linux/\"},{\"text\":\"Nginx\",\"link\":\"/articles/全栈/Nginx/\"},{\"text\":\"k8s\",\"link\":\"/articles/全栈/k8s/\"}]},{\"text\":\"算法\",\"items\":[{\"text\":\"01python语法&工具\",\"link\":\"/articles/算法/01python语法&工具/\"},{\"text\":\"10白板推导系列\",\"link\":\"/articles/算法/10白板推导系列/\"},{\"text\":\"11强化学习\",\"link\":\"/articles/算法/11强化学习/\"},{\"text\":\"12LLM\",\"link\":\"/articles/算法/12LLM/\"},{\"text\":\"12机器学习笔记\",\"link\":\"/articles/算法/12机器学习笔记/\"},{\"text\":\"21模型部署\",\"link\":\"/articles/算法/21模型部署/\"},{\"text\":\"22模型训练和微调\",\"link\":\"/articles/算法/22模型训练和微调/\"},{\"text\":\"23LangChain\",\"link\":\"/articles/算法/23LangChain/\"}]},{\"text\":\"About\",\"link\":\"/about/\"}],\"sidebar\":{\"/articles/Java/01Java语法\":[{\"text\":\"01Java语法\",\"items\":[{\"text\":\"02Java8实战\",\"link\":\"/articles/Java/01Java语法/02Java8实战.md\"},{\"text\":\"10Java读大数据量csv\",\"link\":\"/articles/Java/01Java语法/10Java读大数据量csv.md\"},{\"text\":\"10Java读大数据量excel\",\"link\":\"/articles/Java/01Java语法/10Java读大数据量excel.md\"},{\"text\":\"10Web前后端大文件上传和接收\",\"link\":\"/articles/Java/01Java语法/10Web前后端大文件上传和接收.md\"},{\"text\":\"11Java线程池的使用\",\"link\":\"/articles/Java/01Java语法/11Java线程池的使用.md\"},{\"text\":\"12Java正则化\",\"link\":\"/articles/Java/01Java语法/12Java正则化.md\"}]}],\"/articles/Java/51SpringBoot\":[{\"text\":\"51SpringBoot\",\"items\":[{\"text\":\"00SpringBoot\",\"link\":\"/articles/Java/51SpringBoot/00SpringBoot.md\"},{\"text\":\"01Freemarker模板\",\"link\":\"/articles/Java/51SpringBoot/01Freemarker模板.md\"},{\"text\":\"02i18n国际化\",\"link\":\"/articles/Java/51SpringBoot/02i18n国际化.md\"},{\"text\":\"03日志SLF4J\",\"link\":\"/articles/Java/51SpringBoot/03日志SLF4J.md\"},{\"text\":\"04缓存Redis\",\"link\":\"/articles/Java/51SpringBoot/04缓存Redis.md\"},{\"text\":\"05安全Shiro\",\"link\":\"/articles/Java/51SpringBoot/05安全Shiro.md\"},{\"text\":\"05安全SpringSecurity\",\"link\":\"/articles/Java/51SpringBoot/05安全SpringSecurity.md\"},{\"text\":\"06分页PageHelper\",\"link\":\"/articles/Java/51SpringBoot/06分页PageHelper.md\"},{\"text\":\"07任务 之 异步 定时 邮件\",\"link\":\"/articles/Java/51SpringBoot/07任务 之 异步 定时 邮件.md\"},{\"text\":\"10读文件\",\"link\":\"/articles/Java/51SpringBoot/10读文件.md\"},{\"text\":\"11日志\",\"link\":\"/articles/Java/51SpringBoot/11日志.md\"}]}],\"/articles/Java/65redis\":[{\"text\":\"65redis\",\"items\":[{\"text\":\"01redis基础\",\"link\":\"/articles/Java/65redis/01redis基础.md\"},{\"text\":\"02redis集群搭建\",\"link\":\"/articles/Java/65redis/02redis集群搭建.md\"}]}],\"/articles/Java/65vue\":[{\"text\":\"65vue\",\"items\":[{\"text\":\"01vue3+ts语法\",\"link\":\"/articles/Java/65vue/01vue3+ts语法.md\"},{\"text\":\"02vue3实战\",\"link\":\"/articles/Java/65vue/02vue3实战.md\"}]}],\"/articles/blog/Huggingface教程\":[{\"text\":\"Huggingface教程\",\"items\":[{\"text\":\"01入门\",\"link\":\"/articles/blog/Huggingface教程/01入门.md\"},{\"text\":\"01指令\",\"link\":\"/articles/blog/Huggingface教程/01指令.md\"}]}],\"/articles/blog/vitepress\":[{\"text\":\"vitepress\",\"items\":[{\"text\":\"01VitePress+Github搭建个人博客\",\"link\":\"/articles/blog/vitepress/01VitePress+Github搭建个人博客.md\"},{\"text\":\"02新环境如何配置\",\"link\":\"/articles/blog/vitepress/02新环境如何配置.md\"},{\"text\":\"03支持Latex公式\",\"link\":\"/articles/blog/vitepress/03支持Latex公式.md\"},{\"text\":\"04自定义首页&模板\",\"link\":\"/articles/blog/vitepress/04自定义首页&模板.md\"},{\"text\":\"05文档、项目分离\",\"link\":\"/articles/blog/vitepress/05文档、项目分离.md\"}]}],\"/articles/windows\":[{\"text\":\"windows\",\"items\":[{\"text\":\"01常用软件\",\"link\":\"/articles/windows/01常用软件.md\"},{\"text\":\"02Latex与文献检索\",\"link\":\"/articles/windows/02Latex与文献检索.md\"},{\"text\":\"10IDEA\",\"link\":\"/articles/windows/10IDEA.md\"},{\"text\":\"13tvbox\",\"link\":\"/articles/windows/13tvbox.md\"},{\"text\":\"14Typora\",\"link\":\"/articles/windows/14Typora.md\"},{\"text\":\"15miniconda+pycharm+CUDA\",\"link\":\"/articles/windows/15miniconda+pycharm+CUDA.md\"},{\"text\":\"16欧拉系统安装GPU驱动\",\"link\":\"/articles/windows/16欧拉系统安装GPU驱动.md\"}]}],\"/articles/全栈/Docker\":[{\"text\":\"Docker\",\"items\":[{\"text\":\"Docker教程\",\"link\":\"/articles/全栈/Docker/Docker教程.md\"}]}],\"/articles/全栈/Git\":[{\"text\":\"Git\",\"items\":[{\"text\":\"00git教程\",\"link\":\"/articles/全栈/Git/00git教程.md\"}]}],\"/articles/全栈/Linux\":[{\"text\":\"Linux\",\"items\":[{\"text\":\"01linux教程\",\"link\":\"/articles/全栈/Linux/01linux教程.md\"},{\"text\":\"02Shell脚本\",\"link\":\"/articles/全栈/Linux/02Shell脚本.md\"},{\"text\":\"02Shell脚本之服务启停脚本\",\"link\":\"/articles/全栈/Linux/02Shell脚本之服务启停脚本.md\"},{\"text\":\"03重要命令\",\"link\":\"/articles/全栈/Linux/03重要命令.md\"},{\"text\":\"04Linux性能监控\",\"link\":\"/articles/全栈/Linux/04Linux性能监控.md\"},{\"text\":\"linux开发环境准备\",\"link\":\"/articles/全栈/Linux/linux开发环境准备.md\"}]}],\"/articles/全栈/Nginx\":[{\"text\":\"Nginx\",\"items\":[{\"text\":\"01Nginx\",\"link\":\"/articles/全栈/Nginx/01Nginx.md\"}]}],\"/articles/全栈/k8s\":[{\"text\":\"k8s\",\"items\":[{\"text\":\"Untitled\",\"link\":\"/articles/全栈/k8s/Untitled.md\"},{\"text\":\"k8s安装文档\",\"link\":\"/articles/全栈/k8s/k8s安装文档.md\"},{\"text\":\"k8s教程\",\"link\":\"/articles/全栈/k8s/k8s教程.md\"}]}],\"/articles/算法/01python语法&工具\":[{\"text\":\"01python语法&工具\",\"items\":[{\"text\":\"01python3语法\",\"link\":\"/articles/算法/01python语法&工具/01python3语法.md\"},{\"text\":\"02np.array()和np.mat()区别\",\"link\":\"/articles/算法/01python语法&工具/02np.array()和np.mat()区别.md\"},{\"text\":\"03python常用库\",\"link\":\"/articles/算法/01python语法&工具/03python常用库.md\"},{\"text\":\"10docx\",\"link\":\"/articles/算法/01python语法&工具/10docx.md\"}]}],\"/articles/算法/10白板推导系列\":[{\"text\":\"10白板推导系列\",\"items\":[{\"text\":\"01介绍\",\"link\":\"/articles/算法/10白板推导系列/01介绍.md\"},{\"text\":\"02高斯分布\",\"link\":\"/articles/算法/10白板推导系列/02高斯分布.md\"},{\"text\":\"03线性回归\",\"link\":\"/articles/算法/10白板推导系列/03线性回归.md\"},{\"text\":\"04线性分类\",\"link\":\"/articles/算法/10白板推导系列/04线性分类.md\"},{\"text\":\"05降维\",\"link\":\"/articles/算法/10白板推导系列/05降维.md\"},{\"text\":\"06支持向量机\",\"link\":\"/articles/算法/10白板推导系列/06支持向量机.md\"},{\"text\":\"07指数族分布\",\"link\":\"/articles/算法/10白板推导系列/07指数族分布.md\"},{\"text\":\"08概率图模型\",\"link\":\"/articles/算法/10白板推导系列/08概率图模型.md\"},{\"text\":\"09EM\",\"link\":\"/articles/算法/10白板推导系列/09EM.md\"},{\"text\":\"10GMM\",\"link\":\"/articles/算法/10白板推导系列/10GMM.md\"},{\"text\":\"11VI变分推断\",\"link\":\"/articles/算法/10白板推导系列/11VI变分推断.md\"},{\"text\":\"12MCMC\",\"link\":\"/articles/算法/10白板推导系列/12MCMC.md\"},{\"text\":\"13HMM\",\"link\":\"/articles/算法/10白板推导系列/13HMM.md\"},{\"text\":\"14LDS线性动态系统\",\"link\":\"/articles/算法/10白板推导系列/14LDS线性动态系统.md\"},{\"text\":\"15particleFilter粒子滤波\",\"link\":\"/articles/算法/10白板推导系列/15particleFilter粒子滤波.md\"},{\"text\":\"16CRF\",\"link\":\"/articles/算法/10白板推导系列/16CRF.md\"},{\"text\":\"17高斯网络\",\"link\":\"/articles/算法/10白板推导系列/17高斯网络.md\"},{\"text\":\"18贝叶斯线性回归\",\"link\":\"/articles/算法/10白板推导系列/18贝叶斯线性回归.md\"},{\"text\":\"19高斯过程回归\",\"link\":\"/articles/算法/10白板推导系列/19高斯过程回归.md\"},{\"text\":\"20RBM\",\"link\":\"/articles/算法/10白板推导系列/20RBM.md\"},{\"text\":\"21Spectral谱聚类\",\"link\":\"/articles/算法/10白板推导系列/21Spectral谱聚类.md\"},{\"text\":\"22NN\",\"link\":\"/articles/算法/10白板推导系列/22NN.md\"},{\"text\":\"23PartitionFunction\",\"link\":\"/articles/算法/10白板推导系列/23PartitionFunction.md\"},{\"text\":\"24ApproInference\",\"link\":\"/articles/算法/10白板推导系列/24ApproInference.md\"},{\"text\":\"总结\",\"link\":\"/articles/算法/10白板推导系列/总结.md\"}]}],\"/articles/算法/11强化学习\":[{\"text\":\"11强化学习\",\"items\":[{\"text\":\"01强化学习环境\",\"link\":\"/articles/算法/11强化学习/01强化学习环境.md\"},{\"text\":\"01深度强化学习-李宏毅\",\"link\":\"/articles/算法/11强化学习/01深度强化学习-李宏毅.md\"}]}],\"/articles/算法/12LLM\":[{\"text\":\"12LLM\",\"items\":[{\"text\":\"00AI前期发展2016\",\"link\":\"/articles/算法/12LLM/00AI前期发展2016.md\"},{\"text\":\"00LLM发展2017-2013\",\"link\":\"/articles/算法/12LLM/00LLM发展2017-2013.md\"},{\"text\":\"00多模态\",\"link\":\"/articles/算法/12LLM/00多模态.md\"},{\"text\":\"00综述\",\"link\":\"/articles/算法/12LLM/00综述.md\"},{\"text\":\"01PrtNet\",\"link\":\"/articles/算法/12LLM/01PrtNet.md\"},{\"text\":\"01seq2seq和Attention\",\"link\":\"/articles/算法/12LLM/01seq2seq和Attention.md\"},{\"text\":\"02word2Vec\",\"link\":\"/articles/算法/12LLM/02word2Vec.md\"},{\"text\":\"03TransformerXL\",\"link\":\"/articles/算法/12LLM/03TransformerXL.md\"},{\"text\":\"03Transformer详解\",\"link\":\"/articles/算法/12LLM/03Transformer详解.md\"},{\"text\":\"04bert1进化史\",\"link\":\"/articles/算法/12LLM/04bert1进化史.md\"},{\"text\":\"04bert2详解\",\"link\":\"/articles/算法/12LLM/04bert2详解.md\"},{\"text\":\"04学习分词技术Subword\",\"link\":\"/articles/算法/12LLM/04学习分词技术Subword.md\"},{\"text\":\"05GPT01论文\",\"link\":\"/articles/算法/12LLM/05GPT01论文.md\"},{\"text\":\"05GPT02模型\",\"link\":\"/articles/算法/12LLM/05GPT02模型.md\"},{\"text\":\"06MTDNN\",\"link\":\"/articles/算法/12LLM/06MTDNN.md\"},{\"text\":\"06XLNet\",\"link\":\"/articles/算法/12LLM/06XLNet.md\"},{\"text\":\"07RoBERTa\",\"link\":\"/articles/算法/12LLM/07RoBERTa.md\"},{\"text\":\"08ALBERT\",\"link\":\"/articles/算法/12LLM/08ALBERT.md\"},{\"text\":\"09ELECTRA\",\"link\":\"/articles/算法/12LLM/09ELECTRA.md\"},{\"text\":\"10T5\",\"link\":\"/articles/算法/12LLM/10T5.md\"},{\"text\":\"11T5\",\"link\":\"/articles/算法/12LLM/11T5.md\"},{\"text\":\"11学习attention mask\",\"link\":\"/articles/算法/12LLM/11学习attention mask.md\"},{\"text\":\"12GPT3\",\"link\":\"/articles/算法/12LLM/12GPT3.md\"},{\"text\":\"13FLAN\",\"link\":\"/articles/算法/12LLM/13FLAN.md\"},{\"text\":\"14T0\",\"link\":\"/articles/算法/12LLM/14T0.md\"},{\"text\":\"15LaMDA\",\"link\":\"/articles/算法/12LLM/15LaMDA.md\"},{\"text\":\"16InstructGPT\",\"link\":\"/articles/算法/12LLM/16InstructGPT.md\"},{\"text\":\"16OPT\",\"link\":\"/articles/算法/12LLM/16OPT.md\"},{\"text\":\"17GPT-NeoX-20B\",\"link\":\"/articles/算法/12LLM/17GPT-NeoX-20B.md\"},{\"text\":\"18UL2\",\"link\":\"/articles/算法/12LLM/18UL2.md\"},{\"text\":\"19PaLM\",\"link\":\"/articles/算法/12LLM/19PaLM.md\"},{\"text\":\"21Flan-PaLM\",\"link\":\"/articles/算法/12LLM/21Flan-PaLM.md\"},{\"text\":\"21Flan-T5\",\"link\":\"/articles/算法/12LLM/21Flan-T5.md\"},{\"text\":\"22BLOOM\",\"link\":\"/articles/算法/12LLM/22BLOOM.md\"},{\"text\":\"22ChatGPT\",\"link\":\"/articles/算法/12LLM/22ChatGPT.md\"},{\"text\":\"22OPT-IML\",\"link\":\"/articles/算法/12LLM/22OPT-IML.md\"},{\"text\":\"22mT0\",\"link\":\"/articles/算法/12LLM/22mT0.md\"},{\"text\":\"23GPT4\",\"link\":\"/articles/算法/12LLM/23GPT4.md\"},{\"text\":\"23LLaMA\",\"link\":\"/articles/算法/12LLM/23LLaMA.md\"},{\"text\":\"25Stanford Alpaca\",\"link\":\"/articles/算法/12LLM/25Stanford Alpaca.md\"},{\"text\":\"25Vicuna\",\"link\":\"/articles/算法/12LLM/25Vicuna.md\"},{\"text\":\"26LLaMA2\",\"link\":\"/articles/算法/12LLM/26LLaMA2.md\"},{\"text\":\"26LLaMA2中的技术\",\"link\":\"/articles/算法/12LLM/26LLaMA2中的技术.md\"},{\"text\":\"27InterLM\",\"link\":\"/articles/算法/12LLM/27InterLM.md\"},{\"text\":\"28Tigerbot\",\"link\":\"/articles/算法/12LLM/28Tigerbot.md\"},{\"text\":\"39Qwen\",\"link\":\"/articles/算法/12LLM/39Qwen.md\"},{\"text\":\"41mBART\",\"link\":\"/articles/算法/12LLM/41mBART.md\"},{\"text\":\"42NLLB-200\",\"link\":\"/articles/算法/12LLM/42NLLB-200.md\"},{\"text\":\"43MADLAD-400\",\"link\":\"/articles/算法/12LLM/43MADLAD-400.md\"}]}],\"/articles/算法/12机器学习笔记\":[{\"text\":\"12机器学习笔记\",\"items\":[{\"text\":\"00算法性能度量\",\"link\":\"/articles/算法/12机器学习笔记/00算法性能度量.md\"},{\"text\":\"01概述\",\"link\":\"/articles/算法/12机器学习笔记/01概述.md\"},{\"text\":\"02梯度消失\",\"link\":\"/articles/算法/12机器学习笔记/02梯度消失.md\"},{\"text\":\"03逻辑回归\",\"link\":\"/articles/算法/12机器学习笔记/03逻辑回归.md\"},{\"text\":\"04GBDT\",\"link\":\"/articles/算法/12机器学习笔记/04GBDT.md\"},{\"text\":\"05Adam\",\"link\":\"/articles/算法/12机器学习笔记/05Adam.md\"},{\"text\":\"10调参指南\",\"link\":\"/articles/算法/12机器学习笔记/10调参指南.md\"},{\"text\":\"11过拟合问题\",\"link\":\"/articles/算法/12机器学习笔记/11过拟合问题.md\"},{\"text\":\"12bagging和随机森林\",\"link\":\"/articles/算法/12机器学习笔记/12bagging和随机森林.md\"},{\"text\":\"13Adaboost\",\"link\":\"/articles/算法/12机器学习笔记/13Adaboost.md\"},{\"text\":\"14Adboost\",\"link\":\"/articles/算法/12机器学习笔记/14Adboost.md\"},{\"text\":\"14LightGBM\",\"link\":\"/articles/算法/12机器学习笔记/14LightGBM.md\"},{\"text\":\"15XGBoost\",\"link\":\"/articles/算法/12机器学习笔记/15XGBoost.md\"},{\"text\":\"16Lightgbm\",\"link\":\"/articles/算法/12机器学习笔记/16Lightgbm.md\"},{\"text\":\"17catboost\",\"link\":\"/articles/算法/12机器学习笔记/17catboost.md\"}]}],\"/articles/算法/21模型部署\":[{\"text\":\"21模型部署\",\"items\":[{\"text\":\"00调研模型工业化部署\",\"link\":\"/articles/算法/21模型部署/00调研模型工业化部署.md\"},{\"text\":\"02FastApi\",\"link\":\"/articles/算法/21模型部署/02FastApi.md\"},{\"text\":\"02Gradio\",\"link\":\"/articles/算法/21模型部署/02Gradio.md\"},{\"text\":\"03FastTransformer\",\"link\":\"/articles/算法/21模型部署/03FastTransformer.md\"}]}],\"/articles/算法/22模型训练和微调\":[{\"text\":\"22模型训练和微调\",\"items\":[{\"text\":\"00项目学习\",\"link\":\"/articles/算法/22模型训练和微调/00项目学习.md\"},{\"text\":\"01并行训练\",\"link\":\"/articles/算法/22模型训练和微调/01并行训练.md\"},{\"text\":\"02模型微调\",\"link\":\"/articles/算法/22模型训练和微调/02模型微调.md\"},{\"text\":\"03ChatGLM微调学习\",\"link\":\"/articles/算法/22模型训练和微调/03ChatGLM微调学习.md\"},{\"text\":\"04DeepSeepd RLHF\",\"link\":\"/articles/算法/22模型训练和微调/04DeepSeepd RLHF.md\"},{\"text\":\"10各种包如何用\",\"link\":\"/articles/算法/22模型训练和微调/10各种包如何用.md\"}]}],\"/articles/算法/23LangChain\":[{\"text\":\"23LangChain\",\"items\":[{\"text\":\"00基于大语言模型知识问答应用落地实践\",\"link\":\"/articles/算法/23LangChain/00基于大语言模型知识问答应用落地实践.md\"},{\"text\":\"01LangChain入门\",\"link\":\"/articles/算法/23LangChain/01LangChain入门.md\"},{\"text\":\"02工具总结\",\"link\":\"/articles/算法/23LangChain/02工具总结.md\"},{\"text\":\"03LangChain检索\",\"link\":\"/articles/算法/23LangChain/03LangChain检索.md\"}]}]},\"outline\":{\"level\":[1,3]},\"editLink\":{\"pattern\":\"https://github.com/mingriyingying/mingriyingying.github.io/blob/master/docs/:path\",\"text\":\"Edit this page on GitHub\"},\"lastUpdated\":{\"text\":\"Updated at\",\"formatOptions\":{\"dateStyle\":\"short\",\"timeStyle\":\"medium\"}},\"docFooter\":{\"prev\":false,\"next\":false}},\"locales\":{},\"scrollOffset\":90,\"cleanUrls\":false}");</script>
    
  </body>
</html>