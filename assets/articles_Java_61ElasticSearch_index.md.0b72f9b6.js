import{_ as s,o as n,c as a,Q as l}from"./chunks/framework.2516552c.js";const p="/assets/image-20210728210700633-1627477626830.7a91f01b.png",g=JSON.parse('{"title":"第一章 ES简介","description":"","frontmatter":{},"headers":[],"relativePath":"articles/Java/61ElasticSearch/index.md","filePath":"articles/Java/61ElasticSearch/index.md","lastUpdated":1698149129000}'),o={name:"articles/Java/61ElasticSearch/index.md"},e=l(`<h1 id="第一章-es简介" tabindex="-1">第一章 ES简介 <a class="header-anchor" href="#第一章-es简介" aria-label="Permalink to &quot;第一章 ES简介&quot;">​</a></h1><h2 id="_1-1-什么是elasticsearch" tabindex="-1">1.1 什么是ElasticSearch <a class="header-anchor" href="#_1-1-什么是elasticsearch" aria-label="Permalink to &quot;1.1 什么是ElasticSearch&quot;">​</a></h2><p>Elaticsearch，简称为es， es是一个开源的高扩展的分布式全文检索引擎，它可以近乎实时的存储、检索数据；本身扩展性很好，可以扩展到上百台服务器，处理PB级别的数据。es也使用Java开发并使用Lucene作为其核心来实现所有索引和搜索的功能，但是它的目的是通过简单的RESTful API来隐藏Lucene的复杂性，从而让全文搜索变得简单。</p><h2 id="_1-2-es的使用案例" tabindex="-1">1.2 ES的使用案例 <a class="header-anchor" href="#_1-2-es的使用案例" aria-label="Permalink to &quot;1.2 ES的使用案例&quot;">​</a></h2><ul><li>2013年初，GitHub抛弃了Solr，采取ElasticSearch 来做PB级的搜索。 “GitHub使用ElasticSearch搜索20TB的数据，包括13亿文件和1300亿行代码”</li><li>维基百科：启动以elasticsearch为基础的核心搜索架构</li><li>SoundCloud：“SoundCloud使用ElasticSearch为1.8亿用户提供即时而精准的音乐搜索服务”</li><li>百度：百度目前广泛使用ElasticSearch作为文本数据分析，采集百度所有服务器上的各类指标数据及用户自定义数据，通过对各种数据进行多维分析展示，辅助定位分析实例异常或业务层面异常。目前覆盖百度内部20多个业务线（包括casio、云分析、网盟、预测、文库、直达号、钱包、风控等），单集群最大100台机器，200个ES节点，每天导入30TB+数据</li><li>新浪使用ES 分析处理32亿条实时日志</li><li>阿里使用ES 构建挖财自己的日志采集和分析体系</li></ul><h2 id="_1-3-es对比solr" tabindex="-1">1.3 ES对比Solr <a class="header-anchor" href="#_1-3-es对比solr" aria-label="Permalink to &quot;1.3 ES对比Solr&quot;">​</a></h2><ul><li>Solr 利用 Zookeeper 进行分布式管理，而 Elasticsearch 自身带有分布式协调管理功能;</li><li>Solr 支持更多格式的数据，而 Elasticsearch 仅支持json文件格式；</li><li>Solr 官方提供的功能更多，而 Elasticsearch 本身更注重于核心功能，高级功能多有第三方插件提供；</li><li>Solr 在传统的搜索应用中表现好于 Elasticsearch，但在处理实时搜索应用时效率明显低于 Elasticsearch</li></ul><h1 id="第二章-es安装与启动" tabindex="-1">第二章 ES安装与启动 <a class="header-anchor" href="#第二章-es安装与启动" aria-label="Permalink to &quot;第二章 ES安装与启动&quot;">​</a></h1><h2 id="_2-1-下载和安装" tabindex="-1">2.1 下载和安装 <a class="header-anchor" href="#_2-1-下载和安装" aria-label="Permalink to &quot;2.1 下载和安装&quot;">​</a></h2><p>ElasticSearch分为Linux和Window版本，基于我们主要学习的是ElasticSearch的Java客户端的使用，所以我们课程中使用的是安装较为简便的Window版本，项目上线后，公司的运维人员会安装Linux版的ES供我们连接使用。</p><p>ElasticSearch的官方地址： <a href="https://www.elastic.co/products/elasticsearch" target="_blank" rel="noreferrer">https://www.elastic.co/products/elasticsearch</a></p><p>在资料中已经提供了下载好的<code>elasticsearch-5.6.8.zip</code>的压缩包，类似Window版的Tomcat，解压开即安装完毕。（要求JDK1.8以上）</p><ol><li>在bin文件夹中双击<code>elasticsearch.bat</code>开启服务 <ul><li>控制台显示：9300是tcp通讯端口，集群间和TCPClient都执行该端口，9200是http协议的RESTful接口 。</li></ul></li><li>在浏览器中访问<code>localhost:9200</code>，得到json格式数据即成功。</li></ol><h2 id="_2-2-图形化插件" tabindex="-1">2.2 图形化插件 <a class="header-anchor" href="#_2-2-图形化插件" aria-label="Permalink to &quot;2.2 图形化插件&quot;">​</a></h2><p>ElasticSearch不同于Solr自带图形化界面，我们可以通过安装ElasticSearch的head插件。安装插件的方式有两种，在线安装和本地安装。本文档采用本地安装方式进行head插件的安装。</p><ol><li><p>下载head插件：<a href="https://github.com/mobz/elasticsearch-head" target="_blank" rel="noreferrer">https://github.com/mobz/elasticsearch-head</a></p><ul><li>在资料中已经提供了elasticsearch-head-master插件压缩包，压缩包解压到任意目录，但是要和elasticsearch的安装目录区别开。</li></ul></li><li><p><code>head-master</code>基于nodejs开发，所以下载nodejs：<a href="https://nodejs.org/en/download/" target="_blank" rel="noreferrer">https://nodejs.org/en/download/</a></p><ul><li>在资料中已经提供了nodejs安装程序<code>node-v8.9.4-x64.msi</code>，双击一路Next安装即可</li></ul></li><li><p>安装完毕，可以通过cmd控制台输入：<code>node -v</code> 查看版本号</p></li><li><p>将grunt安装为全局命令 ，Grunt是基于Node.js的项目构建工具，所以在cmd控制台中输入如下执行命令：<code>npm install -g grunt-cli</code></p></li><li><p><strong>进入elasticsearch-head-master目录</strong>，在命令提示符下输入命令：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">&gt;npm install     // 安装一些东西（仅第一次）</span></span>
<span class="line"><span style="color:#e1e4e8;">&gt;grunt server	 // 开启nodejs服务</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">&gt;npm install     // 安装一些东西（仅第一次）</span></span>
<span class="line"><span style="color:#24292e;">&gt;grunt server	 // 开启nodejs服务</span></span></code></pre></div></li><li><p>打开浏览器，输入 <code>http://localhost:9100</code>，可以看到ES的界面</p></li><li><p>在连接地址栏<code>http://localhost:9200/</code>，单击<code>连接</code>按钮，连不上。因为跨域了，需要在ES中进行配置。</p></li><li><p>修改ElasticSearch的config目录下的配置文件：<code>config/elasticsearch.yml</code>，在最后增加以下两句命令：（注意字符，复制之后可重新写一下<code>-</code>）</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">http.cors.enabled: true</span></span>
<span class="line"><span style="color:#e1e4e8;">http.cors.allow-origin: &quot;*&quot;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">http.cors.enabled: true</span></span>
<span class="line"><span style="color:#24292e;">http.cors.allow-origin: &quot;*&quot;</span></span></code></pre></div></li><li><p>然后重新启动ElasticSearch服务。</p></li><li><p>点击连接，即可成功。</p></li></ol><h1 id="第三章-es相关概念" tabindex="-1">第三章 ES相关概念 <a class="header-anchor" href="#第三章-es相关概念" aria-label="Permalink to &quot;第三章 ES相关概念&quot;">​</a></h1><h2 id="_3-1-概述" tabindex="-1">3.1 概述 <a class="header-anchor" href="#_3-1-概述" aria-label="Permalink to &quot;3.1 概述&quot;">​</a></h2><p>Elasticsearch是面向文档(document oriented)的，这意味着它可以存储整个对象或文档(document)。然而它不仅仅是存储，还会索引(index)每个文档的内容使之可以被搜索。在Elasticsearch中，你可以对文档（而非成行成列的数据）进行索引、搜索、排序、过滤。Elasticsearch比传统关系型数据库如下：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">Relational DB -&gt; Databases -&gt; Tables -&gt; Rows -&gt; Columns</span></span>
<span class="line"><span style="color:#e1e4e8;">Elasticsearch -&gt; Indices   -&gt; Types  -&gt; Documents -&gt; Fields</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">Relational DB -&gt; Databases -&gt; Tables -&gt; Rows -&gt; Columns</span></span>
<span class="line"><span style="color:#24292e;">Elasticsearch -&gt; Indices   -&gt; Types  -&gt; Documents -&gt; Fields</span></span></code></pre></div><h2 id="_3-2-es核心概念" tabindex="-1">3.2 ES核心概念 <a class="header-anchor" href="#_3-2-es核心概念" aria-label="Permalink to &quot;3.2 ES核心概念&quot;">​</a></h2><h3 id="_3-2-1-索引-index" tabindex="-1">3.2.1 索引 index <a class="header-anchor" href="#_3-2-1-索引-index" aria-label="Permalink to &quot;3.2.1 索引 index&quot;">​</a></h3><p>一个索引就是一个拥有几分相似特征的文档的集合。比如说，你可以有一个客户数据的索引，另一个产品目录的索引，还有一个订单数据的索引。一个索引由一个名字来标识（必须全部是小写字母的），并且当我们要对对应于这个索引中的文档进行索引、搜索、更新和删除的时候，都要使用到这个名字。在一个集群中，可以定义任意多的索引。</p><h3 id="_3-2-2-类型-type" tabindex="-1">3.2.2 类型 type <a class="header-anchor" href="#_3-2-2-类型-type" aria-label="Permalink to &quot;3.2.2 类型 type&quot;">​</a></h3><p>在一个索引中，你可以定义一种或多种类型。一个类型是你的索引的一个逻辑上的分类/分区，其语义完全由你来定。通常，会为具有一组共同字段的文档定义一个类型。比如说，我们假设你运营一个博客平台并且将你所有的数据存储到一个索引中。在这个索引中，你可以为用户数据定义一个类型，为博客数据定义另一个类型，当然，也可以为评论数据定义另一个类型。</p><h3 id="_3-2-3-字段-field" tabindex="-1">3.2.3 字段 Field <a class="header-anchor" href="#_3-2-3-字段-field" aria-label="Permalink to &quot;3.2.3 字段 Field&quot;">​</a></h3><p>相当于是数据表的字段，对文档数据根据不同属性进行的分类标识</p><h3 id="_3-2-4-映射-mapping" tabindex="-1">3.2.4 映射 mapping <a class="header-anchor" href="#_3-2-4-映射-mapping" aria-label="Permalink to &quot;3.2.4 映射 mapping&quot;">​</a></h3><p>mapping是处理数据的方式和规则方面做一些限制，如某个字段的数据类型、默认值、分析器、是否被索引等等，这些都是映射里面可以设置的，其它就是处理es里面数据的一些使用规则设置也叫做映射，按着最优规则处理数据对性能提高很大，因此才需要建立映射，并且需要思考如何建立映射才能对性能更好。</p><h3 id="_3-2-5-文档-document" tabindex="-1">3.2.5 文档 document <a class="header-anchor" href="#_3-2-5-文档-document" aria-label="Permalink to &quot;3.2.5 文档 document&quot;">​</a></h3><p>一个文档是一个可被索引的基础信息单元。比如，你可以拥有某一个客户的文档，某一个产品的一个文档，当然，也可以拥有某个订单的一个文档。文档以JSON（Javascript Object Notation）格式来表示，而JSON是一个到处存在的互联网数据交互格式。</p><p>在一个index/type里面，你可以存储任意多的文档。注意，尽管一个文档，物理上存在于一个索引之中，文档必须被索引/赋予一个索引的type。</p><h3 id="_3-2-6-接近实时-nrt" tabindex="-1">3.2.6 接近实时 NRT <a class="header-anchor" href="#_3-2-6-接近实时-nrt" aria-label="Permalink to &quot;3.2.6 接近实时 NRT&quot;">​</a></h3><p>Elasticsearch是一个接近实时的搜索平台。这意味着，从索引一个文档直到这个文档能够被搜索到有一个轻微的延迟（通常是1秒以内）</p><h3 id="_3-2-7-集群-cluster" tabindex="-1">3.2.7 集群 cluster <a class="header-anchor" href="#_3-2-7-集群-cluster" aria-label="Permalink to &quot;3.2.7 集群 cluster&quot;">​</a></h3><p>一个集群就是由一个或多个节点组织在一起，它们共同持有整个的数据，并一起提供索引和搜索功能。一个集群由一个唯一的名字标识，这个名字默认就是“elasticsearch”。这个名字是重要的，因为一个节点只能通过指定某个集群的名字，来加入这个集群</p><h3 id="_3-2-8-节点-node" tabindex="-1">3.2.8 节点 node <a class="header-anchor" href="#_3-2-8-节点-node" aria-label="Permalink to &quot;3.2.8 节点 node&quot;">​</a></h3><p>一个节点是集群中的一个服务器，作为集群的一部分，它存储数据，参与集群的索引和搜索功能。和集群类似，一个节点也是由一个名字来标识的，默认情况下，这个名字是一个随机的漫威漫画角色的名字，这个名字会在启动的时候赋予节点。这个名字对于管理工作来说挺重要的，因为在这个管理过程中，你会去确定网络中的哪些服务器对应于Elasticsearch集群中的哪些节点。</p><p>一个节点可以通过配置集群名称的方式来加入一个指定的集群。默认情况下，每个节点都会被安排加入到一个叫做“elasticsearch”的集群中，这意味着，如果你在你的网络中启动了若干个节点，并假定它们能够相互发现彼此，它们将会自动地形成并加入到一个叫做“elasticsearch”的集群中。</p><p>在一个集群里，只要你想，可以拥有任意多个节点。而且，如果当前你的网络中没有运行任何Elasticsearch节点，这时启动一个节点，会默认创建并加入一个叫做“elasticsearch”的集群。</p><h3 id="_3-2-9-分片和复制-shards-replicas" tabindex="-1">3.2.9 分片和复制 shards&amp;replicas <a class="header-anchor" href="#_3-2-9-分片和复制-shards-replicas" aria-label="Permalink to &quot;3.2.9 分片和复制 shards&amp;replicas&quot;">​</a></h3><p>一个索引可以存储超出单个结点硬件限制的大量数据。比如，一个具有10亿文档的索引占据1TB的磁盘空间，而任一节点都没有这样大的磁盘空间；或者单个节点处理搜索请求，响应太慢。为了解决这个问题，Elasticsearch提供了将索引划分成多份的能力，这些份就叫做分片。当你创建一个索引的时候，你可以指定你想要的分片的数量。每个分片本身也是一个功能完善并且独立的“索引”，这个“索引”可以被放置到集群中的任何节点上。分片很重要，主要有两方面的原因： 1）允许你水平分割/扩展你的内容容量。 2）允许你在分片（潜在地，位于多个节点上）之上进行分布式的、并行的操作，进而提高性能/吞吐量。</p><p>至于一个分片怎样分布，它的文档怎样聚合回搜索请求，是完全由Elasticsearch管理的，对于作为用户的你来说，这些都是透明的。</p><p>在一个网络/云的环境里，失败随时都可能发生，在某个分片/节点不知怎么的就处于离线状态，或者由于任何原因消失了，这种情况下，有一个故障转移机制是非常有用并且是强烈推荐的。为此目的，Elasticsearch允许你创建分片的一份或多份拷贝，这些拷贝叫做复制分片，或者直接叫复制。</p><p>复制之所以重要，有两个主要原因： 在分片/节点失败的情况下，提供了高可用性。因为这个原因，注意到复制分片从不与原/主要（original/primary）分片置于同一节点上是非常重要的。扩展你的搜索量/吞吐量，因为搜索可以在所有的复制上并行运行。总之，每个索引可以被分成多个分片。一个索引也可以被复制0次（意思是没有复制）或多次。一旦复制了，每个索引就有了主分片（作为复制源的原来的分片）和复制分片（主分片的拷贝）之别。分片和复制的数量可以在索引创建的时候指定。在索引创建之后，你可以在任何时候动态地改变复制的数量，但是你事后不能改变分片的数量。</p><p>默认情况下，Elasticsearch中的每个索引被分片5个主分片和1个复制，这意味着，如果你的集群中至少有两个节点，你的索引将会有5个主分片和另外5个复制分片（1个完全拷贝），这样的话每个索引总共就有10个分片。</p><h1 id="第四章-es的客户端操作" tabindex="-1">第四章 ES的客户端操作 <a class="header-anchor" href="#第四章-es的客户端操作" aria-label="Permalink to &quot;第四章 ES的客户端操作&quot;">​</a></h1><p>实际开发中，主要有三种方式可以作为elasticsearch服务的客户端：</p><ul><li>第一种，elasticsearch-head插件</li><li>第二种，使用elasticsearch提供的Restful接口直接访问</li><li>第三种，使用elasticsearch提供的API进行访问</li></ul><h2 id="_4-1-安装postman工具" tabindex="-1">4.1 安装Postman工具 <a class="header-anchor" href="#_4-1-安装postman工具" aria-label="Permalink to &quot;4.1 安装Postman工具&quot;">​</a></h2><p>Postman中文版是postman这款强大网页调试工具的windows客户端，提供功能强大的Web API &amp; HTTP 请求调试。软件功能非常强大，界面简洁明晰、操作方便快捷，设计得很人性化。Postman中文版能够发送任何类型的HTTP 请求 (GET, HEAD, POST, PUT..)，且可以附带任何数量的参数。</p><p>Postman和ES没有任何关系，用来调式网页，主要是用Restful接口比较方便。（个人感觉仅比elasticsearch-head方便一点点吧，elasticsearch-head的复合查询也可以用）</p><p>Postman官网：<a href="https://www.getpostman.com" target="_blank" rel="noreferrer">https://www.getpostman.com</a></p><p>课程资料中已经提供了安装包，双击即可。</p><p>可能会提示你安装<code>.NET4.5</code>，那就安装，重启一下电脑。</p><p>不注册也可以用。</p><p>Postman发送请求页面如下：</p><p><img src="`+p+`" alt="image-20210728210700633"></p><h2 id="_4-2-使用postman工具进行restful接口访问" tabindex="-1">4.2 使用Postman工具进行Restful接口访问 <a class="header-anchor" href="#_4-2-使用postman工具进行restful接口访问" aria-label="Permalink to &quot;4.2 使用Postman工具进行Restful接口访问&quot;">​</a></h2><h3 id="put和post区别" tabindex="-1">PUT和POST区别 <a class="header-anchor" href="#put和post区别" aria-label="Permalink to &quot;PUT和POST区别&quot;">​</a></h3><p>GET、PUT、DELETE具有幂等性，而POST没有。</p><p>所以有的时候可以用PUT和POST，有的时候只能用其中一个。</p><h3 id="index" tabindex="-1">Index <a class="header-anchor" href="#index" aria-label="Permalink to &quot;Index&quot;">​</a></h3><p>创建、删除、查看</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">--创建索引blog</span><span style="color:#79B8FF;">1</span></span>
<span class="line"><span style="color:#E1E4E8;">PUT			localhost:</span><span style="color:#79B8FF;">9200</span><span style="color:#E1E4E8;">/blog</span><span style="color:#79B8FF;">1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">--删除索引</span></span>
<span class="line"><span style="color:#E1E4E8;">DELETE		localhost:</span><span style="color:#79B8FF;">9200</span><span style="color:#E1E4E8;">/blog</span><span style="color:#79B8FF;">1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">--查看索引blogs</span><span style="color:#79B8FF;">1</span></span>
<span class="line"><span style="color:#E1E4E8;">GET			localhost:</span><span style="color:#79B8FF;">9200</span><span style="color:#E1E4E8;">/blog</span><span style="color:#79B8FF;">1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">--查看所有索引 v参数表示格式化输出</span></span>
<span class="line"><span style="color:#E1E4E8;">GET			localhost:</span><span style="color:#79B8FF;">9200</span><span style="color:#E1E4E8;">/_cat/indices?v</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">--创建索引blog</span><span style="color:#005CC5;">1</span></span>
<span class="line"><span style="color:#24292E;">PUT			localhost:</span><span style="color:#005CC5;">9200</span><span style="color:#24292E;">/blog</span><span style="color:#005CC5;">1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">--删除索引</span></span>
<span class="line"><span style="color:#24292E;">DELETE		localhost:</span><span style="color:#005CC5;">9200</span><span style="color:#24292E;">/blog</span><span style="color:#005CC5;">1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">--查看索引blogs</span><span style="color:#005CC5;">1</span></span>
<span class="line"><span style="color:#24292E;">GET			localhost:</span><span style="color:#005CC5;">9200</span><span style="color:#24292E;">/blog</span><span style="color:#005CC5;">1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">--查看所有索引 v参数表示格式化输出</span></span>
<span class="line"><span style="color:#24292E;">GET			localhost:</span><span style="color:#005CC5;">9200</span><span style="color:#24292E;">/_cat/indices?v</span></span></code></pre></div><h3 id="document" tabindex="-1">Document <a class="header-anchor" href="#document" aria-label="Permalink to &quot;Document&quot;">​</a></h3><p>添加、删除、修改、查看</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">--添加文档hello （服务器端自动生成id，所以不能用PUT，PUT具有幂等性）</span></span>
<span class="line"><span style="color:#E1E4E8;">POST		localhost:</span><span style="color:#79B8FF;">9200</span><span style="color:#E1E4E8;">/blog</span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">/_doc</span></span>
<span class="line"><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#79B8FF;">&quot;title&quot;</span><span style="color:#E1E4E8;">:</span><span style="color:#9ECBFF;">&quot;新添加的文档1&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">&quot;other&quot;</span><span style="color:#E1E4E8;">:</span><span style="color:#9ECBFF;">&quot;hehe&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#79B8FF;">&quot;content&quot;</span><span style="color:#E1E4E8;">:</span><span style="color:#9ECBFF;">&quot;Elasticsearch是用Java开发的&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">--添加文档hello （指定id，也可以用PUT）</span></span>
<span class="line"><span style="color:#E1E4E8;">POST		localhost:</span><span style="color:#79B8FF;">9200</span><span style="color:#E1E4E8;">/blog</span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">/_doc/</span><span style="color:#79B8FF;">1001</span></span>
<span class="line"><span style="color:#E1E4E8;">POST		localhost:</span><span style="color:#79B8FF;">9200</span><span style="color:#E1E4E8;">/blog</span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">/_create/</span><span style="color:#79B8FF;">1001</span></span>
<span class="line"><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#79B8FF;">&quot;title&quot;</span><span style="color:#E1E4E8;">:</span><span style="color:#9ECBFF;">&quot;新添加的文档1&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">&quot;other&quot;</span><span style="color:#E1E4E8;">:</span><span style="color:#9ECBFF;">&quot;hehe&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#79B8FF;">&quot;content&quot;</span><span style="color:#E1E4E8;">:</span><span style="color:#9ECBFF;">&quot;它提供了一个分布式多用户能力的全文搜索引擎，基于RESTful web接口&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">--添加文档hello （服务器端自动生成id，所以不能用PUT，PUT具有幂等性）</span></span>
<span class="line"><span style="color:#24292E;">POST		localhost:</span><span style="color:#005CC5;">9200</span><span style="color:#24292E;">/blog</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">/_doc</span></span>
<span class="line"><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#005CC5;">&quot;title&quot;</span><span style="color:#24292E;">:</span><span style="color:#032F62;">&quot;新添加的文档1&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">&quot;other&quot;</span><span style="color:#24292E;">:</span><span style="color:#032F62;">&quot;hehe&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#005CC5;">&quot;content&quot;</span><span style="color:#24292E;">:</span><span style="color:#032F62;">&quot;Elasticsearch是用Java开发的&quot;</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">--添加文档hello （指定id，也可以用PUT）</span></span>
<span class="line"><span style="color:#24292E;">POST		localhost:</span><span style="color:#005CC5;">9200</span><span style="color:#24292E;">/blog</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">/_doc/</span><span style="color:#005CC5;">1001</span></span>
<span class="line"><span style="color:#24292E;">POST		localhost:</span><span style="color:#005CC5;">9200</span><span style="color:#24292E;">/blog</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">/_create/</span><span style="color:#005CC5;">1001</span></span>
<span class="line"><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#005CC5;">&quot;title&quot;</span><span style="color:#24292E;">:</span><span style="color:#032F62;">&quot;新添加的文档1&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">&quot;other&quot;</span><span style="color:#24292E;">:</span><span style="color:#032F62;">&quot;hehe&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#005CC5;">&quot;content&quot;</span><span style="color:#24292E;">:</span><span style="color:#032F62;">&quot;它提供了一个分布式多用户能力的全文搜索引擎，基于RESTful web接口&quot;</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p>修改</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">-- 这里是全部数据更新 （也可以POST）</span></span>
<span class="line"><span style="color:#e1e4e8;">PUT		localhost:9200/blog1/_doc/1001</span></span>
<span class="line"><span style="color:#e1e4e8;">{</span></span>
<span class="line"><span style="color:#e1e4e8;">	&quot;title&quot;:&quot;新添加的文档1&quot;,</span></span>
<span class="line"><span style="color:#e1e4e8;">    &quot;other&quot;:&quot;hehe&quot;,</span></span>
<span class="line"><span style="color:#e1e4e8;">	&quot;content&quot;:&quot;它提供了一个分布式多用户能力的全文搜索引擎，基于RESTful web接口&quot;</span></span>
<span class="line"><span style="color:#e1e4e8;">}</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">-- 局部更新 （局部更新不能用PUT，PUT具有幂等性）</span></span>
<span class="line"><span style="color:#e1e4e8;">POST	localhost:9200/blog1/_update/1001</span></span>
<span class="line"><span style="color:#e1e4e8;">{</span></span>
<span class="line"><span style="color:#e1e4e8;">    &quot;doc&quot;: {</span></span>
<span class="line"><span style="color:#e1e4e8;">        &quot;title&quot;:&quot;新添加的文档3&quot;</span></span>
<span class="line"><span style="color:#e1e4e8;">    }</span></span>
<span class="line"><span style="color:#e1e4e8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">-- 这里是全部数据更新 （也可以POST）</span></span>
<span class="line"><span style="color:#24292e;">PUT		localhost:9200/blog1/_doc/1001</span></span>
<span class="line"><span style="color:#24292e;">{</span></span>
<span class="line"><span style="color:#24292e;">	&quot;title&quot;:&quot;新添加的文档1&quot;,</span></span>
<span class="line"><span style="color:#24292e;">    &quot;other&quot;:&quot;hehe&quot;,</span></span>
<span class="line"><span style="color:#24292e;">	&quot;content&quot;:&quot;它提供了一个分布式多用户能力的全文搜索引擎，基于RESTful web接口&quot;</span></span>
<span class="line"><span style="color:#24292e;">}</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">-- 局部更新 （局部更新不能用PUT，PUT具有幂等性）</span></span>
<span class="line"><span style="color:#24292e;">POST	localhost:9200/blog1/_update/1001</span></span>
<span class="line"><span style="color:#24292e;">{</span></span>
<span class="line"><span style="color:#24292e;">    &quot;doc&quot;: {</span></span>
<span class="line"><span style="color:#24292e;">        &quot;title&quot;:&quot;新添加的文档3&quot;</span></span>
<span class="line"><span style="color:#24292e;">    }</span></span>
<span class="line"><span style="color:#24292e;">}</span></span></code></pre></div><p>简单查询、删除</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">--查看文档中 （根据id）</span></span>
<span class="line"><span style="color:#e1e4e8;">GET			localhost:9200/blog1/_doc/1001</span></span>
<span class="line"><span style="color:#e1e4e8;">--查看文档 （所有数据）</span></span>
<span class="line"><span style="color:#e1e4e8;">GET			localhost:9200/blog1/_search</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">--删除</span></span>
<span class="line"><span style="color:#e1e4e8;">DELETE		localhost:9200/blog1/_doc/1001</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">--查看文档中 （根据id）</span></span>
<span class="line"><span style="color:#24292e;">GET			localhost:9200/blog1/_doc/1001</span></span>
<span class="line"><span style="color:#24292e;">--查看文档 （所有数据）</span></span>
<span class="line"><span style="color:#24292e;">GET			localhost:9200/blog1/_search</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">--删除</span></span>
<span class="line"><span style="color:#24292e;">DELETE		localhost:9200/blog1/_doc/1001</span></span></code></pre></div><p>条件查询、分页查询</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">--查询title中有&quot;新&quot;</span></span>
<span class="line"><span style="color:#e1e4e8;">GET		localhost:9200/blog1/_search?q=title:新</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">--请求体查询</span></span>
<span class="line"><span style="color:#e1e4e8;">GET		localhost:9200/blog1/_search</span></span>
<span class="line"><span style="color:#e1e4e8;">{</span></span>
<span class="line"><span style="color:#e1e4e8;">    &quot;query&quot;: {</span></span>
<span class="line"><span style="color:#e1e4e8;">        &quot;match&quot;: {</span></span>
<span class="line"><span style="color:#e1e4e8;">            &quot;title&quot;: &quot;新&quot;</span></span>
<span class="line"><span style="color:#e1e4e8;">        }</span></span>
<span class="line"><span style="color:#e1e4e8;">    }</span></span>
<span class="line"><span style="color:#e1e4e8;">}</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">-- 查询全部 （数据量大的时候，应该用分页查询）</span></span>
<span class="line"><span style="color:#e1e4e8;">GET		localhost:9200/blog1/_search</span></span>
<span class="line"><span style="color:#e1e4e8;">{</span></span>
<span class="line"><span style="color:#e1e4e8;">    &quot;query&quot;: {</span></span>
<span class="line"><span style="color:#e1e4e8;">        &quot;match_all&quot;: {</span></span>
<span class="line"><span style="color:#e1e4e8;">        }</span></span>
<span class="line"><span style="color:#e1e4e8;">    }</span></span>
<span class="line"><span style="color:#e1e4e8;">}</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">-- 分页查询 (from是页码，size是每页大小，source是显示字段)</span></span>
<span class="line"><span style="color:#e1e4e8;">GET		localhost:9200/blog1/_search</span></span>
<span class="line"><span style="color:#e1e4e8;">{</span></span>
<span class="line"><span style="color:#e1e4e8;">    &quot;query&quot;: {</span></span>
<span class="line"><span style="color:#e1e4e8;">        &quot;match_all&quot;: {</span></span>
<span class="line"><span style="color:#e1e4e8;">        }</span></span>
<span class="line"><span style="color:#e1e4e8;">    },</span></span>
<span class="line"><span style="color:#e1e4e8;">    &quot;from&quot;: 0,</span></span>
<span class="line"><span style="color:#e1e4e8;">    &quot;size&quot;: 1,</span></span>
<span class="line"><span style="color:#e1e4e8;">    &quot;_source&quot;: [&quot;title&quot;, &quot;other&quot;]</span></span>
<span class="line"><span style="color:#e1e4e8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">--查询title中有&quot;新&quot;</span></span>
<span class="line"><span style="color:#24292e;">GET		localhost:9200/blog1/_search?q=title:新</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">--请求体查询</span></span>
<span class="line"><span style="color:#24292e;">GET		localhost:9200/blog1/_search</span></span>
<span class="line"><span style="color:#24292e;">{</span></span>
<span class="line"><span style="color:#24292e;">    &quot;query&quot;: {</span></span>
<span class="line"><span style="color:#24292e;">        &quot;match&quot;: {</span></span>
<span class="line"><span style="color:#24292e;">            &quot;title&quot;: &quot;新&quot;</span></span>
<span class="line"><span style="color:#24292e;">        }</span></span>
<span class="line"><span style="color:#24292e;">    }</span></span>
<span class="line"><span style="color:#24292e;">}</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">-- 查询全部 （数据量大的时候，应该用分页查询）</span></span>
<span class="line"><span style="color:#24292e;">GET		localhost:9200/blog1/_search</span></span>
<span class="line"><span style="color:#24292e;">{</span></span>
<span class="line"><span style="color:#24292e;">    &quot;query&quot;: {</span></span>
<span class="line"><span style="color:#24292e;">        &quot;match_all&quot;: {</span></span>
<span class="line"><span style="color:#24292e;">        }</span></span>
<span class="line"><span style="color:#24292e;">    }</span></span>
<span class="line"><span style="color:#24292e;">}</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">-- 分页查询 (from是页码，size是每页大小，source是显示字段)</span></span>
<span class="line"><span style="color:#24292e;">GET		localhost:9200/blog1/_search</span></span>
<span class="line"><span style="color:#24292e;">{</span></span>
<span class="line"><span style="color:#24292e;">    &quot;query&quot;: {</span></span>
<span class="line"><span style="color:#24292e;">        &quot;match_all&quot;: {</span></span>
<span class="line"><span style="color:#24292e;">        }</span></span>
<span class="line"><span style="color:#24292e;">    },</span></span>
<span class="line"><span style="color:#24292e;">    &quot;from&quot;: 0,</span></span>
<span class="line"><span style="color:#24292e;">    &quot;size&quot;: 1,</span></span>
<span class="line"><span style="color:#24292e;">    &quot;_source&quot;: [&quot;title&quot;, &quot;other&quot;]</span></span>
<span class="line"><span style="color:#24292e;">}</span></span></code></pre></div><p>复杂条件查询示例</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">GET		localhost:9200/blog1/_search</span></span>
<span class="line"><span style="color:#e1e4e8;">{</span></span>
<span class="line"><span style="color:#e1e4e8;">    &quot;query&quot;: {</span></span>
<span class="line"><span style="color:#e1e4e8;">        &quot;bool&quot;: {							// 条件查询</span></span>
<span class="line"><span style="color:#e1e4e8;">            &quot;must&quot;: [						// must是且，should是或</span></span>
<span class="line"><span style="color:#e1e4e8;">                {</span></span>
<span class="line"><span style="color:#e1e4e8;">                    &quot;match&quot;: {              // match会分词匹配；match_phrase是完全匹配</span></span>
<span class="line"><span style="color:#e1e4e8;">                        &quot;content&quot;: &quot;Java&quot;   // content中包含Java</span></span>
<span class="line"><span style="color:#e1e4e8;">                    }</span></span>
<span class="line"><span style="color:#e1e4e8;">                },</span></span>
<span class="line"><span style="color:#e1e4e8;">                {</span></span>
<span class="line"><span style="color:#e1e4e8;">                    &quot;match&quot;: {</span></span>
<span class="line"><span style="color:#e1e4e8;">                        &quot;title&quot;: &quot;新&quot;</span></span>
<span class="line"><span style="color:#e1e4e8;">                    }</span></span>
<span class="line"><span style="color:#e1e4e8;">                }</span></span>
<span class="line"><span style="color:#e1e4e8;">            ],</span></span>
<span class="line"><span style="color:#e1e4e8;">            &quot;filter&quot;: {					// 过滤：price&gt;5000</span></span>
<span class="line"><span style="color:#e1e4e8;">                &quot;range&quot;: {</span></span>
<span class="line"><span style="color:#e1e4e8;">                    &quot;price&quot;: {</span></span>
<span class="line"><span style="color:#e1e4e8;">                        &quot;gt&quot;: 5000</span></span>
<span class="line"><span style="color:#e1e4e8;">                    }</span></span>
<span class="line"><span style="color:#e1e4e8;">                }</span></span>
<span class="line"><span style="color:#e1e4e8;">            }</span></span>
<span class="line"><span style="color:#e1e4e8;">        }</span></span>
<span class="line"><span style="color:#e1e4e8;">    },</span></span>
<span class="line"><span style="color:#e1e4e8;">    &quot;highlight&quot;: {                    // 高亮显示查询结构</span></span>
<span class="line"><span style="color:#e1e4e8;">        &quot;fields&quot;: {					  // 高亮字段</span></span>
<span class="line"><span style="color:#e1e4e8;">            &quot;content&quot;: {}</span></span>
<span class="line"><span style="color:#e1e4e8;">        }</span></span>
<span class="line"><span style="color:#e1e4e8;">    }</span></span>
<span class="line"><span style="color:#e1e4e8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">GET		localhost:9200/blog1/_search</span></span>
<span class="line"><span style="color:#24292e;">{</span></span>
<span class="line"><span style="color:#24292e;">    &quot;query&quot;: {</span></span>
<span class="line"><span style="color:#24292e;">        &quot;bool&quot;: {							// 条件查询</span></span>
<span class="line"><span style="color:#24292e;">            &quot;must&quot;: [						// must是且，should是或</span></span>
<span class="line"><span style="color:#24292e;">                {</span></span>
<span class="line"><span style="color:#24292e;">                    &quot;match&quot;: {              // match会分词匹配；match_phrase是完全匹配</span></span>
<span class="line"><span style="color:#24292e;">                        &quot;content&quot;: &quot;Java&quot;   // content中包含Java</span></span>
<span class="line"><span style="color:#24292e;">                    }</span></span>
<span class="line"><span style="color:#24292e;">                },</span></span>
<span class="line"><span style="color:#24292e;">                {</span></span>
<span class="line"><span style="color:#24292e;">                    &quot;match&quot;: {</span></span>
<span class="line"><span style="color:#24292e;">                        &quot;title&quot;: &quot;新&quot;</span></span>
<span class="line"><span style="color:#24292e;">                    }</span></span>
<span class="line"><span style="color:#24292e;">                }</span></span>
<span class="line"><span style="color:#24292e;">            ],</span></span>
<span class="line"><span style="color:#24292e;">            &quot;filter&quot;: {					// 过滤：price&gt;5000</span></span>
<span class="line"><span style="color:#24292e;">                &quot;range&quot;: {</span></span>
<span class="line"><span style="color:#24292e;">                    &quot;price&quot;: {</span></span>
<span class="line"><span style="color:#24292e;">                        &quot;gt&quot;: 5000</span></span>
<span class="line"><span style="color:#24292e;">                    }</span></span>
<span class="line"><span style="color:#24292e;">                }</span></span>
<span class="line"><span style="color:#24292e;">            }</span></span>
<span class="line"><span style="color:#24292e;">        }</span></span>
<span class="line"><span style="color:#24292e;">    },</span></span>
<span class="line"><span style="color:#24292e;">    &quot;highlight&quot;: {                    // 高亮显示查询结构</span></span>
<span class="line"><span style="color:#24292e;">        &quot;fields&quot;: {					  // 高亮字段</span></span>
<span class="line"><span style="color:#24292e;">            &quot;content&quot;: {}</span></span>
<span class="line"><span style="color:#24292e;">        }</span></span>
<span class="line"><span style="color:#24292e;">    }</span></span>
<span class="line"><span style="color:#24292e;">}</span></span></code></pre></div><p>聚合查询</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">{</span></span>
<span class="line"><span style="color:#e1e4e8;">    &quot;aggs&quot;: {                     // 聚合操作</span></span>
<span class="line"><span style="color:#e1e4e8;">        &quot;price_group&quot;: {          // 名称，随意起名</span></span>
<span class="line"><span style="color:#e1e4e8;">            &quot;terms&quot;: {            // 分组</span></span>
<span class="line"><span style="color:#e1e4e8;">                &quot;field&quot;: &quot;price&quot;  // 分组字段</span></span>
<span class="line"><span style="color:#e1e4e8;">            }</span></span>
<span class="line"><span style="color:#e1e4e8;">        }</span></span>
<span class="line"><span style="color:#e1e4e8;">    },</span></span>
<span class="line"><span style="color:#e1e4e8;">    &quot;size&quot;: 0                    // 不显示文档其他内容，只展示聚合结果</span></span>
<span class="line"><span style="color:#e1e4e8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">{</span></span>
<span class="line"><span style="color:#24292e;">    &quot;aggs&quot;: {                     // 聚合操作</span></span>
<span class="line"><span style="color:#24292e;">        &quot;price_group&quot;: {          // 名称，随意起名</span></span>
<span class="line"><span style="color:#24292e;">            &quot;terms&quot;: {            // 分组</span></span>
<span class="line"><span style="color:#24292e;">                &quot;field&quot;: &quot;price&quot;  // 分组字段</span></span>
<span class="line"><span style="color:#24292e;">            }</span></span>
<span class="line"><span style="color:#24292e;">        }</span></span>
<span class="line"><span style="color:#24292e;">    },</span></span>
<span class="line"><span style="color:#24292e;">    &quot;size&quot;: 0                    // 不显示文档其他内容，只展示聚合结果</span></span>
<span class="line"><span style="color:#24292e;">}</span></span></code></pre></div><h3 id="mapping" tabindex="-1">Mapping <a class="header-anchor" href="#mapping" aria-label="Permalink to &quot;Mapping&quot;">​</a></h3><p>映射类似于sql的表结构，对文档做一些限定，如：分词器、是否分词、是否排序等等。</p><p>创建、查询</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">-- 创建</span></span>
<span class="line"><span style="color:#e1e4e8;">PUT		localhost:9200/user/_mapping</span></span>
<span class="line"><span style="color:#e1e4e8;">{</span></span>
<span class="line"><span style="color:#e1e4e8;">    &quot;properties&quot;: {</span></span>
<span class="line"><span style="color:#e1e4e8;">        &quot;name&quot;: {</span></span>
<span class="line"><span style="color:#e1e4e8;">            &quot;type&quot;: &quot;text&quot;,         // text可以分词</span></span>
<span class="line"><span style="color:#e1e4e8;">            &quot;index&quot;: true</span></span>
<span class="line"><span style="color:#e1e4e8;">        },</span></span>
<span class="line"><span style="color:#e1e4e8;">        &quot;sex&quot;: {</span></span>
<span class="line"><span style="color:#e1e4e8;">            &quot;type&quot;: &quot;keyword&quot;,     // keyword表示不能分词，只能完全匹配</span></span>
<span class="line"><span style="color:#e1e4e8;">            &quot;index&quot;: true</span></span>
<span class="line"><span style="color:#e1e4e8;">        },</span></span>
<span class="line"><span style="color:#e1e4e8;">        &quot;tel&quot; {</span></span>
<span class="line"><span style="color:#e1e4e8;">            &quot;type&quot;: &quot;keyword&quot;,</span></span>
<span class="line"><span style="color:#e1e4e8;">            &quot;index&quot;: true</span></span>
<span class="line"><span style="color:#e1e4e8;">        }</span></span>
<span class="line"><span style="color:#e1e4e8;">    }</span></span>
<span class="line"><span style="color:#e1e4e8;">}</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">-- 查询</span></span>
<span class="line"><span style="color:#e1e4e8;">GET		localhost:9200/user/_mapping</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">-- 创建</span></span>
<span class="line"><span style="color:#24292e;">PUT		localhost:9200/user/_mapping</span></span>
<span class="line"><span style="color:#24292e;">{</span></span>
<span class="line"><span style="color:#24292e;">    &quot;properties&quot;: {</span></span>
<span class="line"><span style="color:#24292e;">        &quot;name&quot;: {</span></span>
<span class="line"><span style="color:#24292e;">            &quot;type&quot;: &quot;text&quot;,         // text可以分词</span></span>
<span class="line"><span style="color:#24292e;">            &quot;index&quot;: true</span></span>
<span class="line"><span style="color:#24292e;">        },</span></span>
<span class="line"><span style="color:#24292e;">        &quot;sex&quot;: {</span></span>
<span class="line"><span style="color:#24292e;">            &quot;type&quot;: &quot;keyword&quot;,     // keyword表示不能分词，只能完全匹配</span></span>
<span class="line"><span style="color:#24292e;">            &quot;index&quot;: true</span></span>
<span class="line"><span style="color:#24292e;">        },</span></span>
<span class="line"><span style="color:#24292e;">        &quot;tel&quot; {</span></span>
<span class="line"><span style="color:#24292e;">            &quot;type&quot;: &quot;keyword&quot;,</span></span>
<span class="line"><span style="color:#24292e;">            &quot;index&quot;: true</span></span>
<span class="line"><span style="color:#24292e;">        }</span></span>
<span class="line"><span style="color:#24292e;">    }</span></span>
<span class="line"><span style="color:#24292e;">}</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">-- 查询</span></span>
<span class="line"><span style="color:#24292e;">GET		localhost:9200/user/_mapping</span></span></code></pre></div><h2 id="_4-3-es的接口语法" tabindex="-1">4.3 ES的接口语法 <a class="header-anchor" href="#_4-3-es的接口语法" aria-label="Permalink to &quot;4.3 ES的接口语法&quot;">​</a></h2><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">curl -X &lt;VERB&gt; &#39;&lt;PROTOCOL&gt;://&lt;HOST&gt;:&lt;PORT&gt;/&lt;PATH&gt;?&lt;QUERY_STRING&gt;&#39; -d &#39;&lt;BODY&gt;&#39;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">curl -X &lt;VERB&gt; &#39;&lt;PROTOCOL&gt;://&lt;HOST&gt;:&lt;PORT&gt;/&lt;PATH&gt;?&lt;QUERY_STRING&gt;&#39; -d &#39;&lt;BODY&gt;&#39;</span></span></code></pre></div><p>其中：</p><table><thead><tr><th>参数</th><th>解释</th></tr></thead><tbody><tr><td><code>VERB</code></td><td>适当的 HTTP <em>方法</em> 或 <em>谓词</em> : <code>GET</code>、 <code>POST</code>、 <code>PUT</code>、 <code>HEAD</code> 或者 <code>DELETE</code>。</td></tr><tr><td><code>PROTOCOL</code></td><td><code>http</code> 或者 <code>https</code>（如果你在 Elasticsearch 前面有一个 <code>https</code> 代理）</td></tr><tr><td><code>HOST</code></td><td>Elasticsearch 集群中任意节点的主机名，或者用 <code>localhost</code> 代表本地机器上的节点。</td></tr><tr><td><code>PORT</code></td><td>运行 Elasticsearch HTTP 服务的端口号，默认是 <code>9200</code> 。</td></tr><tr><td><code>PATH</code></td><td>API 的终端路径（例如 <code>_count</code> 将返回集群中文档数量）。Path 可能包含多个组件，例如：<code>_cluster/stats</code> 和 <code>_nodes/stats/jvm</code> 。</td></tr><tr><td><code>QUERY_STRING</code></td><td>任意可选的查询字符串参数 (例如 <code>?pretty</code> 将格式化地输出 JSON 返回值，使其更容易阅读)</td></tr><tr><td><code>BODY</code></td><td>一个 JSON 格式的请求体 (如果请求需要的话)</td></tr></tbody></table><h1 id="第五章-ik-分词器和elasticsearch集成使用" tabindex="-1">第五章 IK 分词器和ElasticSearch集成使用 <a class="header-anchor" href="#第五章-ik-分词器和elasticsearch集成使用" aria-label="Permalink to &quot;第五章 IK 分词器和ElasticSearch集成使用&quot;">​</a></h1><h2 id="_5-1-上述查询存在问题分析" tabindex="-1">5.1 上述查询存在问题分析 <a class="header-anchor" href="#_5-1-上述查询存在问题分析" aria-label="Permalink to &quot;5.1 上述查询存在问题分析&quot;">​</a></h2><p>在进行字符串查询时，我们发现去搜索&quot;搜索服务器&quot;和&quot;钢索&quot;都可以搜索到数据；</p><p>而在进行词条查询时，我们搜索&quot;搜索&quot;却没有搜索到数据；</p><p>究其原因是ElasticSearch的标准分词器导致的，当我们创建索引时，字段使用的是标准分词器：</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">&quot;mappings&quot;</span><span style="color:#E1E4E8;">: {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#79B8FF;">&quot;article&quot;</span><span style="color:#E1E4E8;">: {</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#79B8FF;">&quot;properties&quot;</span><span style="color:#E1E4E8;">: {</span></span>
<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#79B8FF;">&quot;id&quot;</span><span style="color:#E1E4E8;">: {</span></span>
<span class="line"><span style="color:#E1E4E8;">                	</span><span style="color:#79B8FF;">&quot;type&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;long&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">                    </span><span style="color:#79B8FF;">&quot;store&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">true</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">                    </span><span style="color:#79B8FF;">&quot;index&quot;</span><span style="color:#E1E4E8;">:</span><span style="color:#9ECBFF;">&quot;not_analyzed&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">                },</span></span>
<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#79B8FF;">&quot;title&quot;</span><span style="color:#E1E4E8;">: {</span></span>
<span class="line"><span style="color:#E1E4E8;">                	</span><span style="color:#79B8FF;">&quot;type&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;text&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">                    </span><span style="color:#79B8FF;">&quot;store&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">true</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">                    </span><span style="color:#79B8FF;">&quot;index&quot;</span><span style="color:#E1E4E8;">:</span><span style="color:#9ECBFF;">&quot;analyzed&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">                    </span><span style="color:#79B8FF;">&quot;analyzer&quot;</span><span style="color:#E1E4E8;">:</span><span style="color:#9ECBFF;">&quot;standard&quot;</span><span style="color:#E1E4E8;">	</span><span style="color:#6A737D;">//标准分词器</span></span>
<span class="line"><span style="color:#E1E4E8;">                },</span></span>
<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#79B8FF;">&quot;content&quot;</span><span style="color:#E1E4E8;">: {</span></span>
<span class="line"><span style="color:#E1E4E8;">                	</span><span style="color:#79B8FF;">&quot;type&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;text&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">                    </span><span style="color:#79B8FF;">&quot;store&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">true</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">                    </span><span style="color:#79B8FF;">&quot;index&quot;</span><span style="color:#E1E4E8;">:</span><span style="color:#9ECBFF;">&quot;analyzed&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">                    </span><span style="color:#79B8FF;">&quot;analyzer&quot;</span><span style="color:#E1E4E8;">:</span><span style="color:#9ECBFF;">&quot;standard&quot;</span><span style="color:#E1E4E8;">	</span><span style="color:#6A737D;">//标准分词器</span></span>
<span class="line"><span style="color:#E1E4E8;">                }</span></span>
<span class="line"><span style="color:#E1E4E8;">            }</span></span>
<span class="line"><span style="color:#E1E4E8;">        }</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">&quot;mappings&quot;</span><span style="color:#24292E;">: {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#005CC5;">&quot;article&quot;</span><span style="color:#24292E;">: {</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#005CC5;">&quot;properties&quot;</span><span style="color:#24292E;">: {</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#005CC5;">&quot;id&quot;</span><span style="color:#24292E;">: {</span></span>
<span class="line"><span style="color:#24292E;">                	</span><span style="color:#005CC5;">&quot;type&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;long&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">                    </span><span style="color:#005CC5;">&quot;store&quot;</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">true</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">                    </span><span style="color:#005CC5;">&quot;index&quot;</span><span style="color:#24292E;">:</span><span style="color:#032F62;">&quot;not_analyzed&quot;</span></span>
<span class="line"><span style="color:#24292E;">                },</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#005CC5;">&quot;title&quot;</span><span style="color:#24292E;">: {</span></span>
<span class="line"><span style="color:#24292E;">                	</span><span style="color:#005CC5;">&quot;type&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;text&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">                    </span><span style="color:#005CC5;">&quot;store&quot;</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">true</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">                    </span><span style="color:#005CC5;">&quot;index&quot;</span><span style="color:#24292E;">:</span><span style="color:#032F62;">&quot;analyzed&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">                    </span><span style="color:#005CC5;">&quot;analyzer&quot;</span><span style="color:#24292E;">:</span><span style="color:#032F62;">&quot;standard&quot;</span><span style="color:#24292E;">	</span><span style="color:#6A737D;">//标准分词器</span></span>
<span class="line"><span style="color:#24292E;">                },</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#005CC5;">&quot;content&quot;</span><span style="color:#24292E;">: {</span></span>
<span class="line"><span style="color:#24292E;">                	</span><span style="color:#005CC5;">&quot;type&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;text&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">                    </span><span style="color:#005CC5;">&quot;store&quot;</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">true</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">                    </span><span style="color:#005CC5;">&quot;index&quot;</span><span style="color:#24292E;">:</span><span style="color:#032F62;">&quot;analyzed&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">                    </span><span style="color:#005CC5;">&quot;analyzer&quot;</span><span style="color:#24292E;">:</span><span style="color:#032F62;">&quot;standard&quot;</span><span style="color:#24292E;">	</span><span style="color:#6A737D;">//标准分词器</span></span>
<span class="line"><span style="color:#24292E;">                }</span></span>
<span class="line"><span style="color:#24292E;">            }</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p>例如对 &quot;我是程序员&quot; 进行分词</p><p>标准分词器分词效果测试：</p><div class="language-http vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">http</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">http://127.0.0.1:9200/_analyze?analyzer=standard&amp;pretty=true&amp;text=我是程序员</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">http://127.0.0.1:9200/_analyze?analyzer=standard&amp;pretty=true&amp;text=我是程序员</span></span></code></pre></div><p>分词结果：</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">&quot;tokens&quot;</span><span style="color:#E1E4E8;"> : [</span></span>
<span class="line"><span style="color:#E1E4E8;">    {</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">&quot;token&quot;</span><span style="color:#E1E4E8;"> : </span><span style="color:#9ECBFF;">&quot;我&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">&quot;start_offset&quot;</span><span style="color:#E1E4E8;"> : </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">&quot;end_offset&quot;</span><span style="color:#E1E4E8;"> : </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">&quot;type&quot;</span><span style="color:#E1E4E8;"> : </span><span style="color:#9ECBFF;">&quot;&lt;IDEOGRAPHIC&gt;&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">&quot;position&quot;</span><span style="color:#E1E4E8;"> : </span><span style="color:#79B8FF;">0</span></span>
<span class="line"><span style="color:#E1E4E8;">    },</span></span>
<span class="line"><span style="color:#E1E4E8;">    {</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">&quot;token&quot;</span><span style="color:#E1E4E8;"> : </span><span style="color:#9ECBFF;">&quot;是&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">&quot;start_offset&quot;</span><span style="color:#E1E4E8;"> : </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">&quot;end_offset&quot;</span><span style="color:#E1E4E8;"> : </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">&quot;type&quot;</span><span style="color:#E1E4E8;"> : </span><span style="color:#9ECBFF;">&quot;&lt;IDEOGRAPHIC&gt;&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">&quot;position&quot;</span><span style="color:#E1E4E8;"> : </span><span style="color:#79B8FF;">1</span></span>
<span class="line"><span style="color:#E1E4E8;">    },</span></span>
<span class="line"><span style="color:#E1E4E8;">    {</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">&quot;token&quot;</span><span style="color:#E1E4E8;"> : </span><span style="color:#9ECBFF;">&quot;程&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">&quot;start_offset&quot;</span><span style="color:#E1E4E8;"> : </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">&quot;end_offset&quot;</span><span style="color:#E1E4E8;"> : </span><span style="color:#79B8FF;">3</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">&quot;type&quot;</span><span style="color:#E1E4E8;"> : </span><span style="color:#9ECBFF;">&quot;&lt;IDEOGRAPHIC&gt;&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">&quot;position&quot;</span><span style="color:#E1E4E8;"> : </span><span style="color:#79B8FF;">2</span></span>
<span class="line"><span style="color:#E1E4E8;">    },</span></span>
<span class="line"><span style="color:#E1E4E8;">    {</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">&quot;token&quot;</span><span style="color:#E1E4E8;"> : </span><span style="color:#9ECBFF;">&quot;序&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">&quot;start_offset&quot;</span><span style="color:#E1E4E8;"> : </span><span style="color:#79B8FF;">3</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">&quot;end_offset&quot;</span><span style="color:#E1E4E8;"> : </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">&quot;type&quot;</span><span style="color:#E1E4E8;"> : </span><span style="color:#9ECBFF;">&quot;&lt;IDEOGRAPHIC&gt;&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">&quot;position&quot;</span><span style="color:#E1E4E8;"> : </span><span style="color:#79B8FF;">3</span></span>
<span class="line"><span style="color:#E1E4E8;">    },</span></span>
<span class="line"><span style="color:#E1E4E8;">    {</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">&quot;token&quot;</span><span style="color:#E1E4E8;"> : </span><span style="color:#9ECBFF;">&quot;员&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">&quot;start_offset&quot;</span><span style="color:#E1E4E8;"> : </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">&quot;end_offset&quot;</span><span style="color:#E1E4E8;"> : </span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">&quot;type&quot;</span><span style="color:#E1E4E8;"> : </span><span style="color:#9ECBFF;">&quot;&lt;IDEOGRAPHIC&gt;&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">&quot;position&quot;</span><span style="color:#E1E4E8;"> : </span><span style="color:#79B8FF;">4</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">  ]</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#005CC5;">&quot;tokens&quot;</span><span style="color:#24292E;"> : [</span></span>
<span class="line"><span style="color:#24292E;">    {</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#005CC5;">&quot;token&quot;</span><span style="color:#24292E;"> : </span><span style="color:#032F62;">&quot;我&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#005CC5;">&quot;start_offset&quot;</span><span style="color:#24292E;"> : </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#005CC5;">&quot;end_offset&quot;</span><span style="color:#24292E;"> : </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#005CC5;">&quot;type&quot;</span><span style="color:#24292E;"> : </span><span style="color:#032F62;">&quot;&lt;IDEOGRAPHIC&gt;&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#005CC5;">&quot;position&quot;</span><span style="color:#24292E;"> : </span><span style="color:#005CC5;">0</span></span>
<span class="line"><span style="color:#24292E;">    },</span></span>
<span class="line"><span style="color:#24292E;">    {</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#005CC5;">&quot;token&quot;</span><span style="color:#24292E;"> : </span><span style="color:#032F62;">&quot;是&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#005CC5;">&quot;start_offset&quot;</span><span style="color:#24292E;"> : </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#005CC5;">&quot;end_offset&quot;</span><span style="color:#24292E;"> : </span><span style="color:#005CC5;">2</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#005CC5;">&quot;type&quot;</span><span style="color:#24292E;"> : </span><span style="color:#032F62;">&quot;&lt;IDEOGRAPHIC&gt;&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#005CC5;">&quot;position&quot;</span><span style="color:#24292E;"> : </span><span style="color:#005CC5;">1</span></span>
<span class="line"><span style="color:#24292E;">    },</span></span>
<span class="line"><span style="color:#24292E;">    {</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#005CC5;">&quot;token&quot;</span><span style="color:#24292E;"> : </span><span style="color:#032F62;">&quot;程&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#005CC5;">&quot;start_offset&quot;</span><span style="color:#24292E;"> : </span><span style="color:#005CC5;">2</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#005CC5;">&quot;end_offset&quot;</span><span style="color:#24292E;"> : </span><span style="color:#005CC5;">3</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#005CC5;">&quot;type&quot;</span><span style="color:#24292E;"> : </span><span style="color:#032F62;">&quot;&lt;IDEOGRAPHIC&gt;&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#005CC5;">&quot;position&quot;</span><span style="color:#24292E;"> : </span><span style="color:#005CC5;">2</span></span>
<span class="line"><span style="color:#24292E;">    },</span></span>
<span class="line"><span style="color:#24292E;">    {</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#005CC5;">&quot;token&quot;</span><span style="color:#24292E;"> : </span><span style="color:#032F62;">&quot;序&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#005CC5;">&quot;start_offset&quot;</span><span style="color:#24292E;"> : </span><span style="color:#005CC5;">3</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#005CC5;">&quot;end_offset&quot;</span><span style="color:#24292E;"> : </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#005CC5;">&quot;type&quot;</span><span style="color:#24292E;"> : </span><span style="color:#032F62;">&quot;&lt;IDEOGRAPHIC&gt;&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#005CC5;">&quot;position&quot;</span><span style="color:#24292E;"> : </span><span style="color:#005CC5;">3</span></span>
<span class="line"><span style="color:#24292E;">    },</span></span>
<span class="line"><span style="color:#24292E;">    {</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#005CC5;">&quot;token&quot;</span><span style="color:#24292E;"> : </span><span style="color:#032F62;">&quot;员&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#005CC5;">&quot;start_offset&quot;</span><span style="color:#24292E;"> : </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#005CC5;">&quot;end_offset&quot;</span><span style="color:#24292E;"> : </span><span style="color:#005CC5;">5</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#005CC5;">&quot;type&quot;</span><span style="color:#24292E;"> : </span><span style="color:#032F62;">&quot;&lt;IDEOGRAPHIC&gt;&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#005CC5;">&quot;position&quot;</span><span style="color:#24292E;"> : </span><span style="color:#005CC5;">4</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">  ]</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p>而我们需要的分词效果是：我、是、程序、程序员</p><p>这样的话就需要对中文支持良好的分析器的支持，支持中文分词的分词器有很多，word分词器、庖丁解牛、盘古分词、Ansj分词等，但我们常用的还是下面要介绍的IK分词器。</p><h2 id="_5-2-ik分词器简介" tabindex="-1">5.2 IK分词器简介 <a class="header-anchor" href="#_5-2-ik分词器简介" aria-label="Permalink to &quot;5.2 IK分词器简介&quot;">​</a></h2><p>IKAnalyzer是一个开源的，基于java语言开发的轻量级的中文分词工具包。从2006年12月推出1.0版开始，IKAnalyzer已经推出 了3个大版本。最初，它是以开源项目Lucene为应用主体的，结合词典分词和文法分析算法的中文分词组件。新版本的IKAnalyzer3.0则发展为 面向Java的公用分词组件，独立于Lucene项目，同时提供了对Lucene的默认优吧化实现。</p><p>IK分词器3.0的特性如下：</p><p>1）采用了特有的“正向迭代最细粒度切分算法“，具有60万字/秒的高速处理能力。 2）采用了多子处理器分析模式，支持：英文字母（IP地址、Email、URL）、数字（日期，常用中文数量词，罗马数字，科学计数法），中文词汇（姓名、地名处理）等分词处理。 3）对中英联合支持不是很好,在这方面的处理比较麻烦.需再做一次查询,同时是支持个人词条的优化的词典存储，更小的内存占用。 4）支持用户词典扩展定义。 5）针对Lucene全文检索优化的查询分析器IKQueryParser；采用歧义分析算法优化查询关键字的搜索排列组合，能极大的提高Lucene检索的命中率。</p><h2 id="_5-3-elasticsearch集成ik分词器" tabindex="-1">5.3 ElasticSearch集成IK分词器 <a class="header-anchor" href="#_5-3-elasticsearch集成ik分词器" aria-label="Permalink to &quot;5.3 ElasticSearch集成IK分词器&quot;">​</a></h2><p><strong>IK分词器的安装</strong></p><ul><li>下载地址：<a href="https://github.com/medcl/elasticsearch-analysis-ik/releases" target="_blank" rel="noreferrer">https://github.com/medcl/elasticsearch-analysis-ik/releases</a><ul><li>课程资料也提供了IK分词器的压缩包：<code>elasticsearch-analysis-ik-5.6.8.zip</code></li></ul></li><li>解压，将解压后的elasticsearch文件夹拷贝到elasticsearch-5.6.8\\plugins下，并重命名文件夹为analysis-ik</li><li>重新启动ElasticSearch，即可加载IK分词器</li></ul><p><strong>IK分词器测试</strong></p><p>IK提供了两个分词算法ik_smart 和 ik_max_word</p><p>其中 ik_smart 为最少切分，ik_max_word为最细粒度划分</p><p>我们分别来试一下</p><p>1）最小切分：在浏览器地址栏输入地址</p><div class="language-http vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">http</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">http://127.0.0.1:9200/_analyze?analyzer=ik_smart&amp;pretty=true&amp;text=我是程序员</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">http://127.0.0.1:9200/_analyze?analyzer=ik_smart&amp;pretty=true&amp;text=我是程序员</span></span></code></pre></div><p>输出的结果为：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">我 是 程序员</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">我 是 程序员</span></span></code></pre></div><p>2）最细切分：在浏览器地址栏输入地址</p><div class="language-http vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">http</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">http://127.0.0.1:9200/_analyze?analyzer=ik_max_word&amp;pretty=true&amp;text=我是程序员</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">http://127.0.0.1:9200/_analyze?analyzer=ik_max_word&amp;pretty=true&amp;text=我是程序员</span></span></code></pre></div><p>输出的结果为：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">我 是 程序员 程序 员</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">我 是 程序员 程序 员</span></span></code></pre></div><h2 id="_5-4-修改索引映射mapping" tabindex="-1">5.4 修改索引映射mapping <a class="header-anchor" href="#_5-4-修改索引映射mapping" aria-label="Permalink to &quot;5.4 修改索引映射mapping&quot;">​</a></h2><h3 id="_5-4-1-重建索引" tabindex="-1">5.4.1 重建索引 <a class="header-anchor" href="#_5-4-1-重建索引" aria-label="Permalink to &quot;5.4.1 重建索引&quot;">​</a></h3><p>删除原有blog1索引</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">DELETE		localhost:</span><span style="color:#79B8FF;">9200</span><span style="color:#E1E4E8;">/blog</span><span style="color:#79B8FF;">1</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">DELETE		localhost:</span><span style="color:#005CC5;">9200</span><span style="color:#24292E;">/blog</span><span style="color:#005CC5;">1</span></span></code></pre></div><p>创建blog1索引，此时分词器使用ik_max_word</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">PUT		localhost:</span><span style="color:#79B8FF;">9200</span><span style="color:#E1E4E8;">/blog</span><span style="color:#79B8FF;">1</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">PUT		localhost:</span><span style="color:#005CC5;">9200</span><span style="color:#24292E;">/blog</span><span style="color:#005CC5;">1</span></span></code></pre></div><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">&quot;mappings&quot;</span><span style="color:#E1E4E8;">: {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#79B8FF;">&quot;article&quot;</span><span style="color:#E1E4E8;">: {</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#79B8FF;">&quot;properties&quot;</span><span style="color:#E1E4E8;">: {</span></span>
<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#79B8FF;">&quot;id&quot;</span><span style="color:#E1E4E8;">: {</span></span>
<span class="line"><span style="color:#E1E4E8;">                	</span><span style="color:#79B8FF;">&quot;type&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;long&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">                    </span><span style="color:#79B8FF;">&quot;store&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">true</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">                    </span><span style="color:#79B8FF;">&quot;index&quot;</span><span style="color:#E1E4E8;">:</span><span style="color:#9ECBFF;">&quot;not_analyzed&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">                },</span></span>
<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#79B8FF;">&quot;title&quot;</span><span style="color:#E1E4E8;">: {</span></span>
<span class="line"><span style="color:#E1E4E8;">                	</span><span style="color:#79B8FF;">&quot;type&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;text&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">                    </span><span style="color:#79B8FF;">&quot;store&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">true</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">                    </span><span style="color:#79B8FF;">&quot;index&quot;</span><span style="color:#E1E4E8;">:</span><span style="color:#9ECBFF;">&quot;analyzed&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">                    </span><span style="color:#79B8FF;">&quot;analyzer&quot;</span><span style="color:#E1E4E8;">:</span><span style="color:#9ECBFF;">&quot;ik_max_word&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">                },</span></span>
<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#79B8FF;">&quot;content&quot;</span><span style="color:#E1E4E8;">: {</span></span>
<span class="line"><span style="color:#E1E4E8;">                	</span><span style="color:#79B8FF;">&quot;type&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;text&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">                    </span><span style="color:#79B8FF;">&quot;store&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">true</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">                    </span><span style="color:#79B8FF;">&quot;index&quot;</span><span style="color:#E1E4E8;">:</span><span style="color:#9ECBFF;">&quot;analyzed&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">                    </span><span style="color:#79B8FF;">&quot;analyzer&quot;</span><span style="color:#E1E4E8;">:</span><span style="color:#9ECBFF;">&quot;ik_max_word&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">                }</span></span>
<span class="line"><span style="color:#E1E4E8;">            }</span></span>
<span class="line"><span style="color:#E1E4E8;">        }</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">&quot;mappings&quot;</span><span style="color:#24292E;">: {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#005CC5;">&quot;article&quot;</span><span style="color:#24292E;">: {</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#005CC5;">&quot;properties&quot;</span><span style="color:#24292E;">: {</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#005CC5;">&quot;id&quot;</span><span style="color:#24292E;">: {</span></span>
<span class="line"><span style="color:#24292E;">                	</span><span style="color:#005CC5;">&quot;type&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;long&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">                    </span><span style="color:#005CC5;">&quot;store&quot;</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">true</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">                    </span><span style="color:#005CC5;">&quot;index&quot;</span><span style="color:#24292E;">:</span><span style="color:#032F62;">&quot;not_analyzed&quot;</span></span>
<span class="line"><span style="color:#24292E;">                },</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#005CC5;">&quot;title&quot;</span><span style="color:#24292E;">: {</span></span>
<span class="line"><span style="color:#24292E;">                	</span><span style="color:#005CC5;">&quot;type&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;text&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">                    </span><span style="color:#005CC5;">&quot;store&quot;</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">true</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">                    </span><span style="color:#005CC5;">&quot;index&quot;</span><span style="color:#24292E;">:</span><span style="color:#032F62;">&quot;analyzed&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">                    </span><span style="color:#005CC5;">&quot;analyzer&quot;</span><span style="color:#24292E;">:</span><span style="color:#032F62;">&quot;ik_max_word&quot;</span></span>
<span class="line"><span style="color:#24292E;">                },</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#005CC5;">&quot;content&quot;</span><span style="color:#24292E;">: {</span></span>
<span class="line"><span style="color:#24292E;">                	</span><span style="color:#005CC5;">&quot;type&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;text&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">                    </span><span style="color:#005CC5;">&quot;store&quot;</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">true</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">                    </span><span style="color:#005CC5;">&quot;index&quot;</span><span style="color:#24292E;">:</span><span style="color:#032F62;">&quot;analyzed&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">                    </span><span style="color:#005CC5;">&quot;analyzer&quot;</span><span style="color:#24292E;">:</span><span style="color:#032F62;">&quot;ik_max_word&quot;</span></span>
<span class="line"><span style="color:#24292E;">                }</span></span>
<span class="line"><span style="color:#24292E;">            }</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p>创建文档</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">POST	localhost:</span><span style="color:#79B8FF;">9200</span><span style="color:#E1E4E8;">/blog</span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">/article/</span><span style="color:#79B8FF;">1</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">POST	localhost:</span><span style="color:#005CC5;">9200</span><span style="color:#24292E;">/blog</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">/article/</span><span style="color:#005CC5;">1</span></span></code></pre></div><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#79B8FF;">&quot;id&quot;</span><span style="color:#E1E4E8;">:</span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#79B8FF;">&quot;title&quot;</span><span style="color:#E1E4E8;">:</span><span style="color:#9ECBFF;">&quot;ElasticSearch是一个基于Lucene的搜索服务器&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#79B8FF;">&quot;content&quot;</span><span style="color:#E1E4E8;">:</span><span style="color:#9ECBFF;">&quot;它提供了一个分布式多用户能力的全文搜索引擎，基于RESTful web接口。Elasticsearch是用Java开发的，并作为Apache许可条款下的开放源码发布，是当前流行的企业级搜索引擎。设计用于云计算中，能够达到实时搜索，稳定，可靠，快速，安装使用方便。&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#005CC5;">&quot;id&quot;</span><span style="color:#24292E;">:</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#005CC5;">&quot;title&quot;</span><span style="color:#24292E;">:</span><span style="color:#032F62;">&quot;ElasticSearch是一个基于Lucene的搜索服务器&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#005CC5;">&quot;content&quot;</span><span style="color:#24292E;">:</span><span style="color:#032F62;">&quot;它提供了一个分布式多用户能力的全文搜索引擎，基于RESTful web接口。Elasticsearch是用Java开发的，并作为Apache许可条款下的开放源码发布，是当前流行的企业级搜索引擎。设计用于云计算中，能够达到实时搜索，稳定，可靠，快速，安装使用方便。&quot;</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h3 id="_5-4-2-再次测试querystring查询" tabindex="-1">5.4.2 再次测试queryString查询 <a class="header-anchor" href="#_5-4-2-再次测试querystring查询" aria-label="Permalink to &quot;5.4.2 再次测试queryString查询&quot;">​</a></h3><p>请求url：</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">POST	localhost:</span><span style="color:#79B8FF;">9200</span><span style="color:#E1E4E8;">/blog</span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">/article/_search</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">POST	localhost:</span><span style="color:#005CC5;">9200</span><span style="color:#24292E;">/blog</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">/article/_search</span></span></code></pre></div><p>请求体如下，搜出结果1条</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">&quot;query&quot;</span><span style="color:#E1E4E8;">: {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#79B8FF;">&quot;query_string&quot;</span><span style="color:#E1E4E8;">: {</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#79B8FF;">&quot;default_field&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;title&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#79B8FF;">&quot;query&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;搜索服务器&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">        }</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">&quot;query&quot;</span><span style="color:#24292E;">: {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#005CC5;">&quot;query_string&quot;</span><span style="color:#24292E;">: {</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#005CC5;">&quot;default_field&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;title&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#005CC5;">&quot;query&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;搜索服务器&quot;</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p>将请求体搜索字符串修改为&quot;钢索&quot;，再次查询，结果为空</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">&quot;query&quot;</span><span style="color:#E1E4E8;">: {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#79B8FF;">&quot;query_string&quot;</span><span style="color:#E1E4E8;">: {</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#79B8FF;">&quot;default_field&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;title&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#79B8FF;">&quot;query&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;钢索&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">        }</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">&quot;query&quot;</span><span style="color:#24292E;">: {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#005CC5;">&quot;query_string&quot;</span><span style="color:#24292E;">: {</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#005CC5;">&quot;default_field&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;title&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#005CC5;">&quot;query&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;钢索&quot;</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h3 id="_5-4-3-再次测试term测试" tabindex="-1">5.4.3 再次测试term测试 <a class="header-anchor" href="#_5-4-3-再次测试term测试" aria-label="Permalink to &quot;5.4.3 再次测试term测试&quot;">​</a></h3><p>请求url：</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">POST	localhost:</span><span style="color:#79B8FF;">9200</span><span style="color:#E1E4E8;">/blog</span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">/article/_search</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">POST	localhost:</span><span style="color:#005CC5;">9200</span><span style="color:#24292E;">/blog</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">/article/_search</span></span></code></pre></div><p>请求体，查出1条结果</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">&quot;query&quot;</span><span style="color:#E1E4E8;">: {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#79B8FF;">&quot;term&quot;</span><span style="color:#E1E4E8;">: {</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#79B8FF;">&quot;title&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;搜索&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">        }</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">&quot;query&quot;</span><span style="color:#24292E;">: {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#005CC5;">&quot;term&quot;</span><span style="color:#24292E;">: {</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#005CC5;">&quot;title&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;搜索&quot;</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h1 id="第六章-elasticsearch集群" tabindex="-1">第六章 ElasticSearch集群 <a class="header-anchor" href="#第六章-elasticsearch集群" aria-label="Permalink to &quot;第六章 ElasticSearch集群&quot;">​</a></h1><p>​ ES集群是一个 P2P类型(使用 gossip 协议)的分布式系统，除了集群状态管理以外，其他所有的请求都可以发送到集群内任意一台节点上，这个节点可以自己找到需要转发给哪些节点，并且直接跟这些节点通信。所以，从网络架构及服务配置上来说，构建集群所需要的配置极其简单。在 Elasticsearch 2.0 之前，无阻碍的网络下，所有配置了相同 cluster.name 的节点都自动归属到一个集群中。2.0 版本之后，基于安全的考虑避免开发环境过于随便造成的麻烦，从 2.0 版本开始，默认的自动发现方式改为了单播(unicast)方式。配置里提供几台节点的地址，ES 将其视作 gossip router 角色，借以完成集群的发现。由于这只是 ES 内一个很小的功能，所以 gossip router 角色并不需要单独配置，每个 ES 节点都可以担任。所以，采用单播方式的集群，各节点都配置相同的几个节点列表作为 router 即可。</p><p>​ 集群中节点数量没有限制，一般大于等于2个节点就可以看做是集群了。一般处于高性能及高可用方面来考虑一般集群中的节点数量都是3个及3个以上。</p><h2 id="_6-1-集群的相关概念" tabindex="-1">6.1 集群的相关概念 <a class="header-anchor" href="#_6-1-集群的相关概念" aria-label="Permalink to &quot;6.1 集群的相关概念&quot;">​</a></h2><h3 id="_6-1-1-集群-cluster" tabindex="-1">6.1.1 集群 cluster <a class="header-anchor" href="#_6-1-1-集群-cluster" aria-label="Permalink to &quot;6.1.1 集群 cluster&quot;">​</a></h3><p>一个集群就是由一个或多个节点组织在一起，它们共同持有整个的数据，并一起提供索引和搜索功能。一个集群由一个唯一的名字标识，这个名字默认就是“elasticsearch”。这个名字是重要的，因为一个节点只能通过指定某个集群的名字，来加入这个集群</p><h3 id="_6-1-2-节点-node" tabindex="-1">6.1.2 节点 node <a class="header-anchor" href="#_6-1-2-节点-node" aria-label="Permalink to &quot;6.1.2 节点 node&quot;">​</a></h3><p>一个节点是集群中的一个服务器，作为集群的一部分，它存储数据，参与集群的索引和搜索功能。和集群类似，一个节点也是由一个名字来标识的，默认情况下，这个名字是一个随机的漫威漫画角色的名字，这个名字会在启动的时候赋予节点。这个名字对于管理工作来说挺重要的，因为在这个管理过程中，你会去确定网络中的哪些服务器对应于Elasticsearch集群中的哪些节点。</p><p>一个节点可以通过配置集群名称的方式来加入一个指定的集群。默认情况下，每个节点都会被安排加入到一个叫做“elasticsearch”的集群中，这意味着，如果你在你的网络中启动了若干个节点，并假定它们能够相互发现彼此，它们将会自动地形成并加入到一个叫做“elasticsearch”的集群中。</p><p>在一个集群里，只要你想，可以拥有任意多个节点。而且，如果当前你的网络中没有运行任何Elasticsearch节点，这时启动一个节点，会默认创建并加入一个叫做“elasticsearch”的集群。</p><h3 id="_6-1-3-分片和复制-shards-replicas" tabindex="-1">6.1.3 分片和复制 shards&amp;replicas <a class="header-anchor" href="#_6-1-3-分片和复制-shards-replicas" aria-label="Permalink to &quot;6.1.3 分片和复制 shards&amp;replicas&quot;">​</a></h3><p>一个索引可以存储超出单个结点硬件限制的大量数据。比如，一个具有10亿文档的索引占据1TB的磁盘空间，而任一节点都没有这样大的磁盘空间；或者单个节点处理搜索请求，响应太慢。为了解决这个问题，Elasticsearch提供了将索引划分成多份的能力，这些份就叫做分片。当你创建一个索引的时候，你可以指定你想要的分片的数量。每个分片本身也是一个功能完善并且独立的“索引”，这个“索引”可以被放置到集群中的任何节点上。分片很重要，主要有两方面的原因： 1）允许你水平分割/扩展你的内容容量。 2）允许你在分片（潜在地，位于多个节点上）之上进行分布式的、并行的操作，进而提高性能/吞吐量。</p><p>至于一个分片怎样分布，它的文档怎样聚合回搜索请求，是完全由Elasticsearch管理的，对于作为用户的你来说，这些都是透明的。</p><p>在一个网络/云的环境里，失败随时都可能发生，在某个分片/节点不知怎么的就处于离线状态，或者由于任何原因消失了，这种情况下，有一个故障转移机制是非常有用并且是强烈推荐的。为此目的，Elasticsearch允许你创建分片的一份或多份拷贝，这些拷贝叫做复制分片，或者直接叫复制。</p><p>复制之所以重要，有两个主要原因： 在分片/节点失败的情况下，提供了高可用性。因为这个原因，注意到复制分片从不与原/主要（original/primary）分片置于同一节点上是非常重要的。扩展你的搜索量/吞吐量，因为搜索可以在所有的复制上并行运行。总之，每个索引可以被分成多个分片。一个索引也可以被复制0次（意思是没有复制）或多次。一旦复制了，每个索引就有了主分片（作为复制源的原来的分片）和复制分片（主分片的拷贝）之别。分片和复制的数量可以在索引创建的时候指定。在索引创建之后，你可以在任何时候动态地改变复制的数量，但是你事后不能改变分片的数量。</p><p>默认情况下，Elasticsearch中的每个索引被分片5个主分片和5个复制分片，这意味着，如果你的集群中至少有两个节点，你的索引将会有5个主分片和另外5个复制分片，这样的话每个索引总共就有10个分片。</p><h2 id="_6-2-集群的搭建" tabindex="-1">6.2 集群的搭建 <a class="header-anchor" href="#_6-2-集群的搭建" aria-label="Permalink to &quot;6.2 集群的搭建&quot;">​</a></h2><h3 id="_6-2-1-准备三台elasticsearch服务器" tabindex="-1">6.2.1 准备三台elasticsearch服务器 <a class="header-anchor" href="#_6-2-1-准备三台elasticsearch服务器" aria-label="Permalink to &quot;6.2.1 准备三台elasticsearch服务器&quot;">​</a></h3><p>创建elasticsearch-cluster文件夹，在内部复制三个elasticsearch服务</p><ul><li>如果用现有的es安装文件，需要删除其下的data文件夹</li></ul><h3 id="_6-2-2-修改每台服务器配置" tabindex="-1">6.2.2 修改每台服务器配置 <a class="header-anchor" href="#_6-2-2-修改每台服务器配置" aria-label="Permalink to &quot;6.2.2 修改每台服务器配置&quot;">​</a></h3><p>修改elasticsearch-cluster\\node*\\config\\elasticsearch.yml配置文件</p><p><strong>node1节点：</strong></p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">#节点1的配置信息：</span></span>
<span class="line"><span style="color:#6A737D;">#集群名称，保证唯一</span></span>
<span class="line"><span style="color:#85E89D;">cluster.name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">my-elasticsearch</span></span>
<span class="line"><span style="color:#6A737D;">#节点名称，必须不一样</span></span>
<span class="line"><span style="color:#85E89D;">node.name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">node-1</span></span>
<span class="line"><span style="color:#6A737D;">#必须为本机的ip地址</span></span>
<span class="line"><span style="color:#85E89D;">network.host</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">127.0.0.1</span></span>
<span class="line"><span style="color:#6A737D;">#服务端口号，在同一机器下必须不一样</span></span>
<span class="line"><span style="color:#85E89D;">http.port</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">9200</span></span>
<span class="line"><span style="color:#6A737D;">#集群间通信端口号，在同一机器下必须不一样</span></span>
<span class="line"><span style="color:#85E89D;">transport.tcp.port</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">9300</span></span>
<span class="line"><span style="color:#6A737D;">#设置集群自动发现机器ip集合</span></span>
<span class="line"><span style="color:#85E89D;">discovery.zen.ping.unicast.hosts</span><span style="color:#E1E4E8;">: [</span><span style="color:#9ECBFF;">&quot;127.0.0.1:9300&quot;</span><span style="color:#E1E4E8;">,</span><span style="color:#9ECBFF;">&quot;127.0.0.1:9301&quot;</span><span style="color:#E1E4E8;">,</span><span style="color:#9ECBFF;">&quot;127.0.0.1:9302&quot;</span><span style="color:#E1E4E8;">]</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">#节点1的配置信息：</span></span>
<span class="line"><span style="color:#6A737D;">#集群名称，保证唯一</span></span>
<span class="line"><span style="color:#22863A;">cluster.name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">my-elasticsearch</span></span>
<span class="line"><span style="color:#6A737D;">#节点名称，必须不一样</span></span>
<span class="line"><span style="color:#22863A;">node.name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">node-1</span></span>
<span class="line"><span style="color:#6A737D;">#必须为本机的ip地址</span></span>
<span class="line"><span style="color:#22863A;">network.host</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">127.0.0.1</span></span>
<span class="line"><span style="color:#6A737D;">#服务端口号，在同一机器下必须不一样</span></span>
<span class="line"><span style="color:#22863A;">http.port</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">9200</span></span>
<span class="line"><span style="color:#6A737D;">#集群间通信端口号，在同一机器下必须不一样</span></span>
<span class="line"><span style="color:#22863A;">transport.tcp.port</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">9300</span></span>
<span class="line"><span style="color:#6A737D;">#设置集群自动发现机器ip集合</span></span>
<span class="line"><span style="color:#22863A;">discovery.zen.ping.unicast.hosts</span><span style="color:#24292E;">: [</span><span style="color:#032F62;">&quot;127.0.0.1:9300&quot;</span><span style="color:#24292E;">,</span><span style="color:#032F62;">&quot;127.0.0.1:9301&quot;</span><span style="color:#24292E;">,</span><span style="color:#032F62;">&quot;127.0.0.1:9302&quot;</span><span style="color:#24292E;">]</span></span></code></pre></div><p><strong>node2节点：</strong></p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">#节点2的配置信息：</span></span>
<span class="line"><span style="color:#6A737D;">#集群名称，保证唯一</span></span>
<span class="line"><span style="color:#85E89D;">cluster.name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">my-elasticsearch</span></span>
<span class="line"><span style="color:#6A737D;">#节点名称，必须不一样</span></span>
<span class="line"><span style="color:#85E89D;">node.name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">node-2</span></span>
<span class="line"><span style="color:#6A737D;">#必须为本机的ip地址</span></span>
<span class="line"><span style="color:#85E89D;">network.host</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">127.0.0.1</span></span>
<span class="line"><span style="color:#6A737D;">#服务端口号，在同一机器下必须不一样</span></span>
<span class="line"><span style="color:#85E89D;">http.port</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">9201</span></span>
<span class="line"><span style="color:#6A737D;">#集群间通信端口号，在同一机器下必须不一样</span></span>
<span class="line"><span style="color:#85E89D;">transport.tcp.port</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">9301</span></span>
<span class="line"><span style="color:#6A737D;">#设置集群自动发现机器ip集合</span></span>
<span class="line"><span style="color:#85E89D;">discovery.zen.ping.unicast.hosts</span><span style="color:#E1E4E8;">: [</span><span style="color:#9ECBFF;">&quot;127.0.0.1:9300&quot;</span><span style="color:#E1E4E8;">,</span><span style="color:#9ECBFF;">&quot;127.0.0.1:9301&quot;</span><span style="color:#E1E4E8;">,</span><span style="color:#9ECBFF;">&quot;127.0.0.1:9302&quot;</span><span style="color:#E1E4E8;">]</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">#节点2的配置信息：</span></span>
<span class="line"><span style="color:#6A737D;">#集群名称，保证唯一</span></span>
<span class="line"><span style="color:#22863A;">cluster.name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">my-elasticsearch</span></span>
<span class="line"><span style="color:#6A737D;">#节点名称，必须不一样</span></span>
<span class="line"><span style="color:#22863A;">node.name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">node-2</span></span>
<span class="line"><span style="color:#6A737D;">#必须为本机的ip地址</span></span>
<span class="line"><span style="color:#22863A;">network.host</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">127.0.0.1</span></span>
<span class="line"><span style="color:#6A737D;">#服务端口号，在同一机器下必须不一样</span></span>
<span class="line"><span style="color:#22863A;">http.port</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">9201</span></span>
<span class="line"><span style="color:#6A737D;">#集群间通信端口号，在同一机器下必须不一样</span></span>
<span class="line"><span style="color:#22863A;">transport.tcp.port</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">9301</span></span>
<span class="line"><span style="color:#6A737D;">#设置集群自动发现机器ip集合</span></span>
<span class="line"><span style="color:#22863A;">discovery.zen.ping.unicast.hosts</span><span style="color:#24292E;">: [</span><span style="color:#032F62;">&quot;127.0.0.1:9300&quot;</span><span style="color:#24292E;">,</span><span style="color:#032F62;">&quot;127.0.0.1:9301&quot;</span><span style="color:#24292E;">,</span><span style="color:#032F62;">&quot;127.0.0.1:9302&quot;</span><span style="color:#24292E;">]</span></span></code></pre></div><p><strong>node3节点：</strong></p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">#节点3的配置信息：</span></span>
<span class="line"><span style="color:#6A737D;">#集群名称，保证唯一</span></span>
<span class="line"><span style="color:#85E89D;">cluster.name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">my-elasticsearch</span></span>
<span class="line"><span style="color:#6A737D;">#节点名称，必须不一样</span></span>
<span class="line"><span style="color:#85E89D;">node.name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">node-3</span></span>
<span class="line"><span style="color:#6A737D;">#必须为本机的ip地址</span></span>
<span class="line"><span style="color:#85E89D;">network.host</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">127.0.0.1</span></span>
<span class="line"><span style="color:#6A737D;">#服务端口号，在同一机器下必须不一样</span></span>
<span class="line"><span style="color:#85E89D;">http.port</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">9202</span></span>
<span class="line"><span style="color:#6A737D;">#集群间通信端口号，在同一机器下必须不一样</span></span>
<span class="line"><span style="color:#85E89D;">transport.tcp.port</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">9302</span></span>
<span class="line"><span style="color:#6A737D;">#设置集群自动发现机器ip集合</span></span>
<span class="line"><span style="color:#85E89D;">discovery.zen.ping.unicast.hosts</span><span style="color:#E1E4E8;">: [</span><span style="color:#9ECBFF;">&quot;127.0.0.1:9300&quot;</span><span style="color:#E1E4E8;">,</span><span style="color:#9ECBFF;">&quot;127.0.0.1:9301&quot;</span><span style="color:#E1E4E8;">,</span><span style="color:#9ECBFF;">&quot;127.0.0.1:9302&quot;</span><span style="color:#E1E4E8;">]</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">#节点3的配置信息：</span></span>
<span class="line"><span style="color:#6A737D;">#集群名称，保证唯一</span></span>
<span class="line"><span style="color:#22863A;">cluster.name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">my-elasticsearch</span></span>
<span class="line"><span style="color:#6A737D;">#节点名称，必须不一样</span></span>
<span class="line"><span style="color:#22863A;">node.name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">node-3</span></span>
<span class="line"><span style="color:#6A737D;">#必须为本机的ip地址</span></span>
<span class="line"><span style="color:#22863A;">network.host</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">127.0.0.1</span></span>
<span class="line"><span style="color:#6A737D;">#服务端口号，在同一机器下必须不一样</span></span>
<span class="line"><span style="color:#22863A;">http.port</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">9202</span></span>
<span class="line"><span style="color:#6A737D;">#集群间通信端口号，在同一机器下必须不一样</span></span>
<span class="line"><span style="color:#22863A;">transport.tcp.port</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">9302</span></span>
<span class="line"><span style="color:#6A737D;">#设置集群自动发现机器ip集合</span></span>
<span class="line"><span style="color:#22863A;">discovery.zen.ping.unicast.hosts</span><span style="color:#24292E;">: [</span><span style="color:#032F62;">&quot;127.0.0.1:9300&quot;</span><span style="color:#24292E;">,</span><span style="color:#032F62;">&quot;127.0.0.1:9301&quot;</span><span style="color:#24292E;">,</span><span style="color:#032F62;">&quot;127.0.0.1:9302&quot;</span><span style="color:#24292E;">]</span></span></code></pre></div><h3 id="_6-2-3-启动各个节点服务器" tabindex="-1">6.2.3 启动各个节点服务器 <a class="header-anchor" href="#_6-2-3-启动各个节点服务器" aria-label="Permalink to &quot;6.2.3 启动各个节点服务器&quot;">​</a></h3><p>双击elasticsearch-cluster\\node*\\bin\\elasticsearch.bat</p><h3 id="_6-2-4-集群测试" tabindex="-1">6.2.4 集群测试 <a class="header-anchor" href="#_6-2-4-集群测试" aria-label="Permalink to &quot;6.2.4 集群测试&quot;">​</a></h3><p><strong>添加索引和映射</strong></p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">PUT		localhost:</span><span style="color:#79B8FF;">9200</span><span style="color:#E1E4E8;">/blog</span><span style="color:#79B8FF;">1</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">PUT		localhost:</span><span style="color:#005CC5;">9200</span><span style="color:#24292E;">/blog</span><span style="color:#005CC5;">1</span></span></code></pre></div><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">&quot;mappings&quot;</span><span style="color:#E1E4E8;">: {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#79B8FF;">&quot;article&quot;</span><span style="color:#E1E4E8;">: {</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#79B8FF;">&quot;properties&quot;</span><span style="color:#E1E4E8;">: {</span></span>
<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#79B8FF;">&quot;id&quot;</span><span style="color:#E1E4E8;">: {</span></span>
<span class="line"><span style="color:#E1E4E8;">                	</span><span style="color:#79B8FF;">&quot;type&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;long&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">                    </span><span style="color:#79B8FF;">&quot;store&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">true</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">                    </span><span style="color:#79B8FF;">&quot;index&quot;</span><span style="color:#E1E4E8;">:</span><span style="color:#9ECBFF;">&quot;not_analyzed&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">                },</span></span>
<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#79B8FF;">&quot;title&quot;</span><span style="color:#E1E4E8;">: {</span></span>
<span class="line"><span style="color:#E1E4E8;">                	</span><span style="color:#79B8FF;">&quot;type&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;text&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">                    </span><span style="color:#79B8FF;">&quot;store&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">true</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">                    </span><span style="color:#79B8FF;">&quot;index&quot;</span><span style="color:#E1E4E8;">:</span><span style="color:#9ECBFF;">&quot;analyzed&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">                    </span><span style="color:#79B8FF;">&quot;analyzer&quot;</span><span style="color:#E1E4E8;">:</span><span style="color:#9ECBFF;">&quot;standard&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">                },</span></span>
<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#79B8FF;">&quot;content&quot;</span><span style="color:#E1E4E8;">: {</span></span>
<span class="line"><span style="color:#E1E4E8;">                	</span><span style="color:#79B8FF;">&quot;type&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;text&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">                    </span><span style="color:#79B8FF;">&quot;store&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">true</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">                    </span><span style="color:#79B8FF;">&quot;index&quot;</span><span style="color:#E1E4E8;">:</span><span style="color:#9ECBFF;">&quot;analyzed&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">                    </span><span style="color:#79B8FF;">&quot;analyzer&quot;</span><span style="color:#E1E4E8;">:</span><span style="color:#9ECBFF;">&quot;standard&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">                }</span></span>
<span class="line"><span style="color:#E1E4E8;">            }</span></span>
<span class="line"><span style="color:#E1E4E8;">        }</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">&quot;mappings&quot;</span><span style="color:#24292E;">: {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#005CC5;">&quot;article&quot;</span><span style="color:#24292E;">: {</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#005CC5;">&quot;properties&quot;</span><span style="color:#24292E;">: {</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#005CC5;">&quot;id&quot;</span><span style="color:#24292E;">: {</span></span>
<span class="line"><span style="color:#24292E;">                	</span><span style="color:#005CC5;">&quot;type&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;long&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">                    </span><span style="color:#005CC5;">&quot;store&quot;</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">true</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">                    </span><span style="color:#005CC5;">&quot;index&quot;</span><span style="color:#24292E;">:</span><span style="color:#032F62;">&quot;not_analyzed&quot;</span></span>
<span class="line"><span style="color:#24292E;">                },</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#005CC5;">&quot;title&quot;</span><span style="color:#24292E;">: {</span></span>
<span class="line"><span style="color:#24292E;">                	</span><span style="color:#005CC5;">&quot;type&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;text&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">                    </span><span style="color:#005CC5;">&quot;store&quot;</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">true</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">                    </span><span style="color:#005CC5;">&quot;index&quot;</span><span style="color:#24292E;">:</span><span style="color:#032F62;">&quot;analyzed&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">                    </span><span style="color:#005CC5;">&quot;analyzer&quot;</span><span style="color:#24292E;">:</span><span style="color:#032F62;">&quot;standard&quot;</span></span>
<span class="line"><span style="color:#24292E;">                },</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#005CC5;">&quot;content&quot;</span><span style="color:#24292E;">: {</span></span>
<span class="line"><span style="color:#24292E;">                	</span><span style="color:#005CC5;">&quot;type&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;text&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">                    </span><span style="color:#005CC5;">&quot;store&quot;</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">true</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">                    </span><span style="color:#005CC5;">&quot;index&quot;</span><span style="color:#24292E;">:</span><span style="color:#032F62;">&quot;analyzed&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">                    </span><span style="color:#005CC5;">&quot;analyzer&quot;</span><span style="color:#24292E;">:</span><span style="color:#032F62;">&quot;standard&quot;</span></span>
<span class="line"><span style="color:#24292E;">                }</span></span>
<span class="line"><span style="color:#24292E;">            }</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p><strong>添加文档</strong></p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">POST	localhost:</span><span style="color:#79B8FF;">9200</span><span style="color:#E1E4E8;">/blog</span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">/article/</span><span style="color:#79B8FF;">1</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">POST	localhost:</span><span style="color:#005CC5;">9200</span><span style="color:#24292E;">/blog</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">/article/</span><span style="color:#005CC5;">1</span></span></code></pre></div><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#79B8FF;">&quot;id&quot;</span><span style="color:#E1E4E8;">:</span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#79B8FF;">&quot;title&quot;</span><span style="color:#E1E4E8;">:</span><span style="color:#9ECBFF;">&quot;ElasticSearch是一个基于Lucene的搜索服务器&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#79B8FF;">&quot;content&quot;</span><span style="color:#E1E4E8;">:</span><span style="color:#9ECBFF;">&quot;它提供了一个分布式多用户能力的全文搜索引擎，基于RESTful web接口。Elasticsearch是用Java开发的，并作为Apache许可条款下的开放源码发布，是当前流行的企业级搜索引擎。设计用于云计算中，能够达到实时搜索，稳定，可靠，快速，安装使用方便。&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#005CC5;">&quot;id&quot;</span><span style="color:#24292E;">:</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#005CC5;">&quot;title&quot;</span><span style="color:#24292E;">:</span><span style="color:#032F62;">&quot;ElasticSearch是一个基于Lucene的搜索服务器&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#005CC5;">&quot;content&quot;</span><span style="color:#24292E;">:</span><span style="color:#032F62;">&quot;它提供了一个分布式多用户能力的全文搜索引擎，基于RESTful web接口。Elasticsearch是用Java开发的，并作为Apache许可条款下的开放源码发布，是当前流行的企业级搜索引擎。设计用于云计算中，能够达到实时搜索，稳定，可靠，快速，安装使用方便。&quot;</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p><strong>浏览器打开elasticsearch-head</strong>，可以进行查看和搜索等。</p><h1 id="第七章-java操作es" tabindex="-1">第七章 Java操作ES <a class="header-anchor" href="#第七章-java操作es" aria-label="Permalink to &quot;第七章 Java操作ES&quot;">​</a></h1><h2 id="_7-1-创建工程-导入坐标" tabindex="-1">7.1 创建工程，导入坐标 <a class="header-anchor" href="#_7-1-创建工程-导入坐标" aria-label="Permalink to &quot;7.1 创建工程，导入坐标&quot;">​</a></h2><p>pom.xml坐标</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">&lt;</span><span style="color:#85E89D;">properties</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">    &lt;</span><span style="color:#85E89D;">maven.compiler.source</span><span style="color:#E1E4E8;">&gt;1.8&lt;/</span><span style="color:#85E89D;">maven.compiler.source</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">    &lt;</span><span style="color:#85E89D;">maven.compiler.target</span><span style="color:#E1E4E8;">&gt;1.8&lt;/</span><span style="color:#85E89D;">maven.compiler.target</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">&lt;/</span><span style="color:#85E89D;">properties</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">&lt;</span><span style="color:#85E89D;">dependencies</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">    &lt;</span><span style="color:#85E89D;">dependency</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">        &lt;</span><span style="color:#85E89D;">groupId</span><span style="color:#E1E4E8;">&gt;org.elasticsearch&lt;/</span><span style="color:#85E89D;">groupId</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">        &lt;</span><span style="color:#85E89D;">artifactId</span><span style="color:#E1E4E8;">&gt;elasticsearch&lt;/</span><span style="color:#85E89D;">artifactId</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">        &lt;</span><span style="color:#85E89D;">version</span><span style="color:#E1E4E8;">&gt;5.6.8&lt;/</span><span style="color:#85E89D;">version</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">    &lt;/</span><span style="color:#85E89D;">dependency</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">    &lt;</span><span style="color:#85E89D;">dependency</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">        &lt;</span><span style="color:#85E89D;">groupId</span><span style="color:#E1E4E8;">&gt;org.elasticsearch.client&lt;/</span><span style="color:#85E89D;">groupId</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">        &lt;</span><span style="color:#85E89D;">artifactId</span><span style="color:#E1E4E8;">&gt;transport&lt;/</span><span style="color:#85E89D;">artifactId</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">        &lt;</span><span style="color:#85E89D;">version</span><span style="color:#E1E4E8;">&gt;5.6.8&lt;/</span><span style="color:#85E89D;">version</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">    &lt;/</span><span style="color:#85E89D;">dependency</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">    &lt;</span><span style="color:#85E89D;">dependency</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">        &lt;</span><span style="color:#85E89D;">groupId</span><span style="color:#E1E4E8;">&gt;org.apache.logging.log4j&lt;/</span><span style="color:#85E89D;">groupId</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">        &lt;</span><span style="color:#85E89D;">artifactId</span><span style="color:#E1E4E8;">&gt;log4j-to-slf4j&lt;/</span><span style="color:#85E89D;">artifactId</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">        &lt;</span><span style="color:#85E89D;">version</span><span style="color:#E1E4E8;">&gt;2.9.1&lt;/</span><span style="color:#85E89D;">version</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">    &lt;/</span><span style="color:#85E89D;">dependency</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">    &lt;</span><span style="color:#85E89D;">dependency</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">        &lt;</span><span style="color:#85E89D;">groupId</span><span style="color:#E1E4E8;">&gt;org.slf4j&lt;/</span><span style="color:#85E89D;">groupId</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">        &lt;</span><span style="color:#85E89D;">artifactId</span><span style="color:#E1E4E8;">&gt;slf4j-api&lt;/</span><span style="color:#85E89D;">artifactId</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">        &lt;</span><span style="color:#85E89D;">version</span><span style="color:#E1E4E8;">&gt;1.7.24&lt;/</span><span style="color:#85E89D;">version</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">    &lt;/</span><span style="color:#85E89D;">dependency</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">    &lt;</span><span style="color:#85E89D;">dependency</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">        &lt;</span><span style="color:#85E89D;">groupId</span><span style="color:#E1E4E8;">&gt;org.slf4j&lt;/</span><span style="color:#85E89D;">groupId</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">        &lt;</span><span style="color:#85E89D;">artifactId</span><span style="color:#E1E4E8;">&gt;slf4j-simple&lt;/</span><span style="color:#85E89D;">artifactId</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">        &lt;</span><span style="color:#85E89D;">version</span><span style="color:#E1E4E8;">&gt;1.7.21&lt;/</span><span style="color:#85E89D;">version</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">    &lt;/</span><span style="color:#85E89D;">dependency</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">    &lt;</span><span style="color:#85E89D;">dependency</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">        &lt;</span><span style="color:#85E89D;">groupId</span><span style="color:#E1E4E8;">&gt;log4j&lt;/</span><span style="color:#85E89D;">groupId</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">        &lt;</span><span style="color:#85E89D;">artifactId</span><span style="color:#E1E4E8;">&gt;log4j&lt;/</span><span style="color:#85E89D;">artifactId</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">        &lt;</span><span style="color:#85E89D;">version</span><span style="color:#E1E4E8;">&gt;1.2.12&lt;/</span><span style="color:#85E89D;">version</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">    &lt;/</span><span style="color:#85E89D;">dependency</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">    &lt;</span><span style="color:#85E89D;">dependency</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">        &lt;</span><span style="color:#85E89D;">groupId</span><span style="color:#E1E4E8;">&gt;junit&lt;/</span><span style="color:#85E89D;">groupId</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">        &lt;</span><span style="color:#85E89D;">artifactId</span><span style="color:#E1E4E8;">&gt;junit&lt;/</span><span style="color:#85E89D;">artifactId</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">        &lt;</span><span style="color:#85E89D;">version</span><span style="color:#E1E4E8;">&gt;4.12&lt;/</span><span style="color:#85E89D;">version</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">    &lt;/</span><span style="color:#85E89D;">dependency</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">&lt;/</span><span style="color:#85E89D;">dependencies</span><span style="color:#E1E4E8;">&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">properties</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    &lt;</span><span style="color:#22863A;">maven.compiler.source</span><span style="color:#24292E;">&gt;1.8&lt;/</span><span style="color:#22863A;">maven.compiler.source</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    &lt;</span><span style="color:#22863A;">maven.compiler.target</span><span style="color:#24292E;">&gt;1.8&lt;/</span><span style="color:#22863A;">maven.compiler.target</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">&lt;/</span><span style="color:#22863A;">properties</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">dependencies</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    &lt;</span><span style="color:#22863A;">dependency</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">        &lt;</span><span style="color:#22863A;">groupId</span><span style="color:#24292E;">&gt;org.elasticsearch&lt;/</span><span style="color:#22863A;">groupId</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">        &lt;</span><span style="color:#22863A;">artifactId</span><span style="color:#24292E;">&gt;elasticsearch&lt;/</span><span style="color:#22863A;">artifactId</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">        &lt;</span><span style="color:#22863A;">version</span><span style="color:#24292E;">&gt;5.6.8&lt;/</span><span style="color:#22863A;">version</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    &lt;/</span><span style="color:#22863A;">dependency</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    &lt;</span><span style="color:#22863A;">dependency</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">        &lt;</span><span style="color:#22863A;">groupId</span><span style="color:#24292E;">&gt;org.elasticsearch.client&lt;/</span><span style="color:#22863A;">groupId</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">        &lt;</span><span style="color:#22863A;">artifactId</span><span style="color:#24292E;">&gt;transport&lt;/</span><span style="color:#22863A;">artifactId</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">        &lt;</span><span style="color:#22863A;">version</span><span style="color:#24292E;">&gt;5.6.8&lt;/</span><span style="color:#22863A;">version</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    &lt;/</span><span style="color:#22863A;">dependency</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    &lt;</span><span style="color:#22863A;">dependency</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">        &lt;</span><span style="color:#22863A;">groupId</span><span style="color:#24292E;">&gt;org.apache.logging.log4j&lt;/</span><span style="color:#22863A;">groupId</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">        &lt;</span><span style="color:#22863A;">artifactId</span><span style="color:#24292E;">&gt;log4j-to-slf4j&lt;/</span><span style="color:#22863A;">artifactId</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">        &lt;</span><span style="color:#22863A;">version</span><span style="color:#24292E;">&gt;2.9.1&lt;/</span><span style="color:#22863A;">version</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    &lt;/</span><span style="color:#22863A;">dependency</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    &lt;</span><span style="color:#22863A;">dependency</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">        &lt;</span><span style="color:#22863A;">groupId</span><span style="color:#24292E;">&gt;org.slf4j&lt;/</span><span style="color:#22863A;">groupId</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">        &lt;</span><span style="color:#22863A;">artifactId</span><span style="color:#24292E;">&gt;slf4j-api&lt;/</span><span style="color:#22863A;">artifactId</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">        &lt;</span><span style="color:#22863A;">version</span><span style="color:#24292E;">&gt;1.7.24&lt;/</span><span style="color:#22863A;">version</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    &lt;/</span><span style="color:#22863A;">dependency</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    &lt;</span><span style="color:#22863A;">dependency</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">        &lt;</span><span style="color:#22863A;">groupId</span><span style="color:#24292E;">&gt;org.slf4j&lt;/</span><span style="color:#22863A;">groupId</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">        &lt;</span><span style="color:#22863A;">artifactId</span><span style="color:#24292E;">&gt;slf4j-simple&lt;/</span><span style="color:#22863A;">artifactId</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">        &lt;</span><span style="color:#22863A;">version</span><span style="color:#24292E;">&gt;1.7.21&lt;/</span><span style="color:#22863A;">version</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    &lt;/</span><span style="color:#22863A;">dependency</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    &lt;</span><span style="color:#22863A;">dependency</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">        &lt;</span><span style="color:#22863A;">groupId</span><span style="color:#24292E;">&gt;log4j&lt;/</span><span style="color:#22863A;">groupId</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">        &lt;</span><span style="color:#22863A;">artifactId</span><span style="color:#24292E;">&gt;log4j&lt;/</span><span style="color:#22863A;">artifactId</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">        &lt;</span><span style="color:#22863A;">version</span><span style="color:#24292E;">&gt;1.2.12&lt;/</span><span style="color:#22863A;">version</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    &lt;/</span><span style="color:#22863A;">dependency</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    &lt;</span><span style="color:#22863A;">dependency</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">        &lt;</span><span style="color:#22863A;">groupId</span><span style="color:#24292E;">&gt;junit&lt;/</span><span style="color:#22863A;">groupId</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">        &lt;</span><span style="color:#22863A;">artifactId</span><span style="color:#24292E;">&gt;junit&lt;/</span><span style="color:#22863A;">artifactId</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">        &lt;</span><span style="color:#22863A;">version</span><span style="color:#24292E;">&gt;4.12&lt;/</span><span style="color:#22863A;">version</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    &lt;/</span><span style="color:#22863A;">dependency</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">&lt;/</span><span style="color:#22863A;">dependencies</span><span style="color:#24292E;">&gt;</span></span></code></pre></div><h2 id="_7-2-创建索引index" tabindex="-1">7.2 创建索引index <a class="header-anchor" href="#_7-2-创建索引index" aria-label="Permalink to &quot;7.2 创建索引index&quot;">​</a></h2><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">@</span><span style="color:#F97583;">Test</span></span>
<span class="line"><span style="color:#6A737D;">//创建索引</span></span>
<span class="line"><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">test1</span><span style="color:#E1E4E8;">() throws Exception{</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// 创建Client连接对象</span></span>
<span class="line"><span style="color:#E1E4E8;">    Settings settings </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> Settings.</span><span style="color:#B392F0;">builder</span><span style="color:#E1E4E8;">().</span><span style="color:#B392F0;">put</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;cluster.name&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;my-elasticsearch&quot;</span><span style="color:#E1E4E8;">).</span><span style="color:#B392F0;">build</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">    TransportClient client </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">PreBuiltTransportClient</span><span style="color:#E1E4E8;">(settings)</span></span>
<span class="line"><span style="color:#E1E4E8;">        .</span><span style="color:#B392F0;">addTransportAddress</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">InetSocketTransportAddress</span><span style="color:#E1E4E8;">(InetAddress.</span><span style="color:#B392F0;">getByName</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;127.0.0.1&quot;</span><span style="color:#E1E4E8;">), </span><span style="color:#79B8FF;">9300</span><span style="color:#E1E4E8;">));</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//创建名称为blog2的索引</span></span>
<span class="line"><span style="color:#E1E4E8;">    client.</span><span style="color:#B392F0;">admin</span><span style="color:#E1E4E8;">().</span><span style="color:#B392F0;">indices</span><span style="color:#E1E4E8;">().</span><span style="color:#B392F0;">prepareCreate</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;blog2&quot;</span><span style="color:#E1E4E8;">).</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//释放资源</span></span>
<span class="line"><span style="color:#E1E4E8;">    client.</span><span style="color:#B392F0;">close</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Test</span></span>
<span class="line"><span style="color:#6A737D;">//创建索引</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">test1</span><span style="color:#24292E;">() throws Exception{</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// 创建Client连接对象</span></span>
<span class="line"><span style="color:#24292E;">    Settings settings </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> Settings.</span><span style="color:#6F42C1;">builder</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">put</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;cluster.name&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;my-elasticsearch&quot;</span><span style="color:#24292E;">).</span><span style="color:#6F42C1;">build</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">    TransportClient client </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">PreBuiltTransportClient</span><span style="color:#24292E;">(settings)</span></span>
<span class="line"><span style="color:#24292E;">        .</span><span style="color:#6F42C1;">addTransportAddress</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">InetSocketTransportAddress</span><span style="color:#24292E;">(InetAddress.</span><span style="color:#6F42C1;">getByName</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;127.0.0.1&quot;</span><span style="color:#24292E;">), </span><span style="color:#005CC5;">9300</span><span style="color:#24292E;">));</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//创建名称为blog2的索引</span></span>
<span class="line"><span style="color:#24292E;">    client.</span><span style="color:#6F42C1;">admin</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">indices</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">prepareCreate</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;blog2&quot;</span><span style="color:#24292E;">).</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//释放资源</span></span>
<span class="line"><span style="color:#24292E;">    client.</span><span style="color:#6F42C1;">close</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h2 id="_7-3-创建映射mapping" tabindex="-1">7.3 创建映射mapping <a class="header-anchor" href="#_7-3-创建映射mapping" aria-label="Permalink to &quot;7.3 创建映射mapping&quot;">​</a></h2><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">@</span><span style="color:#F97583;">Test</span></span>
<span class="line"><span style="color:#6A737D;">//创建映射</span></span>
<span class="line"><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">test3</span><span style="color:#E1E4E8;">() throws Exception{</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// 创建Client连接对象</span></span>
<span class="line"><span style="color:#E1E4E8;">    Settings settings </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> Settings.</span><span style="color:#B392F0;">builder</span><span style="color:#E1E4E8;">().</span><span style="color:#B392F0;">put</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;cluster.name&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;my-elasticsearch&quot;</span><span style="color:#E1E4E8;">).</span><span style="color:#B392F0;">build</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">    TransportClient client </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">PreBuiltTransportClient</span><span style="color:#E1E4E8;">(settings)</span></span>
<span class="line"><span style="color:#E1E4E8;">        .</span><span style="color:#B392F0;">addTransportAddress</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">InetSocketTransportAddress</span><span style="color:#E1E4E8;">(InetAddress.</span><span style="color:#B392F0;">getByName</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;127.0.0.1&quot;</span><span style="color:#E1E4E8;">), </span><span style="color:#79B8FF;">9300</span><span style="color:#E1E4E8;">));</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// 添加映射</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">/**</span></span>
<span class="line"><span style="color:#6A737D;">         * 格式：</span></span>
<span class="line"><span style="color:#6A737D;">         * &quot;mappings&quot; : {</span></span>
<span class="line"><span style="color:#6A737D;">             &quot;article&quot; : {</span></span>
<span class="line"><span style="color:#6A737D;">                &quot;dynamic&quot; : &quot;false&quot;,</span></span>
<span class="line"><span style="color:#6A737D;">                 &quot;properties&quot; : {</span></span>
<span class="line"><span style="color:#6A737D;">                    &quot;id&quot; : { &quot;type&quot; : &quot;string&quot; },</span></span>
<span class="line"><span style="color:#6A737D;">                    &quot;content&quot; : { &quot;type&quot; : &quot;string&quot; },</span></span>
<span class="line"><span style="color:#6A737D;">                    &quot;author&quot; : { &quot;type&quot; : &quot;string&quot; }</span></span>
<span class="line"><span style="color:#6A737D;">                 }</span></span>
<span class="line"><span style="color:#6A737D;">            }</span></span>
<span class="line"><span style="color:#6A737D;">         }</span></span>
<span class="line"><span style="color:#6A737D;">         */</span></span>
<span class="line"><span style="color:#E1E4E8;">    XContentBuilder builder </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> XContentFactory.</span><span style="color:#B392F0;">jsonBuilder</span><span style="color:#E1E4E8;">()</span></span>
<span class="line"><span style="color:#E1E4E8;">        .</span><span style="color:#B392F0;">startObject</span><span style="color:#E1E4E8;">()</span></span>
<span class="line"><span style="color:#E1E4E8;">        .</span><span style="color:#B392F0;">startObject</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;article&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">        .</span><span style="color:#B392F0;">startObject</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;properties&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">        .</span><span style="color:#B392F0;">startObject</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;id&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">        .</span><span style="color:#B392F0;">field</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;type&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;integer&quot;</span><span style="color:#E1E4E8;">).</span><span style="color:#B392F0;">field</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;store&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;yes&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">        .</span><span style="color:#B392F0;">endObject</span><span style="color:#E1E4E8;">()</span></span>
<span class="line"><span style="color:#E1E4E8;">        .</span><span style="color:#B392F0;">startObject</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;title&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">        .</span><span style="color:#B392F0;">field</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;type&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;string&quot;</span><span style="color:#E1E4E8;">).</span><span style="color:#B392F0;">field</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;store&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;yes&quot;</span><span style="color:#E1E4E8;">).</span><span style="color:#B392F0;">field</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;analyzer&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;ik_smart&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">        .</span><span style="color:#B392F0;">endObject</span><span style="color:#E1E4E8;">()</span></span>
<span class="line"><span style="color:#E1E4E8;">        .</span><span style="color:#B392F0;">startObject</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;content&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">        .</span><span style="color:#B392F0;">field</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;type&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;string&quot;</span><span style="color:#E1E4E8;">).</span><span style="color:#B392F0;">field</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;store&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;yes&quot;</span><span style="color:#E1E4E8;">).</span><span style="color:#B392F0;">field</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;analyzer&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;ik_smart&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">        .</span><span style="color:#B392F0;">endObject</span><span style="color:#E1E4E8;">()</span></span>
<span class="line"><span style="color:#E1E4E8;">        .</span><span style="color:#B392F0;">endObject</span><span style="color:#E1E4E8;">()</span></span>
<span class="line"><span style="color:#E1E4E8;">        .</span><span style="color:#B392F0;">endObject</span><span style="color:#E1E4E8;">()</span></span>
<span class="line"><span style="color:#E1E4E8;">        .</span><span style="color:#B392F0;">endObject</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// 创建映射 第一种方式</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// PutMappingRequest mapping = Requests.putMappingRequest(&quot;blog2&quot;)</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//    .type(&quot;article&quot;).source(builder);</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// client.admin().indices().putMapping(mapping).get();</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// 创建映射 第二种方式</span></span>
<span class="line"><span style="color:#E1E4E8;">    client.</span><span style="color:#B392F0;">admin</span><span style="color:#E1E4E8;">().</span><span style="color:#B392F0;">indices</span><span style="color:#E1E4E8;">().</span><span style="color:#B392F0;">preparePutMapping</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;blog2&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">        					.</span><span style="color:#B392F0;">setType</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;article&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">        					.</span><span style="color:#B392F0;">setSource</span><span style="color:#E1E4E8;">(builder)</span></span>
<span class="line"><span style="color:#E1E4E8;">        					.</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// 释放资源</span></span>
<span class="line"><span style="color:#E1E4E8;">    client.</span><span style="color:#B392F0;">close</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Test</span></span>
<span class="line"><span style="color:#6A737D;">//创建映射</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">test3</span><span style="color:#24292E;">() throws Exception{</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// 创建Client连接对象</span></span>
<span class="line"><span style="color:#24292E;">    Settings settings </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> Settings.</span><span style="color:#6F42C1;">builder</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">put</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;cluster.name&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;my-elasticsearch&quot;</span><span style="color:#24292E;">).</span><span style="color:#6F42C1;">build</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">    TransportClient client </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">PreBuiltTransportClient</span><span style="color:#24292E;">(settings)</span></span>
<span class="line"><span style="color:#24292E;">        .</span><span style="color:#6F42C1;">addTransportAddress</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">InetSocketTransportAddress</span><span style="color:#24292E;">(InetAddress.</span><span style="color:#6F42C1;">getByName</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;127.0.0.1&quot;</span><span style="color:#24292E;">), </span><span style="color:#005CC5;">9300</span><span style="color:#24292E;">));</span></span>
<span class="line"><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// 添加映射</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">/**</span></span>
<span class="line"><span style="color:#6A737D;">         * 格式：</span></span>
<span class="line"><span style="color:#6A737D;">         * &quot;mappings&quot; : {</span></span>
<span class="line"><span style="color:#6A737D;">             &quot;article&quot; : {</span></span>
<span class="line"><span style="color:#6A737D;">                &quot;dynamic&quot; : &quot;false&quot;,</span></span>
<span class="line"><span style="color:#6A737D;">                 &quot;properties&quot; : {</span></span>
<span class="line"><span style="color:#6A737D;">                    &quot;id&quot; : { &quot;type&quot; : &quot;string&quot; },</span></span>
<span class="line"><span style="color:#6A737D;">                    &quot;content&quot; : { &quot;type&quot; : &quot;string&quot; },</span></span>
<span class="line"><span style="color:#6A737D;">                    &quot;author&quot; : { &quot;type&quot; : &quot;string&quot; }</span></span>
<span class="line"><span style="color:#6A737D;">                 }</span></span>
<span class="line"><span style="color:#6A737D;">            }</span></span>
<span class="line"><span style="color:#6A737D;">         }</span></span>
<span class="line"><span style="color:#6A737D;">         */</span></span>
<span class="line"><span style="color:#24292E;">    XContentBuilder builder </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> XContentFactory.</span><span style="color:#6F42C1;">jsonBuilder</span><span style="color:#24292E;">()</span></span>
<span class="line"><span style="color:#24292E;">        .</span><span style="color:#6F42C1;">startObject</span><span style="color:#24292E;">()</span></span>
<span class="line"><span style="color:#24292E;">        .</span><span style="color:#6F42C1;">startObject</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;article&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">        .</span><span style="color:#6F42C1;">startObject</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;properties&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">        .</span><span style="color:#6F42C1;">startObject</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;id&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">        .</span><span style="color:#6F42C1;">field</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;type&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;integer&quot;</span><span style="color:#24292E;">).</span><span style="color:#6F42C1;">field</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;store&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;yes&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">        .</span><span style="color:#6F42C1;">endObject</span><span style="color:#24292E;">()</span></span>
<span class="line"><span style="color:#24292E;">        .</span><span style="color:#6F42C1;">startObject</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;title&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">        .</span><span style="color:#6F42C1;">field</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;type&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;string&quot;</span><span style="color:#24292E;">).</span><span style="color:#6F42C1;">field</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;store&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;yes&quot;</span><span style="color:#24292E;">).</span><span style="color:#6F42C1;">field</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;analyzer&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;ik_smart&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">        .</span><span style="color:#6F42C1;">endObject</span><span style="color:#24292E;">()</span></span>
<span class="line"><span style="color:#24292E;">        .</span><span style="color:#6F42C1;">startObject</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;content&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">        .</span><span style="color:#6F42C1;">field</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;type&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;string&quot;</span><span style="color:#24292E;">).</span><span style="color:#6F42C1;">field</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;store&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;yes&quot;</span><span style="color:#24292E;">).</span><span style="color:#6F42C1;">field</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;analyzer&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;ik_smart&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">        .</span><span style="color:#6F42C1;">endObject</span><span style="color:#24292E;">()</span></span>
<span class="line"><span style="color:#24292E;">        .</span><span style="color:#6F42C1;">endObject</span><span style="color:#24292E;">()</span></span>
<span class="line"><span style="color:#24292E;">        .</span><span style="color:#6F42C1;">endObject</span><span style="color:#24292E;">()</span></span>
<span class="line"><span style="color:#24292E;">        .</span><span style="color:#6F42C1;">endObject</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// 创建映射 第一种方式</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// PutMappingRequest mapping = Requests.putMappingRequest(&quot;blog2&quot;)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//    .type(&quot;article&quot;).source(builder);</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// client.admin().indices().putMapping(mapping).get();</span></span>
<span class="line"><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// 创建映射 第二种方式</span></span>
<span class="line"><span style="color:#24292E;">    client.</span><span style="color:#6F42C1;">admin</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">indices</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">preparePutMapping</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;blog2&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">        					.</span><span style="color:#6F42C1;">setType</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;article&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">        					.</span><span style="color:#6F42C1;">setSource</span><span style="color:#24292E;">(builder)</span></span>
<span class="line"><span style="color:#24292E;">        					.</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// 释放资源</span></span>
<span class="line"><span style="color:#24292E;">    client.</span><span style="color:#6F42C1;">close</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h2 id="_7-4-建立文档document" tabindex="-1">7.4 建立文档document <a class="header-anchor" href="#_7-4-建立文档document" aria-label="Permalink to &quot;7.4 建立文档document&quot;">​</a></h2><h3 id="_7-4-1-建立文档-通过xcontentbuilder" tabindex="-1">7.4.1 建立文档（通过XContentBuilder） <a class="header-anchor" href="#_7-4-1-建立文档-通过xcontentbuilder" aria-label="Permalink to &quot;7.4.1 建立文档（通过XContentBuilder）&quot;">​</a></h3><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">@</span><span style="color:#F97583;">Test</span></span>
<span class="line"><span style="color:#6A737D;">//创建文档(通过XContentBuilder)</span></span>
<span class="line"><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">test4</span><span style="color:#E1E4E8;">() throws Exception{</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// 创建Client连接对象</span></span>
<span class="line"><span style="color:#E1E4E8;">    Settings settings </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> Settings.</span><span style="color:#B392F0;">builder</span><span style="color:#E1E4E8;">().</span><span style="color:#B392F0;">put</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;cluster.name&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;my-elasticsearch&quot;</span><span style="color:#E1E4E8;">).</span><span style="color:#B392F0;">build</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">    TransportClient client </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">PreBuiltTransportClient</span><span style="color:#E1E4E8;">(settings)</span></span>
<span class="line"><span style="color:#E1E4E8;">        .</span><span style="color:#B392F0;">addTransportAddress</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">InetSocketTransportAddress</span><span style="color:#E1E4E8;">(InetAddress.</span><span style="color:#B392F0;">getByName</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;127.0.0.1&quot;</span><span style="color:#E1E4E8;">), </span><span style="color:#79B8FF;">9300</span><span style="color:#E1E4E8;">));</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//创建文档信息</span></span>
<span class="line"><span style="color:#E1E4E8;">    XContentBuilder builder </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> XContentFactory.</span><span style="color:#B392F0;">jsonBuilder</span><span style="color:#E1E4E8;">()</span></span>
<span class="line"><span style="color:#E1E4E8;">        .</span><span style="color:#B392F0;">startObject</span><span style="color:#E1E4E8;">()</span></span>
<span class="line"><span style="color:#E1E4E8;">        .</span><span style="color:#B392F0;">field</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;id&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">        .</span><span style="color:#B392F0;">field</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;title&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;ElasticSearch是一个基于Lucene的搜索服务器&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">        .</span><span style="color:#B392F0;">field</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;content&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">               </span><span style="color:#9ECBFF;">&quot;它提供了一个分布式多用户能力的全文搜索引擎，基于RESTful web接口。Elasticsearch是用Java开发的，并作为Apache许可条款下的开放源码发布，是当前流行的企业级搜索引擎。设计用于云计算中，能够达到实时搜索，稳定，可靠，快速，安装使用方便。&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">        .</span><span style="color:#B392F0;">endObject</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// 建立文档对象</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">/**</span></span>
<span class="line"><span style="color:#6A737D;">         * 参数一blog1：表示索引对象</span></span>
<span class="line"><span style="color:#6A737D;">         * 参数二article：类型</span></span>
<span class="line"><span style="color:#6A737D;">         * 参数三1：建立id</span></span>
<span class="line"><span style="color:#6A737D;">         */</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// client.prepareIndex(&quot;blog2&quot;, &quot;article&quot;, &quot;1&quot;).setSource(builder).get();</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#6A737D;">// 也可以这样：</span></span>
<span class="line"><span style="color:#E1E4E8;">    client.</span><span style="color:#B392F0;">prepareIndex</span><span style="color:#E1E4E8;">().</span><span style="color:#B392F0;">setIndex</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;blog2&quot;</span><span style="color:#E1E4E8;">).</span><span style="color:#B392F0;">setType</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;article&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">        .</span><span style="color:#B392F0;">setId</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;1&quot;</span><span style="color:#E1E4E8;">).</span><span style="color:#B392F0;">setSource</span><span style="color:#E1E4E8;">(builder).</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//释放资源</span></span>
<span class="line"><span style="color:#E1E4E8;">    client.</span><span style="color:#B392F0;">close</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Test</span></span>
<span class="line"><span style="color:#6A737D;">//创建文档(通过XContentBuilder)</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">test4</span><span style="color:#24292E;">() throws Exception{</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// 创建Client连接对象</span></span>
<span class="line"><span style="color:#24292E;">    Settings settings </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> Settings.</span><span style="color:#6F42C1;">builder</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">put</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;cluster.name&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;my-elasticsearch&quot;</span><span style="color:#24292E;">).</span><span style="color:#6F42C1;">build</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">    TransportClient client </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">PreBuiltTransportClient</span><span style="color:#24292E;">(settings)</span></span>
<span class="line"><span style="color:#24292E;">        .</span><span style="color:#6F42C1;">addTransportAddress</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">InetSocketTransportAddress</span><span style="color:#24292E;">(InetAddress.</span><span style="color:#6F42C1;">getByName</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;127.0.0.1&quot;</span><span style="color:#24292E;">), </span><span style="color:#005CC5;">9300</span><span style="color:#24292E;">));</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//创建文档信息</span></span>
<span class="line"><span style="color:#24292E;">    XContentBuilder builder </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> XContentFactory.</span><span style="color:#6F42C1;">jsonBuilder</span><span style="color:#24292E;">()</span></span>
<span class="line"><span style="color:#24292E;">        .</span><span style="color:#6F42C1;">startObject</span><span style="color:#24292E;">()</span></span>
<span class="line"><span style="color:#24292E;">        .</span><span style="color:#6F42C1;">field</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;id&quot;</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">        .</span><span style="color:#6F42C1;">field</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;title&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;ElasticSearch是一个基于Lucene的搜索服务器&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">        .</span><span style="color:#6F42C1;">field</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;content&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">               </span><span style="color:#032F62;">&quot;它提供了一个分布式多用户能力的全文搜索引擎，基于RESTful web接口。Elasticsearch是用Java开发的，并作为Apache许可条款下的开放源码发布，是当前流行的企业级搜索引擎。设计用于云计算中，能够达到实时搜索，稳定，可靠，快速，安装使用方便。&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">        .</span><span style="color:#6F42C1;">endObject</span><span style="color:#24292E;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// 建立文档对象</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">/**</span></span>
<span class="line"><span style="color:#6A737D;">         * 参数一blog1：表示索引对象</span></span>
<span class="line"><span style="color:#6A737D;">         * 参数二article：类型</span></span>
<span class="line"><span style="color:#6A737D;">         * 参数三1：建立id</span></span>
<span class="line"><span style="color:#6A737D;">         */</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// client.prepareIndex(&quot;blog2&quot;, &quot;article&quot;, &quot;1&quot;).setSource(builder).get();</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#6A737D;">// 也可以这样：</span></span>
<span class="line"><span style="color:#24292E;">    client.</span><span style="color:#6F42C1;">prepareIndex</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">setIndex</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;blog2&quot;</span><span style="color:#24292E;">).</span><span style="color:#6F42C1;">setType</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;article&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">        .</span><span style="color:#6F42C1;">setId</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;1&quot;</span><span style="color:#24292E;">).</span><span style="color:#6F42C1;">setSource</span><span style="color:#24292E;">(builder).</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//释放资源</span></span>
<span class="line"><span style="color:#24292E;">    client.</span><span style="color:#6F42C1;">close</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h3 id="_7-4-2-建立文档-使用jackson转换实体" tabindex="-1">7.4.2 建立文档（使用Jackson转换实体） <a class="header-anchor" href="#_7-4-2-建立文档-使用jackson转换实体" aria-label="Permalink to &quot;7.4.2 建立文档（使用Jackson转换实体）&quot;">​</a></h3><p>1）创建Article实体</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Article</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#F97583;">private</span><span style="color:#E1E4E8;"> Integer id;</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#F97583;">private</span><span style="color:#E1E4E8;"> String title;</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#F97583;">private</span><span style="color:#E1E4E8;"> String content;</span></span>
<span class="line"><span style="color:#E1E4E8;">    getter</span><span style="color:#F97583;">/</span><span style="color:#E1E4E8;">setter...</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Article</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> Integer id;</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> String title;</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> String content;</span></span>
<span class="line"><span style="color:#24292E;">    getter</span><span style="color:#D73A49;">/</span><span style="color:#24292E;">setter...</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p>2）添加jackson坐标</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">&lt;</span><span style="color:#85E89D;">dependency</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">    &lt;</span><span style="color:#85E89D;">groupId</span><span style="color:#E1E4E8;">&gt;com.fasterxml.jackson.core&lt;/</span><span style="color:#85E89D;">groupId</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">    &lt;</span><span style="color:#85E89D;">artifactId</span><span style="color:#E1E4E8;">&gt;jackson-core&lt;/</span><span style="color:#85E89D;">artifactId</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">    &lt;</span><span style="color:#85E89D;">version</span><span style="color:#E1E4E8;">&gt;2.8.1&lt;/</span><span style="color:#85E89D;">version</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">&lt;/</span><span style="color:#85E89D;">dependency</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">&lt;</span><span style="color:#85E89D;">dependency</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">    &lt;</span><span style="color:#85E89D;">groupId</span><span style="color:#E1E4E8;">&gt;com.fasterxml.jackson.core&lt;/</span><span style="color:#85E89D;">groupId</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">    &lt;</span><span style="color:#85E89D;">artifactId</span><span style="color:#E1E4E8;">&gt;jackson-databind&lt;/</span><span style="color:#85E89D;">artifactId</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">    &lt;</span><span style="color:#85E89D;">version</span><span style="color:#E1E4E8;">&gt;2.8.1&lt;/</span><span style="color:#85E89D;">version</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">&lt;/</span><span style="color:#85E89D;">dependency</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">&lt;</span><span style="color:#85E89D;">dependency</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">    &lt;</span><span style="color:#85E89D;">groupId</span><span style="color:#E1E4E8;">&gt;com.fasterxml.jackson.core&lt;/</span><span style="color:#85E89D;">groupId</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">    &lt;</span><span style="color:#85E89D;">artifactId</span><span style="color:#E1E4E8;">&gt;jackson-annotations&lt;/</span><span style="color:#85E89D;">artifactId</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">    &lt;</span><span style="color:#85E89D;">version</span><span style="color:#E1E4E8;">&gt;2.8.1&lt;/</span><span style="color:#85E89D;">version</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">&lt;/</span><span style="color:#85E89D;">dependency</span><span style="color:#E1E4E8;">&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">dependency</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    &lt;</span><span style="color:#22863A;">groupId</span><span style="color:#24292E;">&gt;com.fasterxml.jackson.core&lt;/</span><span style="color:#22863A;">groupId</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    &lt;</span><span style="color:#22863A;">artifactId</span><span style="color:#24292E;">&gt;jackson-core&lt;/</span><span style="color:#22863A;">artifactId</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    &lt;</span><span style="color:#22863A;">version</span><span style="color:#24292E;">&gt;2.8.1&lt;/</span><span style="color:#22863A;">version</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">&lt;/</span><span style="color:#22863A;">dependency</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">dependency</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    &lt;</span><span style="color:#22863A;">groupId</span><span style="color:#24292E;">&gt;com.fasterxml.jackson.core&lt;/</span><span style="color:#22863A;">groupId</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    &lt;</span><span style="color:#22863A;">artifactId</span><span style="color:#24292E;">&gt;jackson-databind&lt;/</span><span style="color:#22863A;">artifactId</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    &lt;</span><span style="color:#22863A;">version</span><span style="color:#24292E;">&gt;2.8.1&lt;/</span><span style="color:#22863A;">version</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">&lt;/</span><span style="color:#22863A;">dependency</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">dependency</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    &lt;</span><span style="color:#22863A;">groupId</span><span style="color:#24292E;">&gt;com.fasterxml.jackson.core&lt;/</span><span style="color:#22863A;">groupId</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    &lt;</span><span style="color:#22863A;">artifactId</span><span style="color:#24292E;">&gt;jackson-annotations&lt;/</span><span style="color:#22863A;">artifactId</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    &lt;</span><span style="color:#22863A;">version</span><span style="color:#24292E;">&gt;2.8.1&lt;/</span><span style="color:#22863A;">version</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">&lt;/</span><span style="color:#22863A;">dependency</span><span style="color:#24292E;">&gt;</span></span></code></pre></div><p>3）代码实现</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">@</span><span style="color:#F97583;">Test</span></span>
<span class="line"><span style="color:#6A737D;">//创建文档(通过实体转json)</span></span>
<span class="line"><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">test5</span><span style="color:#E1E4E8;">() throws Exception{</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// 创建Client连接对象</span></span>
<span class="line"><span style="color:#E1E4E8;">    Settings settings </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> Settings.</span><span style="color:#B392F0;">builder</span><span style="color:#E1E4E8;">().</span><span style="color:#B392F0;">put</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;cluster.name&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;my-elasticsearch&quot;</span><span style="color:#E1E4E8;">).</span><span style="color:#B392F0;">build</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">    TransportClient client </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">PreBuiltTransportClient</span><span style="color:#E1E4E8;">(settings)</span></span>
<span class="line"><span style="color:#E1E4E8;">        .</span><span style="color:#B392F0;">addTransportAddress</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">InetSocketTransportAddress</span><span style="color:#E1E4E8;">(InetAddress.</span><span style="color:#B392F0;">getByName</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;127.0.0.1&quot;</span><span style="color:#E1E4E8;">), </span><span style="color:#79B8FF;">9300</span><span style="color:#E1E4E8;">));</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// 描述json 数据</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//{id:xxx, title:xxx, content:xxx}</span></span>
<span class="line"><span style="color:#E1E4E8;">    Article article </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Article</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">    article.</span><span style="color:#B392F0;">setId</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">    article.</span><span style="color:#B392F0;">setTitle</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;搜索工作其实很快乐&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">    article.</span><span style="color:#B392F0;">setContent</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;我们希望我们的搜索解决方案要快，我们希望有一个零配置和一个完全免费的搜索模式，我们希望能够简单地使用JSON通过HTTP的索引数据，我们希望我们的搜索服务器始终可用，我们希望能够一台开始并扩展到数百，我们要实时搜索，我们要简单的多租户，我们希望建立一个云的解决方案。Elasticsearch旨在解决所有这些问题和更多的问题。&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    ObjectMapper objectMapper </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">ObjectMapper</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">	String s </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> objectMapper.</span><span style="color:#B392F0;">writeValueAsString</span><span style="color:#E1E4E8;">(article);</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// 建立文档</span></span>
<span class="line"><span style="color:#E1E4E8;">    client.</span><span style="color:#B392F0;">prepareIndex</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;blog2&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;article&quot;</span><span style="color:#E1E4E8;">, article.</span><span style="color:#B392F0;">getId</span><span style="color:#E1E4E8;">().</span><span style="color:#B392F0;">toString</span><span style="color:#E1E4E8;">())</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#6A737D;">//.setSource(objectMapper.writeValueAsString(article)).get();</span></span>
<span class="line"><span style="color:#E1E4E8;">        .</span><span style="color:#B392F0;">setSource</span><span style="color:#E1E4E8;">(s, XContentType.JSON).</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//释放资源</span></span>
<span class="line"><span style="color:#E1E4E8;">    client.</span><span style="color:#B392F0;">close</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Test</span></span>
<span class="line"><span style="color:#6A737D;">//创建文档(通过实体转json)</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">test5</span><span style="color:#24292E;">() throws Exception{</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// 创建Client连接对象</span></span>
<span class="line"><span style="color:#24292E;">    Settings settings </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> Settings.</span><span style="color:#6F42C1;">builder</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">put</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;cluster.name&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;my-elasticsearch&quot;</span><span style="color:#24292E;">).</span><span style="color:#6F42C1;">build</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">    TransportClient client </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">PreBuiltTransportClient</span><span style="color:#24292E;">(settings)</span></span>
<span class="line"><span style="color:#24292E;">        .</span><span style="color:#6F42C1;">addTransportAddress</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">InetSocketTransportAddress</span><span style="color:#24292E;">(InetAddress.</span><span style="color:#6F42C1;">getByName</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;127.0.0.1&quot;</span><span style="color:#24292E;">), </span><span style="color:#005CC5;">9300</span><span style="color:#24292E;">));</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// 描述json 数据</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//{id:xxx, title:xxx, content:xxx}</span></span>
<span class="line"><span style="color:#24292E;">    Article article </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Article</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">    article.</span><span style="color:#6F42C1;">setId</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">2</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    article.</span><span style="color:#6F42C1;">setTitle</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;搜索工作其实很快乐&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    article.</span><span style="color:#6F42C1;">setContent</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;我们希望我们的搜索解决方案要快，我们希望有一个零配置和一个完全免费的搜索模式，我们希望能够简单地使用JSON通过HTTP的索引数据，我们希望我们的搜索服务器始终可用，我们希望能够一台开始并扩展到数百，我们要实时搜索，我们要简单的多租户，我们希望建立一个云的解决方案。Elasticsearch旨在解决所有这些问题和更多的问题。&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    ObjectMapper objectMapper </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ObjectMapper</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">	String s </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> objectMapper.</span><span style="color:#6F42C1;">writeValueAsString</span><span style="color:#24292E;">(article);</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// 建立文档</span></span>
<span class="line"><span style="color:#24292E;">    client.</span><span style="color:#6F42C1;">prepareIndex</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;blog2&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;article&quot;</span><span style="color:#24292E;">, article.</span><span style="color:#6F42C1;">getId</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">toString</span><span style="color:#24292E;">())</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//.setSource(objectMapper.writeValueAsString(article)).get();</span></span>
<span class="line"><span style="color:#24292E;">        .</span><span style="color:#6F42C1;">setSource</span><span style="color:#24292E;">(s, XContentType.JSON).</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//释放资源</span></span>
<span class="line"><span style="color:#24292E;">    client.</span><span style="color:#6F42C1;">close</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h2 id="_7-5-查询文档操作" tabindex="-1">7.5 查询文档操作 <a class="header-anchor" href="#_7-5-查询文档操作" aria-label="Permalink to &quot;7.5 查询文档操作&quot;">​</a></h2><h3 id="_7-5-1关键词查询-term" tabindex="-1">7.5.1关键词查询（Term） <a class="header-anchor" href="#_7-5-1关键词查询-term" aria-label="Permalink to &quot;7.5.1关键词查询（Term）&quot;">​</a></h3><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">@</span><span style="color:#F97583;">Test</span></span>
<span class="line"><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">testTermQuery</span><span style="color:#E1E4E8;">() throws Exception{</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//1、创建es客户端连接对象</span></span>
<span class="line"><span style="color:#E1E4E8;">    Settings settings </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> Settings.</span><span style="color:#B392F0;">builder</span><span style="color:#E1E4E8;">().</span><span style="color:#B392F0;">put</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;cluster.name&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;my-elasticsearch&quot;</span><span style="color:#E1E4E8;">).</span><span style="color:#B392F0;">build</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">    TransportClient client </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">PreBuiltTransportClient</span><span style="color:#E1E4E8;">(settings)</span></span>
<span class="line"><span style="color:#E1E4E8;">        .</span><span style="color:#B392F0;">addTransportAddress</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">InetSocketTransportAddress</span><span style="color:#E1E4E8;">(InetAddress.</span><span style="color:#B392F0;">getByName</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;127.0.0.1&quot;</span><span style="color:#E1E4E8;">), </span><span style="color:#79B8FF;">9300</span><span style="color:#E1E4E8;">));</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//2、设置搜索条件</span></span>
<span class="line"><span style="color:#E1E4E8;">    SearchResponse searchResponse </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> client.</span><span style="color:#B392F0;">prepareSearch</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;blog2&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">        .</span><span style="color:#B392F0;">setTypes</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;article&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">        .</span><span style="color:#B392F0;">setQuery</span><span style="color:#E1E4E8;">(QueryBuilders.</span><span style="color:#B392F0;">termQuery</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;content&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;搜索&quot;</span><span style="color:#E1E4E8;">)).</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//3、遍历搜索结果数据</span></span>
<span class="line"><span style="color:#E1E4E8;">    SearchHits hits </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> searchResponse.</span><span style="color:#B392F0;">getHits</span><span style="color:#E1E4E8;">(); </span><span style="color:#6A737D;">// 获取命中次数，查询结果有多少对象</span></span>
<span class="line"><span style="color:#E1E4E8;">    System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;查询结果有：&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> hits.</span><span style="color:#B392F0;">getTotalHits</span><span style="color:#E1E4E8;">() </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;条&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">    Iterator&lt;</span><span style="color:#F97583;">SearchHit</span><span style="color:#E1E4E8;">&gt; iterator </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> hits.</span><span style="color:#B392F0;">iterator</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">while</span><span style="color:#E1E4E8;"> (iterator.</span><span style="color:#B392F0;">hasNext</span><span style="color:#E1E4E8;">()) {</span></span>
<span class="line"><span style="color:#E1E4E8;">        SearchHit searchHit </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> iterator.</span><span style="color:#B392F0;">next</span><span style="color:#E1E4E8;">(); </span><span style="color:#6A737D;">// 每个查询对象</span></span>
<span class="line"><span style="color:#E1E4E8;">        System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(searchHit.</span><span style="color:#B392F0;">getSourceAsString</span><span style="color:#E1E4E8;">()); </span><span style="color:#6A737D;">// 获取字符串格式打印</span></span>
<span class="line"><span style="color:#E1E4E8;">        System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;title:&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> searchHit.</span><span style="color:#B392F0;">getSource</span><span style="color:#E1E4E8;">().</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;title&quot;</span><span style="color:#E1E4E8;">));</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//4、释放资源</span></span>
<span class="line"><span style="color:#E1E4E8;">    client.</span><span style="color:#B392F0;">close</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Test</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">testTermQuery</span><span style="color:#24292E;">() throws Exception{</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//1、创建es客户端连接对象</span></span>
<span class="line"><span style="color:#24292E;">    Settings settings </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> Settings.</span><span style="color:#6F42C1;">builder</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">put</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;cluster.name&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;my-elasticsearch&quot;</span><span style="color:#24292E;">).</span><span style="color:#6F42C1;">build</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">    TransportClient client </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">PreBuiltTransportClient</span><span style="color:#24292E;">(settings)</span></span>
<span class="line"><span style="color:#24292E;">        .</span><span style="color:#6F42C1;">addTransportAddress</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">InetSocketTransportAddress</span><span style="color:#24292E;">(InetAddress.</span><span style="color:#6F42C1;">getByName</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;127.0.0.1&quot;</span><span style="color:#24292E;">), </span><span style="color:#005CC5;">9300</span><span style="color:#24292E;">));</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//2、设置搜索条件</span></span>
<span class="line"><span style="color:#24292E;">    SearchResponse searchResponse </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> client.</span><span style="color:#6F42C1;">prepareSearch</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;blog2&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">        .</span><span style="color:#6F42C1;">setTypes</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;article&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">        .</span><span style="color:#6F42C1;">setQuery</span><span style="color:#24292E;">(QueryBuilders.</span><span style="color:#6F42C1;">termQuery</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;content&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;搜索&quot;</span><span style="color:#24292E;">)).</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//3、遍历搜索结果数据</span></span>
<span class="line"><span style="color:#24292E;">    SearchHits hits </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> searchResponse.</span><span style="color:#6F42C1;">getHits</span><span style="color:#24292E;">(); </span><span style="color:#6A737D;">// 获取命中次数，查询结果有多少对象</span></span>
<span class="line"><span style="color:#24292E;">    System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;查询结果有：&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> hits.</span><span style="color:#6F42C1;">getTotalHits</span><span style="color:#24292E;">() </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;条&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    Iterator&lt;</span><span style="color:#D73A49;">SearchHit</span><span style="color:#24292E;">&gt; iterator </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> hits.</span><span style="color:#6F42C1;">iterator</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">while</span><span style="color:#24292E;"> (iterator.</span><span style="color:#6F42C1;">hasNext</span><span style="color:#24292E;">()) {</span></span>
<span class="line"><span style="color:#24292E;">        SearchHit searchHit </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> iterator.</span><span style="color:#6F42C1;">next</span><span style="color:#24292E;">(); </span><span style="color:#6A737D;">// 每个查询对象</span></span>
<span class="line"><span style="color:#24292E;">        System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(searchHit.</span><span style="color:#6F42C1;">getSourceAsString</span><span style="color:#24292E;">()); </span><span style="color:#6A737D;">// 获取字符串格式打印</span></span>
<span class="line"><span style="color:#24292E;">        System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;title:&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> searchHit.</span><span style="color:#6F42C1;">getSource</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;title&quot;</span><span style="color:#24292E;">));</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//4、释放资源</span></span>
<span class="line"><span style="color:#24292E;">    client.</span><span style="color:#6F42C1;">close</span><span style="color:#24292E;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h3 id="_7-5-2-字符串查询-querystring" tabindex="-1">7.5.2 字符串查询（QueryString） <a class="header-anchor" href="#_7-5-2-字符串查询-querystring" aria-label="Permalink to &quot;7.5.2  字符串查询（QueryString）&quot;">​</a></h3><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">@</span><span style="color:#F97583;">Testpublic</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">testStringQuery</span><span style="color:#E1E4E8;">() throws Exception{    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//1、创建es客户端连接对象    </span></span>
<span class="line"><span style="color:#E1E4E8;">    Settings settings </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> Settings.</span><span style="color:#B392F0;">builder</span><span style="color:#E1E4E8;">()</span></span>
<span class="line"><span style="color:#E1E4E8;">        .</span><span style="color:#B392F0;">put</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;cluster.name&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;my-elasticsearch&quot;</span><span style="color:#E1E4E8;">).</span><span style="color:#B392F0;">build</span><span style="color:#E1E4E8;">();    </span></span>
<span class="line"><span style="color:#E1E4E8;">    TransportClient client </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">PreBuiltTransportClient</span><span style="color:#E1E4E8;">(settings)        </span></span>
<span class="line"><span style="color:#E1E4E8;">        .</span><span style="color:#B392F0;">addTransportAddress</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">InetSocketTransportAddress</span><span style="color:#E1E4E8;">(InetAddress.</span><span style="color:#B392F0;">getByName</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;127.0.0.1&quot;</span><span style="color:#E1E4E8;">), </span><span style="color:#79B8FF;">9300</span><span style="color:#E1E4E8;">));    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//2、设置搜索条件    </span></span>
<span class="line"><span style="color:#E1E4E8;">    SearchResponse searchResponse </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> client.</span><span style="color:#B392F0;">prepareSearch</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;blog2&quot;</span><span style="color:#E1E4E8;">)        </span></span>
<span class="line"><span style="color:#E1E4E8;">        .</span><span style="color:#B392F0;">setTypes</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;article&quot;</span><span style="color:#E1E4E8;">)        </span></span>
<span class="line"><span style="color:#E1E4E8;">        .</span><span style="color:#B392F0;">setQuery</span><span style="color:#E1E4E8;">(QueryBuilders.</span><span style="color:#B392F0;">queryStringQuery</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;搜索&quot;</span><span style="color:#E1E4E8;">))</span></span>
<span class="line"><span style="color:#E1E4E8;">        .</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">();    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//3、遍历搜索结果数据    </span></span>
<span class="line"><span style="color:#E1E4E8;">    SearchHits hits </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> searchResponse.</span><span style="color:#B392F0;">getHits</span><span style="color:#E1E4E8;">(); </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// 获取命中次数，查询结果有多少对象    </span></span>
<span class="line"><span style="color:#E1E4E8;">    System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;查询结果有：&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> hits.</span><span style="color:#B392F0;">getTotalHits</span><span style="color:#E1E4E8;">() </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;条&quot;</span><span style="color:#E1E4E8;">);    </span></span>
<span class="line"><span style="color:#E1E4E8;">    Iterator&lt;</span><span style="color:#F97583;">SearchHit</span><span style="color:#E1E4E8;">&gt; iterator </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> hits.</span><span style="color:#B392F0;">iterator</span><span style="color:#E1E4E8;">();    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">while</span><span style="color:#E1E4E8;"> (iterator.</span><span style="color:#B392F0;">hasNext</span><span style="color:#E1E4E8;">()) {        </span></span>
<span class="line"><span style="color:#E1E4E8;">        SearchHit searchHit </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> iterator.</span><span style="color:#B392F0;">next</span><span style="color:#E1E4E8;">(); </span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#6A737D;">// 每个查询对象        </span></span>
<span class="line"><span style="color:#E1E4E8;">        System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(searchHit.</span><span style="color:#B392F0;">getSourceAsString</span><span style="color:#E1E4E8;">()); </span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#6A737D;">// 获取字符串格式打印        </span></span>
<span class="line"><span style="color:#E1E4E8;">        System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;title:&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> searchHit.</span><span style="color:#B392F0;">getSource</span><span style="color:#E1E4E8;">().</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;title&quot;</span><span style="color:#E1E4E8;">));    </span></span>
<span class="line"><span style="color:#E1E4E8;">    }    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//4、释放资源    </span></span>
<span class="line"><span style="color:#E1E4E8;">    client.</span><span style="color:#B392F0;">close</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Testpublic</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">testStringQuery</span><span style="color:#24292E;">() throws Exception{    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//1、创建es客户端连接对象    </span></span>
<span class="line"><span style="color:#24292E;">    Settings settings </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> Settings.</span><span style="color:#6F42C1;">builder</span><span style="color:#24292E;">()</span></span>
<span class="line"><span style="color:#24292E;">        .</span><span style="color:#6F42C1;">put</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;cluster.name&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;my-elasticsearch&quot;</span><span style="color:#24292E;">).</span><span style="color:#6F42C1;">build</span><span style="color:#24292E;">();    </span></span>
<span class="line"><span style="color:#24292E;">    TransportClient client </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">PreBuiltTransportClient</span><span style="color:#24292E;">(settings)        </span></span>
<span class="line"><span style="color:#24292E;">        .</span><span style="color:#6F42C1;">addTransportAddress</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">InetSocketTransportAddress</span><span style="color:#24292E;">(InetAddress.</span><span style="color:#6F42C1;">getByName</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;127.0.0.1&quot;</span><span style="color:#24292E;">), </span><span style="color:#005CC5;">9300</span><span style="color:#24292E;">));    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//2、设置搜索条件    </span></span>
<span class="line"><span style="color:#24292E;">    SearchResponse searchResponse </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> client.</span><span style="color:#6F42C1;">prepareSearch</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;blog2&quot;</span><span style="color:#24292E;">)        </span></span>
<span class="line"><span style="color:#24292E;">        .</span><span style="color:#6F42C1;">setTypes</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;article&quot;</span><span style="color:#24292E;">)        </span></span>
<span class="line"><span style="color:#24292E;">        .</span><span style="color:#6F42C1;">setQuery</span><span style="color:#24292E;">(QueryBuilders.</span><span style="color:#6F42C1;">queryStringQuery</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;搜索&quot;</span><span style="color:#24292E;">))</span></span>
<span class="line"><span style="color:#24292E;">        .</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">();    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//3、遍历搜索结果数据    </span></span>
<span class="line"><span style="color:#24292E;">    SearchHits hits </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> searchResponse.</span><span style="color:#6F42C1;">getHits</span><span style="color:#24292E;">(); </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// 获取命中次数，查询结果有多少对象    </span></span>
<span class="line"><span style="color:#24292E;">    System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;查询结果有：&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> hits.</span><span style="color:#6F42C1;">getTotalHits</span><span style="color:#24292E;">() </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;条&quot;</span><span style="color:#24292E;">);    </span></span>
<span class="line"><span style="color:#24292E;">    Iterator&lt;</span><span style="color:#D73A49;">SearchHit</span><span style="color:#24292E;">&gt; iterator </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> hits.</span><span style="color:#6F42C1;">iterator</span><span style="color:#24292E;">();    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">while</span><span style="color:#24292E;"> (iterator.</span><span style="color:#6F42C1;">hasNext</span><span style="color:#24292E;">()) {        </span></span>
<span class="line"><span style="color:#24292E;">        SearchHit searchHit </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> iterator.</span><span style="color:#6F42C1;">next</span><span style="color:#24292E;">(); </span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">// 每个查询对象        </span></span>
<span class="line"><span style="color:#24292E;">        System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(searchHit.</span><span style="color:#6F42C1;">getSourceAsString</span><span style="color:#24292E;">()); </span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">// 获取字符串格式打印        </span></span>
<span class="line"><span style="color:#24292E;">        System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;title:&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> searchHit.</span><span style="color:#6F42C1;">getSource</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;title&quot;</span><span style="color:#24292E;">));    </span></span>
<span class="line"><span style="color:#24292E;">    }    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//4、释放资源    </span></span>
<span class="line"><span style="color:#24292E;">    client.</span><span style="color:#6F42C1;">close</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h3 id="_7-5-3-使用文档id查询文档" tabindex="-1">7.5.3 使用文档ID查询文档 <a class="header-anchor" href="#_7-5-3-使用文档id查询文档" aria-label="Permalink to &quot;7.5.3 使用文档ID查询文档&quot;">​</a></h3><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">@</span><span style="color:#F97583;">Test</span><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">testIdQuery</span><span style="color:#E1E4E8;">() throws Exception {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// 创建es客户端连接对象 </span></span>
<span class="line"><span style="color:#E1E4E8;">    Settings settings </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> Settings.</span><span style="color:#B392F0;">builder</span><span style="color:#E1E4E8;">()</span></span>
<span class="line"><span style="color:#E1E4E8;">        .</span><span style="color:#B392F0;">put</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;cluster.name&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;my-elasticsearch&quot;</span><span style="color:#E1E4E8;">).</span><span style="color:#B392F0;">build</span><span style="color:#E1E4E8;">();    </span></span>
<span class="line"><span style="color:#E1E4E8;">    TransportClient client </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">PreBuiltTransportClient</span><span style="color:#E1E4E8;">(settings)        </span></span>
<span class="line"><span style="color:#E1E4E8;">        .</span><span style="color:#B392F0;">addTransportAddress</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">InetSocketTransportAddress</span><span style="color:#E1E4E8;">(InetAddress.</span><span style="color:#B392F0;">getByName</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;127.0.0.1&quot;</span><span style="color:#E1E4E8;">), </span><span style="color:#79B8FF;">9300</span><span style="color:#E1E4E8;">));</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//client对象为TransportClient对象        </span></span>
<span class="line"><span style="color:#E1E4E8;">    SearchResponse response </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> client.</span><span style="color:#B392F0;">prepareSearch</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;blog1&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">        .</span><span style="color:#B392F0;">setTypes</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;article&quot;</span><span style="color:#E1E4E8;">)                </span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#6A737D;">//设置要查询的id                </span></span>
<span class="line"><span style="color:#E1E4E8;">        .</span><span style="color:#B392F0;">setQuery</span><span style="color:#E1E4E8;">(QueryBuilders.</span><span style="color:#B392F0;">idsQuery</span><span style="color:#E1E4E8;">().</span><span style="color:#B392F0;">addIds</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;test002&quot;</span><span style="color:#E1E4E8;">))                </span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#6A737D;">//执行查询                </span></span>
<span class="line"><span style="color:#E1E4E8;">        .</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">();        </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//取查询结果        </span></span>
<span class="line"><span style="color:#E1E4E8;">    SearchHits searchHits </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> response.</span><span style="color:#B392F0;">getHits</span><span style="color:#E1E4E8;">();        </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//取查询结果总记录数        </span></span>
<span class="line"><span style="color:#E1E4E8;">    System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(searchHits.</span><span style="color:#B392F0;">getTotalHits</span><span style="color:#E1E4E8;">());        </span></span>
<span class="line"><span style="color:#E1E4E8;">    Iterator&lt;</span><span style="color:#F97583;">SearchHit</span><span style="color:#E1E4E8;">&gt; hitIterator </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> searchHits.</span><span style="color:#B392F0;">iterator</span><span style="color:#E1E4E8;">();        </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">while</span><span style="color:#E1E4E8;">(hitIterator.</span><span style="color:#B392F0;">hasNext</span><span style="color:#E1E4E8;">()) </span></span>
<span class="line"><span style="color:#E1E4E8;">    {            </span></span>
<span class="line"><span style="color:#E1E4E8;">        SearchHit searchHit </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> hitIterator.</span><span style="color:#B392F0;">next</span><span style="color:#E1E4E8;">();            </span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#6A737D;">//打印整行数据            </span></span>
<span class="line"><span style="color:#E1E4E8;">        System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(searchHit.</span><span style="color:#B392F0;">getSourceAsString</span><span style="color:#E1E4E8;">());        </span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// 释放资源    </span></span>
<span class="line"><span style="color:#E1E4E8;">    client.</span><span style="color:#B392F0;">close</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Test</span><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">testIdQuery</span><span style="color:#24292E;">() throws Exception {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// 创建es客户端连接对象 </span></span>
<span class="line"><span style="color:#24292E;">    Settings settings </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> Settings.</span><span style="color:#6F42C1;">builder</span><span style="color:#24292E;">()</span></span>
<span class="line"><span style="color:#24292E;">        .</span><span style="color:#6F42C1;">put</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;cluster.name&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;my-elasticsearch&quot;</span><span style="color:#24292E;">).</span><span style="color:#6F42C1;">build</span><span style="color:#24292E;">();    </span></span>
<span class="line"><span style="color:#24292E;">    TransportClient client </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">PreBuiltTransportClient</span><span style="color:#24292E;">(settings)        </span></span>
<span class="line"><span style="color:#24292E;">        .</span><span style="color:#6F42C1;">addTransportAddress</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">InetSocketTransportAddress</span><span style="color:#24292E;">(InetAddress.</span><span style="color:#6F42C1;">getByName</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;127.0.0.1&quot;</span><span style="color:#24292E;">), </span><span style="color:#005CC5;">9300</span><span style="color:#24292E;">));</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//client对象为TransportClient对象        </span></span>
<span class="line"><span style="color:#24292E;">    SearchResponse response </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> client.</span><span style="color:#6F42C1;">prepareSearch</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;blog1&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">        .</span><span style="color:#6F42C1;">setTypes</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;article&quot;</span><span style="color:#24292E;">)                </span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//设置要查询的id                </span></span>
<span class="line"><span style="color:#24292E;">        .</span><span style="color:#6F42C1;">setQuery</span><span style="color:#24292E;">(QueryBuilders.</span><span style="color:#6F42C1;">idsQuery</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">addIds</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;test002&quot;</span><span style="color:#24292E;">))                </span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//执行查询                </span></span>
<span class="line"><span style="color:#24292E;">        .</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">();        </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//取查询结果        </span></span>
<span class="line"><span style="color:#24292E;">    SearchHits searchHits </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> response.</span><span style="color:#6F42C1;">getHits</span><span style="color:#24292E;">();        </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//取查询结果总记录数        </span></span>
<span class="line"><span style="color:#24292E;">    System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(searchHits.</span><span style="color:#6F42C1;">getTotalHits</span><span style="color:#24292E;">());        </span></span>
<span class="line"><span style="color:#24292E;">    Iterator&lt;</span><span style="color:#D73A49;">SearchHit</span><span style="color:#24292E;">&gt; hitIterator </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> searchHits.</span><span style="color:#6F42C1;">iterator</span><span style="color:#24292E;">();        </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">while</span><span style="color:#24292E;">(hitIterator.</span><span style="color:#6F42C1;">hasNext</span><span style="color:#24292E;">()) </span></span>
<span class="line"><span style="color:#24292E;">    {            </span></span>
<span class="line"><span style="color:#24292E;">        SearchHit searchHit </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> hitIterator.</span><span style="color:#6F42C1;">next</span><span style="color:#24292E;">();            </span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//打印整行数据            </span></span>
<span class="line"><span style="color:#24292E;">        System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(searchHit.</span><span style="color:#6F42C1;">getSourceAsString</span><span style="color:#24292E;">());        </span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// 释放资源    </span></span>
<span class="line"><span style="color:#24292E;">    client.</span><span style="color:#6F42C1;">close</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h2 id="_7-6-查询文档分页操作" tabindex="-1">7.6 查询文档分页操作 <a class="header-anchor" href="#_7-6-查询文档分页操作" aria-label="Permalink to &quot;7.6 查询文档分页操作&quot;">​</a></h2><h3 id="_7-6-1-批量插入数据" tabindex="-1">7.6.1 批量插入数据 <a class="header-anchor" href="#_7-6-1-批量插入数据" aria-label="Permalink to &quot;7.6.1 批量插入数据&quot;">​</a></h3><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;"> @</span><span style="color:#F97583;">Test</span></span>
<span class="line"><span style="color:#6A737D;">//批量插入100条数据</span></span>
<span class="line"><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">test9</span><span style="color:#E1E4E8;">() throws Exception{    	</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// 创建Client连接对象        </span></span>
<span class="line"><span style="color:#E1E4E8;">    Settings settings </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> Settings.</span><span style="color:#B392F0;">builder</span><span style="color:#E1E4E8;">().</span><span style="color:#B392F0;">put</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;cluster.name&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;my-elasticsearch&quot;</span><span style="color:#E1E4E8;">).</span><span style="color:#B392F0;">build</span><span style="color:#E1E4E8;">();        </span></span>
<span class="line"><span style="color:#E1E4E8;">    TransportClient client </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">PreBuiltTransportClient</span><span style="color:#E1E4E8;">(settings)                .</span><span style="color:#B392F0;">addTransportAddress</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">InetSocketTransportAddress</span><span style="color:#E1E4E8;">(InetAddress.</span><span style="color:#B392F0;">getByName</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;127.0.0.1&quot;</span><span style="color:#E1E4E8;">), </span><span style="color:#79B8FF;">9300</span><span style="color:#E1E4E8;">));        </span></span>
<span class="line"><span style="color:#E1E4E8;">    ObjectMapper objectMapper </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">ObjectMapper</span><span style="color:#E1E4E8;">();        </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">for</span><span style="color:#E1E4E8;"> (</span><span style="color:#F97583;">int</span><span style="color:#E1E4E8;"> i </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">; i </span><span style="color:#F97583;">&lt;=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">100</span><span style="color:#E1E4E8;">; i</span><span style="color:#F97583;">++</span><span style="color:#E1E4E8;">) {            </span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#6A737D;">// 描述json 数据            </span></span>
<span class="line"><span style="color:#E1E4E8;">        Article article </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Article</span><span style="color:#E1E4E8;">();            </span></span>
<span class="line"><span style="color:#E1E4E8;">        article.</span><span style="color:#B392F0;">setId</span><span style="color:#E1E4E8;">(i);            </span></span>
<span class="line"><span style="color:#E1E4E8;">        article.</span><span style="color:#B392F0;">setTitle</span><span style="color:#E1E4E8;">(i </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;搜索工作其实很快乐&quot;</span><span style="color:#E1E4E8;">);            </span></span>
<span class="line"><span style="color:#E1E4E8;">        article.</span><span style="color:#B392F0;">setContent</span><span style="color:#E1E4E8;">(i </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;我们希望我们的搜索解决方案要快，我们希望有一个零配置和一个完全免费的搜索模式，我们希望能够简单地使用JSON通过HTTP的索引数据，我们希望我们的搜索服务器始终可用，我们希望能够一台开始并扩展到数百，我们要实时搜索，我们要简单的多租户，我们希望建立一个云的解决方案。Elasticsearch旨在解决所有这些问题和更多的问题。&quot;</span><span style="color:#E1E4E8;">);            </span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#6A737D;">// 建立文档            </span></span>
<span class="line"><span style="color:#E1E4E8;">        client.</span><span style="color:#B392F0;">prepareIndex</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;blog2&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;article&quot;</span><span style="color:#E1E4E8;">, article.</span><span style="color:#B392F0;">getId</span><span style="color:#E1E4E8;">().</span><span style="color:#B392F0;">toString</span><span style="color:#E1E4E8;">())                    	  </span><span style="color:#6A737D;">//.setSource(objectMapper.writeValueAsString(article)).get();</span></span>
<span class="line"><span style="color:#E1E4E8;">            .</span><span style="color:#B392F0;">setSource</span><span style="color:#E1E4E8;">(objectMapper</span></span>
<span class="line"><span style="color:#E1E4E8;">                       .</span><span style="color:#B392F0;">writeValueAsString</span><span style="color:#E1E4E8;">(article)</span></span>
<span class="line"><span style="color:#E1E4E8;">                       .</span><span style="color:#B392F0;">getBytes</span><span style="color:#E1E4E8;">(), XContentType.JSON)</span></span>
<span class="line"><span style="color:#E1E4E8;">            .</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">();   </span></span>
<span class="line"><span style="color:#E1E4E8;">    }        </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//释放资源        </span></span>
<span class="line"><span style="color:#E1E4E8;">    client.</span><span style="color:#B392F0;">close</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;"> @</span><span style="color:#D73A49;">Test</span></span>
<span class="line"><span style="color:#6A737D;">//批量插入100条数据</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">test9</span><span style="color:#24292E;">() throws Exception{    	</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// 创建Client连接对象        </span></span>
<span class="line"><span style="color:#24292E;">    Settings settings </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> Settings.</span><span style="color:#6F42C1;">builder</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">put</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;cluster.name&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;my-elasticsearch&quot;</span><span style="color:#24292E;">).</span><span style="color:#6F42C1;">build</span><span style="color:#24292E;">();        </span></span>
<span class="line"><span style="color:#24292E;">    TransportClient client </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">PreBuiltTransportClient</span><span style="color:#24292E;">(settings)                .</span><span style="color:#6F42C1;">addTransportAddress</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">InetSocketTransportAddress</span><span style="color:#24292E;">(InetAddress.</span><span style="color:#6F42C1;">getByName</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;127.0.0.1&quot;</span><span style="color:#24292E;">), </span><span style="color:#005CC5;">9300</span><span style="color:#24292E;">));        </span></span>
<span class="line"><span style="color:#24292E;">    ObjectMapper objectMapper </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ObjectMapper</span><span style="color:#24292E;">();        </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">for</span><span style="color:#24292E;"> (</span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> i </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">; i </span><span style="color:#D73A49;">&lt;=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">100</span><span style="color:#24292E;">; i</span><span style="color:#D73A49;">++</span><span style="color:#24292E;">) {            </span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">// 描述json 数据            </span></span>
<span class="line"><span style="color:#24292E;">        Article article </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Article</span><span style="color:#24292E;">();            </span></span>
<span class="line"><span style="color:#24292E;">        article.</span><span style="color:#6F42C1;">setId</span><span style="color:#24292E;">(i);            </span></span>
<span class="line"><span style="color:#24292E;">        article.</span><span style="color:#6F42C1;">setTitle</span><span style="color:#24292E;">(i </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;搜索工作其实很快乐&quot;</span><span style="color:#24292E;">);            </span></span>
<span class="line"><span style="color:#24292E;">        article.</span><span style="color:#6F42C1;">setContent</span><span style="color:#24292E;">(i </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;我们希望我们的搜索解决方案要快，我们希望有一个零配置和一个完全免费的搜索模式，我们希望能够简单地使用JSON通过HTTP的索引数据，我们希望我们的搜索服务器始终可用，我们希望能够一台开始并扩展到数百，我们要实时搜索，我们要简单的多租户，我们希望建立一个云的解决方案。Elasticsearch旨在解决所有这些问题和更多的问题。&quot;</span><span style="color:#24292E;">);            </span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">// 建立文档            </span></span>
<span class="line"><span style="color:#24292E;">        client.</span><span style="color:#6F42C1;">prepareIndex</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;blog2&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;article&quot;</span><span style="color:#24292E;">, article.</span><span style="color:#6F42C1;">getId</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">toString</span><span style="color:#24292E;">())                    	  </span><span style="color:#6A737D;">//.setSource(objectMapper.writeValueAsString(article)).get();</span></span>
<span class="line"><span style="color:#24292E;">            .</span><span style="color:#6F42C1;">setSource</span><span style="color:#24292E;">(objectMapper</span></span>
<span class="line"><span style="color:#24292E;">                       .</span><span style="color:#6F42C1;">writeValueAsString</span><span style="color:#24292E;">(article)</span></span>
<span class="line"><span style="color:#24292E;">                       .</span><span style="color:#6F42C1;">getBytes</span><span style="color:#24292E;">(), XContentType.JSON)</span></span>
<span class="line"><span style="color:#24292E;">            .</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">();   </span></span>
<span class="line"><span style="color:#24292E;">    }        </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//释放资源        </span></span>
<span class="line"><span style="color:#24292E;">    client.</span><span style="color:#6F42C1;">close</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h3 id="_7-6-2-分页查询" tabindex="-1">7.6.2 分页查询 <a class="header-anchor" href="#_7-6-2-分页查询" aria-label="Permalink to &quot;7.6.2 分页查询&quot;">​</a></h3><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">@</span><span style="color:#F97583;">Test</span></span>
<span class="line"><span style="color:#6A737D;">//分页查询</span></span>
<span class="line"><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">test10</span><span style="color:#E1E4E8;">() throws Exception{    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// 创建Client连接对象    </span></span>
<span class="line"><span style="color:#E1E4E8;">    Settings settings </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> Settings.</span><span style="color:#B392F0;">builder</span><span style="color:#E1E4E8;">().</span><span style="color:#B392F0;">put</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;cluster.name&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;my-elasticsearch&quot;</span><span style="color:#E1E4E8;">).</span><span style="color:#B392F0;">build</span><span style="color:#E1E4E8;">();    </span></span>
<span class="line"><span style="color:#E1E4E8;">    TransportClient client </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">PreBuiltTransportClient</span><span style="color:#E1E4E8;">(settings)        .</span><span style="color:#B392F0;">addTransportAddress</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">InetSocketTransportAddress</span><span style="color:#E1E4E8;">(InetAddress.</span><span style="color:#B392F0;">getByName</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;127.0.0.1&quot;</span><span style="color:#E1E4E8;">), </span><span style="color:#79B8FF;">9300</span><span style="color:#E1E4E8;">));    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// 搜索数据    </span></span>
<span class="line"><span style="color:#E1E4E8;">    SearchRequestBuilder searchRequestBuilder </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> client</span></span>
<span class="line"><span style="color:#E1E4E8;">        .</span><span style="color:#B392F0;">prepareSearch</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;blog2&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">        .</span><span style="color:#B392F0;">setTypes</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;article&quot;</span><span style="color:#E1E4E8;">)        </span></span>
<span class="line"><span style="color:#E1E4E8;">        .</span><span style="color:#B392F0;">setQuery</span><span style="color:#E1E4E8;">(QueryBuilders.</span><span style="color:#B392F0;">matchAllQuery</span><span style="color:#E1E4E8;">());</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// 默认每页10条记录    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// 查询第2页数据，每页20条    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//setFrom()：从第几条开始检索，默认是0。    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//setSize(): 每页最多显示的记录数。    </span></span>
<span class="line"><span style="color:#E1E4E8;">    searchRequestBuilder.</span><span style="color:#B392F0;">setFrom</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">).</span><span style="color:#B392F0;">setSize</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;">);    </span></span>
<span class="line"><span style="color:#E1E4E8;">    SearchResponse searchResponse </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> searchRequestBuilder.</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">();    </span></span>
<span class="line"><span style="color:#E1E4E8;">    SearchHits hits </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> searchResponse.</span><span style="color:#B392F0;">getHits</span><span style="color:#E1E4E8;">(); </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// 获取命中次数，查询结果有多少对象    </span></span>
<span class="line"><span style="color:#E1E4E8;">    System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;查询结果有：&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> hits.</span><span style="color:#B392F0;">getTotalHits</span><span style="color:#E1E4E8;">() </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;条&quot;</span><span style="color:#E1E4E8;">);    </span></span>
<span class="line"><span style="color:#E1E4E8;">    Iterator&lt;</span><span style="color:#F97583;">SearchHit</span><span style="color:#E1E4E8;">&gt; iterator </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> hits.</span><span style="color:#B392F0;">iterator</span><span style="color:#E1E4E8;">();    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">while</span><span style="color:#E1E4E8;"> (iterator.</span><span style="color:#B392F0;">hasNext</span><span style="color:#E1E4E8;">()) {        </span></span>
<span class="line"><span style="color:#E1E4E8;">        SearchHit searchHit </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> iterator.</span><span style="color:#B392F0;">next</span><span style="color:#E1E4E8;">(); </span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#6A737D;">// 每个查询对象        </span></span>
<span class="line"><span style="color:#E1E4E8;">        System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(searchHit.</span><span style="color:#B392F0;">getSourceAsString</span><span style="color:#E1E4E8;">()); </span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#6A737D;">// 获取字符串格式打印        </span></span>
<span class="line"><span style="color:#E1E4E8;">        System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;id:&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> searchHit.</span><span style="color:#B392F0;">getSource</span><span style="color:#E1E4E8;">().</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;id&quot;</span><span style="color:#E1E4E8;">));        </span></span>
<span class="line"><span style="color:#E1E4E8;">        System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;title:&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> searchHit.</span><span style="color:#B392F0;">getSource</span><span style="color:#E1E4E8;">().</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;title&quot;</span><span style="color:#E1E4E8;">));        </span></span>
<span class="line"><span style="color:#E1E4E8;">        System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;content:&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> searchHit.</span><span style="color:#B392F0;">getSource</span><span style="color:#E1E4E8;">().</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;content&quot;</span><span style="color:#E1E4E8;">));        </span></span>
<span class="line"><span style="color:#E1E4E8;">        System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;-----------------------------------------&quot;</span><span style="color:#E1E4E8;">);    </span></span>
<span class="line"><span style="color:#E1E4E8;">    }    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//释放资源    </span></span>
<span class="line"><span style="color:#E1E4E8;">    client.</span><span style="color:#B392F0;">close</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Test</span></span>
<span class="line"><span style="color:#6A737D;">//分页查询</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">test10</span><span style="color:#24292E;">() throws Exception{    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// 创建Client连接对象    </span></span>
<span class="line"><span style="color:#24292E;">    Settings settings </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> Settings.</span><span style="color:#6F42C1;">builder</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">put</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;cluster.name&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;my-elasticsearch&quot;</span><span style="color:#24292E;">).</span><span style="color:#6F42C1;">build</span><span style="color:#24292E;">();    </span></span>
<span class="line"><span style="color:#24292E;">    TransportClient client </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">PreBuiltTransportClient</span><span style="color:#24292E;">(settings)        .</span><span style="color:#6F42C1;">addTransportAddress</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">InetSocketTransportAddress</span><span style="color:#24292E;">(InetAddress.</span><span style="color:#6F42C1;">getByName</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;127.0.0.1&quot;</span><span style="color:#24292E;">), </span><span style="color:#005CC5;">9300</span><span style="color:#24292E;">));    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// 搜索数据    </span></span>
<span class="line"><span style="color:#24292E;">    SearchRequestBuilder searchRequestBuilder </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> client</span></span>
<span class="line"><span style="color:#24292E;">        .</span><span style="color:#6F42C1;">prepareSearch</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;blog2&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">        .</span><span style="color:#6F42C1;">setTypes</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;article&quot;</span><span style="color:#24292E;">)        </span></span>
<span class="line"><span style="color:#24292E;">        .</span><span style="color:#6F42C1;">setQuery</span><span style="color:#24292E;">(QueryBuilders.</span><span style="color:#6F42C1;">matchAllQuery</span><span style="color:#24292E;">());</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// 默认每页10条记录    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// 查询第2页数据，每页20条    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//setFrom()：从第几条开始检索，默认是0。    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//setSize(): 每页最多显示的记录数。    </span></span>
<span class="line"><span style="color:#24292E;">    searchRequestBuilder.</span><span style="color:#6F42C1;">setFrom</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">).</span><span style="color:#6F42C1;">setSize</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">5</span><span style="color:#24292E;">);    </span></span>
<span class="line"><span style="color:#24292E;">    SearchResponse searchResponse </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> searchRequestBuilder.</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">();    </span></span>
<span class="line"><span style="color:#24292E;">    SearchHits hits </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> searchResponse.</span><span style="color:#6F42C1;">getHits</span><span style="color:#24292E;">(); </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// 获取命中次数，查询结果有多少对象    </span></span>
<span class="line"><span style="color:#24292E;">    System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;查询结果有：&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> hits.</span><span style="color:#6F42C1;">getTotalHits</span><span style="color:#24292E;">() </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;条&quot;</span><span style="color:#24292E;">);    </span></span>
<span class="line"><span style="color:#24292E;">    Iterator&lt;</span><span style="color:#D73A49;">SearchHit</span><span style="color:#24292E;">&gt; iterator </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> hits.</span><span style="color:#6F42C1;">iterator</span><span style="color:#24292E;">();    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">while</span><span style="color:#24292E;"> (iterator.</span><span style="color:#6F42C1;">hasNext</span><span style="color:#24292E;">()) {        </span></span>
<span class="line"><span style="color:#24292E;">        SearchHit searchHit </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> iterator.</span><span style="color:#6F42C1;">next</span><span style="color:#24292E;">(); </span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">// 每个查询对象        </span></span>
<span class="line"><span style="color:#24292E;">        System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(searchHit.</span><span style="color:#6F42C1;">getSourceAsString</span><span style="color:#24292E;">()); </span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">// 获取字符串格式打印        </span></span>
<span class="line"><span style="color:#24292E;">        System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;id:&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> searchHit.</span><span style="color:#6F42C1;">getSource</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;id&quot;</span><span style="color:#24292E;">));        </span></span>
<span class="line"><span style="color:#24292E;">        System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;title:&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> searchHit.</span><span style="color:#6F42C1;">getSource</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;title&quot;</span><span style="color:#24292E;">));        </span></span>
<span class="line"><span style="color:#24292E;">        System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;content:&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> searchHit.</span><span style="color:#6F42C1;">getSource</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;content&quot;</span><span style="color:#24292E;">));        </span></span>
<span class="line"><span style="color:#24292E;">        System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;-----------------------------------------&quot;</span><span style="color:#24292E;">);    </span></span>
<span class="line"><span style="color:#24292E;">    }    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//释放资源    </span></span>
<span class="line"><span style="color:#24292E;">    client.</span><span style="color:#6F42C1;">close</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h2 id="_7-7-查询结果高亮操作" tabindex="-1">7.7 查询结果高亮操作 <a class="header-anchor" href="#_7-7-查询结果高亮操作" aria-label="Permalink to &quot;7.7 查询结果高亮操作&quot;">​</a></h2><h3 id="_7-7-1-什么是高亮显示" tabindex="-1">7.7.1 什么是高亮显示 <a class="header-anchor" href="#_7-7-1-什么是高亮显示" aria-label="Permalink to &quot;7.7.1 什么是高亮显示&quot;">​</a></h3><p>在进行关键字搜索时，搜索出的内容中的关键字会显示不同的颜色，称之为高亮</p><h3 id="_7-7-2-高亮显示的html分析" tabindex="-1">7.7.2 高亮显示的html分析 <a class="header-anchor" href="#_7-7-2-高亮显示的html分析" aria-label="Permalink to &quot;7.7.2 高亮显示的html分析&quot;">​</a></h3><p>通过开发者工具查看高亮数据的html代码实现；</p><p>ElasticSearch可以对查询出的内容中关键字部分进行标签和样式的设置，但是你需要告诉ElasticSearch使用什么标签对高亮关键字进行包裹</p><h3 id="_7-7-3-高亮显示代码实现" tabindex="-1">7.7.3 高亮显示代码实现 <a class="header-anchor" href="#_7-7-3-高亮显示代码实现" aria-label="Permalink to &quot;7.7.3 高亮显示代码实现&quot;">​</a></h3><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">@</span><span style="color:#F97583;">Test</span></span>
<span class="line"><span style="color:#6A737D;">//高亮查询</span></span>
<span class="line"><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">test11</span><span style="color:#E1E4E8;">() throws Exception{    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// 创建Client连接对象    </span></span>
<span class="line"><span style="color:#E1E4E8;">    Settings settings </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> Settings.</span><span style="color:#B392F0;">builder</span><span style="color:#E1E4E8;">().</span><span style="color:#B392F0;">put</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;cluster.name&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;my-elasticsearch&quot;</span><span style="color:#E1E4E8;">).</span><span style="color:#B392F0;">build</span><span style="color:#E1E4E8;">();    </span></span>
<span class="line"><span style="color:#E1E4E8;">    TransportClient client </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">PreBuiltTransportClient</span><span style="color:#E1E4E8;">(settings)        .</span><span style="color:#B392F0;">addTransportAddress</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">InetSocketTransportAddress</span><span style="color:#E1E4E8;">(InetAddress.</span><span style="color:#B392F0;">getByName</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;127.0.0.1&quot;</span><span style="color:#E1E4E8;">), </span><span style="color:#79B8FF;">9300</span><span style="color:#E1E4E8;">));    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// 搜索数据    </span></span>
<span class="line"><span style="color:#E1E4E8;">    SearchRequestBuilder searchRequestBuilder </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> client        </span></span>
<span class="line"><span style="color:#E1E4E8;">        .</span><span style="color:#B392F0;">prepareSearch</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;blog2&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">        .</span><span style="color:#B392F0;">setTypes</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;article&quot;</span><span style="color:#E1E4E8;">)        </span></span>
<span class="line"><span style="color:#E1E4E8;">        .</span><span style="color:#B392F0;">setQuery</span><span style="color:#E1E4E8;">(QueryBuilders.</span><span style="color:#B392F0;">termQuery</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;title&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;搜索&quot;</span><span style="color:#E1E4E8;">));    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//设置高亮数据    </span></span>
<span class="line"><span style="color:#E1E4E8;">    HighlightBuilder hiBuilder</span><span style="color:#F97583;">=new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">HighlightBuilder</span><span style="color:#E1E4E8;">();    </span></span>
<span class="line"><span style="color:#E1E4E8;">    hiBuilder.</span><span style="color:#B392F0;">preTags</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;&lt;font style=&#39;color:red&#39;&gt;&quot;</span><span style="color:#E1E4E8;">);    </span></span>
<span class="line"><span style="color:#E1E4E8;">    hiBuilder.</span><span style="color:#B392F0;">postTags</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;&lt;/font&gt;&quot;</span><span style="color:#E1E4E8;">);    </span></span>
<span class="line"><span style="color:#E1E4E8;">    hiBuilder.</span><span style="color:#B392F0;">field</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;title&quot;</span><span style="color:#E1E4E8;">);    </span></span>
<span class="line"><span style="color:#E1E4E8;">    searchRequestBuilder.</span><span style="color:#B392F0;">highlighter</span><span style="color:#E1E4E8;">(hiBuilder);    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//获得查询结果数据    </span></span>
<span class="line"><span style="color:#E1E4E8;">    SearchResponse searchResponse </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> searchRequestBuilder.</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">();    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//获取查询结果集    </span></span>
<span class="line"><span style="color:#E1E4E8;">    SearchHits searchHits </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> searchResponse.</span><span style="color:#B392F0;">getHits</span><span style="color:#E1E4E8;">();    </span></span>
<span class="line"><span style="color:#E1E4E8;">    System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;共搜到:&quot;</span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;">searchHits.</span><span style="color:#B392F0;">getTotalHits</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">+</span><span style="color:#9ECBFF;">&quot;条结果!&quot;</span><span style="color:#E1E4E8;">);    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//遍历结果    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">for</span><span style="color:#E1E4E8;">(SearchHit hit</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;">searchHits){        </span></span>
<span class="line"><span style="color:#E1E4E8;">        System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;String方式打印文档搜索内容:&quot;</span><span style="color:#E1E4E8;">);        </span></span>
<span class="line"><span style="color:#E1E4E8;">        System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(hit.</span><span style="color:#B392F0;">getSourceAsString</span><span style="color:#E1E4E8;">());        </span></span>
<span class="line"><span style="color:#E1E4E8;">        System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;Map方式打印高亮内容&quot;</span><span style="color:#E1E4E8;">);        </span></span>
<span class="line"><span style="color:#E1E4E8;">        System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(hit.</span><span style="color:#B392F0;">getHighlightFields</span><span style="color:#E1E4E8;">());        </span></span>
<span class="line"><span style="color:#E1E4E8;">        System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;遍历高亮集合，打印高亮片段:&quot;</span><span style="color:#E1E4E8;">);        </span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">Text</span><span style="color:#E1E4E8;">[] text </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> hit.</span><span style="color:#B392F0;">getHighlightFields</span><span style="color:#E1E4E8;">().</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;title&quot;</span><span style="color:#E1E4E8;">).</span><span style="color:#B392F0;">getFragments</span><span style="color:#E1E4E8;">();        </span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">for</span><span style="color:#E1E4E8;"> (Text str </span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> text) {            </span></span>
<span class="line"><span style="color:#E1E4E8;">            System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(str);        </span></span>
<span class="line"><span style="color:#E1E4E8;">        }    </span></span>
<span class="line"><span style="color:#E1E4E8;">    }    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//释放资源    </span></span>
<span class="line"><span style="color:#E1E4E8;">    client.</span><span style="color:#B392F0;">close</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Test</span></span>
<span class="line"><span style="color:#6A737D;">//高亮查询</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">test11</span><span style="color:#24292E;">() throws Exception{    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// 创建Client连接对象    </span></span>
<span class="line"><span style="color:#24292E;">    Settings settings </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> Settings.</span><span style="color:#6F42C1;">builder</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">put</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;cluster.name&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;my-elasticsearch&quot;</span><span style="color:#24292E;">).</span><span style="color:#6F42C1;">build</span><span style="color:#24292E;">();    </span></span>
<span class="line"><span style="color:#24292E;">    TransportClient client </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">PreBuiltTransportClient</span><span style="color:#24292E;">(settings)        .</span><span style="color:#6F42C1;">addTransportAddress</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">InetSocketTransportAddress</span><span style="color:#24292E;">(InetAddress.</span><span style="color:#6F42C1;">getByName</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;127.0.0.1&quot;</span><span style="color:#24292E;">), </span><span style="color:#005CC5;">9300</span><span style="color:#24292E;">));    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// 搜索数据    </span></span>
<span class="line"><span style="color:#24292E;">    SearchRequestBuilder searchRequestBuilder </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> client        </span></span>
<span class="line"><span style="color:#24292E;">        .</span><span style="color:#6F42C1;">prepareSearch</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;blog2&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">        .</span><span style="color:#6F42C1;">setTypes</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;article&quot;</span><span style="color:#24292E;">)        </span></span>
<span class="line"><span style="color:#24292E;">        .</span><span style="color:#6F42C1;">setQuery</span><span style="color:#24292E;">(QueryBuilders.</span><span style="color:#6F42C1;">termQuery</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;title&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;搜索&quot;</span><span style="color:#24292E;">));    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//设置高亮数据    </span></span>
<span class="line"><span style="color:#24292E;">    HighlightBuilder hiBuilder</span><span style="color:#D73A49;">=new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">HighlightBuilder</span><span style="color:#24292E;">();    </span></span>
<span class="line"><span style="color:#24292E;">    hiBuilder.</span><span style="color:#6F42C1;">preTags</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;&lt;font style=&#39;color:red&#39;&gt;&quot;</span><span style="color:#24292E;">);    </span></span>
<span class="line"><span style="color:#24292E;">    hiBuilder.</span><span style="color:#6F42C1;">postTags</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;&lt;/font&gt;&quot;</span><span style="color:#24292E;">);    </span></span>
<span class="line"><span style="color:#24292E;">    hiBuilder.</span><span style="color:#6F42C1;">field</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;title&quot;</span><span style="color:#24292E;">);    </span></span>
<span class="line"><span style="color:#24292E;">    searchRequestBuilder.</span><span style="color:#6F42C1;">highlighter</span><span style="color:#24292E;">(hiBuilder);    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//获得查询结果数据    </span></span>
<span class="line"><span style="color:#24292E;">    SearchResponse searchResponse </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> searchRequestBuilder.</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">();    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//获取查询结果集    </span></span>
<span class="line"><span style="color:#24292E;">    SearchHits searchHits </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> searchResponse.</span><span style="color:#6F42C1;">getHits</span><span style="color:#24292E;">();    </span></span>
<span class="line"><span style="color:#24292E;">    System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;共搜到:&quot;</span><span style="color:#D73A49;">+</span><span style="color:#24292E;">searchHits.</span><span style="color:#6F42C1;">getTotalHits</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">+</span><span style="color:#032F62;">&quot;条结果!&quot;</span><span style="color:#24292E;">);    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//遍历结果    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">for</span><span style="color:#24292E;">(SearchHit hit</span><span style="color:#D73A49;">:</span><span style="color:#24292E;">searchHits){        </span></span>
<span class="line"><span style="color:#24292E;">        System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;String方式打印文档搜索内容:&quot;</span><span style="color:#24292E;">);        </span></span>
<span class="line"><span style="color:#24292E;">        System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(hit.</span><span style="color:#6F42C1;">getSourceAsString</span><span style="color:#24292E;">());        </span></span>
<span class="line"><span style="color:#24292E;">        System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;Map方式打印高亮内容&quot;</span><span style="color:#24292E;">);        </span></span>
<span class="line"><span style="color:#24292E;">        System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(hit.</span><span style="color:#6F42C1;">getHighlightFields</span><span style="color:#24292E;">());        </span></span>
<span class="line"><span style="color:#24292E;">        System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;遍历高亮集合，打印高亮片段:&quot;</span><span style="color:#24292E;">);        </span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">Text</span><span style="color:#24292E;">[] text </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> hit.</span><span style="color:#6F42C1;">getHighlightFields</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;title&quot;</span><span style="color:#24292E;">).</span><span style="color:#6F42C1;">getFragments</span><span style="color:#24292E;">();        </span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">for</span><span style="color:#24292E;"> (Text str </span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> text) {            </span></span>
<span class="line"><span style="color:#24292E;">            System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(str);        </span></span>
<span class="line"><span style="color:#24292E;">        }    </span></span>
<span class="line"><span style="color:#24292E;">    }    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//释放资源    </span></span>
<span class="line"><span style="color:#24292E;">    client.</span><span style="color:#6F42C1;">close</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h1 id="第八章-spring-data-elasticsearch" tabindex="-1">第八章 Spring Data ElasticSearch <a class="header-anchor" href="#第八章-spring-data-elasticsearch" aria-label="Permalink to &quot;第八章 Spring Data ElasticSearch&quot;">​</a></h1><h2 id="_8-1-简介" tabindex="-1">8.1 简介 <a class="header-anchor" href="#_8-1-简介" aria-label="Permalink to &quot;8.1 简介&quot;">​</a></h2><h3 id="_8-1-1-什么是spring-data" tabindex="-1">8.1.1 什么是Spring Data <a class="header-anchor" href="#_8-1-1-什么是spring-data" aria-label="Permalink to &quot;8.1.1 什么是Spring Data&quot;">​</a></h3><p>Spring Data是一个用于简化数据库访问，并支持云服务的开源框架。其主要目标是使得对数据的访问变得方便快捷，并支持map-reduce框架和云计算数据服务。 Spring Data可以极大的简化JPA的写法，可以在几乎不用写实现的情况下，实现对数据的访问和操作。除了CRUD外，还包括如分页、排序等一些常用的功能。</p><p>Spring Data的官网：<a href="http://projects.spring.io/spring-data/" target="_blank" rel="noreferrer">http://projects.spring.io/spring-data/</a></p><h3 id="_8-1-2-什么是spring-data-elasticsearch" tabindex="-1">8.1.2 什么是Spring Data ElasticSearch <a class="header-anchor" href="#_8-1-2-什么是spring-data-elasticsearch" aria-label="Permalink to &quot;8.1.2 什么是Spring Data ElasticSearch&quot;">​</a></h3><p>Spring Data ElasticSearch 基于 spring data API 简化 elasticSearch操作，将原始操作elasticSearch的客户端API 进行封装 。Spring Data为Elasticsearch项目提供集成搜索引擎。Spring Data Elasticsearch POJO的关键功能区域为中心的模型与Elastichsearch交互文档和轻松地编写一个存储库数据访问层。</p><p>官方网站：<a href="http://projects.spring.io/spring-data-elasticsearch/" target="_blank" rel="noreferrer">http://projects.spring.io/spring-data-elasticsearch/</a></p><h2 id="_8-2-入门例子" tabindex="-1">8.2 入门例子 <a class="header-anchor" href="#_8-2-入门例子" aria-label="Permalink to &quot;8.2 入门例子&quot;">​</a></h2><p>1）导入Spring Data ElasticSearch坐标</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">&lt;?</span><span style="color:#85E89D;">xml</span><span style="color:#B392F0;"> version</span><span style="color:#E1E4E8;">=</span><span style="color:#9ECBFF;">&quot;1.0&quot;</span><span style="color:#B392F0;"> encoding</span><span style="color:#E1E4E8;">=</span><span style="color:#9ECBFF;">&quot;UTF-8&quot;</span><span style="color:#E1E4E8;">?&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">&lt;</span><span style="color:#85E89D;">project</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">xmlns</span><span style="color:#E1E4E8;">=</span><span style="color:#9ECBFF;">&quot;http://maven.apache.org/POM/4.0.0&quot;</span><span style="color:#E1E4E8;">         </span></span>
<span class="line"><span style="color:#E1E4E8;">         </span><span style="color:#B392F0;">xmlns:xsi</span><span style="color:#E1E4E8;">=</span><span style="color:#9ECBFF;">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><span style="color:#E1E4E8;">         </span></span>
<span class="line"><span style="color:#E1E4E8;">         </span><span style="color:#B392F0;">xsi:schemaLocation</span><span style="color:#E1E4E8;">=</span><span style="color:#9ECBFF;">&quot;http://maven.apache.org/POM/4.0.0 </span></span>
<span class="line"><span style="color:#9ECBFF;">                             http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span><span style="color:#E1E4E8;">&gt;    </span></span>
<span class="line"><span style="color:#E1E4E8;">    &lt;</span><span style="color:#85E89D;">modelVersion</span><span style="color:#E1E4E8;">&gt;4.0.0&lt;/</span><span style="color:#85E89D;">modelVersion</span><span style="color:#E1E4E8;">&gt;    </span></span>
<span class="line"><span style="color:#E1E4E8;">    &lt;</span><span style="color:#85E89D;">groupId</span><span style="color:#E1E4E8;">&gt;com.itheima&lt;/</span><span style="color:#85E89D;">groupId</span><span style="color:#E1E4E8;">&gt;    </span></span>
<span class="line"><span style="color:#E1E4E8;">    &lt;</span><span style="color:#85E89D;">artifactId</span><span style="color:#E1E4E8;">&gt;itheima_elasticsearch_demo3&lt;/</span><span style="color:#85E89D;">artifactId</span><span style="color:#E1E4E8;">&gt;    </span></span>
<span class="line"><span style="color:#E1E4E8;">    &lt;</span><span style="color:#85E89D;">version</span><span style="color:#E1E4E8;">&gt;1.0-SNAPSHOT&lt;/</span><span style="color:#85E89D;">version</span><span style="color:#E1E4E8;">&gt;    </span></span>
<span class="line"><span style="color:#E1E4E8;">    &lt;</span><span style="color:#85E89D;">dependencies</span><span style="color:#E1E4E8;">&gt;        </span></span>
<span class="line"><span style="color:#E1E4E8;">        &lt;</span><span style="color:#85E89D;">dependency</span><span style="color:#E1E4E8;">&gt;            </span></span>
<span class="line"><span style="color:#E1E4E8;">            &lt;</span><span style="color:#85E89D;">groupId</span><span style="color:#E1E4E8;">&gt;org.elasticsearch&lt;/</span><span style="color:#85E89D;">groupId</span><span style="color:#E1E4E8;">&gt;            </span></span>
<span class="line"><span style="color:#E1E4E8;">            &lt;</span><span style="color:#85E89D;">artifactId</span><span style="color:#E1E4E8;">&gt;elasticsearch&lt;/</span><span style="color:#85E89D;">artifactId</span><span style="color:#E1E4E8;">&gt;            </span></span>
<span class="line"><span style="color:#E1E4E8;">            &lt;</span><span style="color:#85E89D;">version</span><span style="color:#E1E4E8;">&gt;5.6.8&lt;/</span><span style="color:#85E89D;">version</span><span style="color:#E1E4E8;">&gt;        </span></span>
<span class="line"><span style="color:#E1E4E8;">        &lt;/</span><span style="color:#85E89D;">dependency</span><span style="color:#E1E4E8;">&gt;        </span></span>
<span class="line"><span style="color:#E1E4E8;">        &lt;</span><span style="color:#85E89D;">dependency</span><span style="color:#E1E4E8;">&gt;            </span></span>
<span class="line"><span style="color:#E1E4E8;">            &lt;</span><span style="color:#85E89D;">groupId</span><span style="color:#E1E4E8;">&gt;org.elasticsearch.client&lt;/</span><span style="color:#85E89D;">groupId</span><span style="color:#E1E4E8;">&gt;            </span></span>
<span class="line"><span style="color:#E1E4E8;">            &lt;</span><span style="color:#85E89D;">artifactId</span><span style="color:#E1E4E8;">&gt;transport&lt;/</span><span style="color:#85E89D;">artifactId</span><span style="color:#E1E4E8;">&gt;            </span></span>
<span class="line"><span style="color:#E1E4E8;">            &lt;</span><span style="color:#85E89D;">version</span><span style="color:#E1E4E8;">&gt;5.6.8&lt;/</span><span style="color:#85E89D;">version</span><span style="color:#E1E4E8;">&gt;        </span></span>
<span class="line"><span style="color:#E1E4E8;">        &lt;/</span><span style="color:#85E89D;">dependency</span><span style="color:#E1E4E8;">&gt;        </span></span>
<span class="line"><span style="color:#E1E4E8;">        &lt;</span><span style="color:#85E89D;">dependency</span><span style="color:#E1E4E8;">&gt;            </span></span>
<span class="line"><span style="color:#E1E4E8;">            &lt;</span><span style="color:#85E89D;">groupId</span><span style="color:#E1E4E8;">&gt;org.apache.logging.log4j&lt;/</span><span style="color:#85E89D;">groupId</span><span style="color:#E1E4E8;">&gt;            </span></span>
<span class="line"><span style="color:#E1E4E8;">            &lt;</span><span style="color:#85E89D;">artifactId</span><span style="color:#E1E4E8;">&gt;log4j-to-slf4j&lt;/</span><span style="color:#85E89D;">artifactId</span><span style="color:#E1E4E8;">&gt;            </span></span>
<span class="line"><span style="color:#E1E4E8;">            &lt;</span><span style="color:#85E89D;">version</span><span style="color:#E1E4E8;">&gt;2.9.1&lt;/</span><span style="color:#85E89D;">version</span><span style="color:#E1E4E8;">&gt;        </span></span>
<span class="line"><span style="color:#E1E4E8;">        &lt;/</span><span style="color:#85E89D;">dependency</span><span style="color:#E1E4E8;">&gt;        </span></span>
<span class="line"><span style="color:#E1E4E8;">        &lt;</span><span style="color:#85E89D;">dependency</span><span style="color:#E1E4E8;">&gt;            </span></span>
<span class="line"><span style="color:#E1E4E8;">            &lt;</span><span style="color:#85E89D;">groupId</span><span style="color:#E1E4E8;">&gt;org.slf4j&lt;/</span><span style="color:#85E89D;">groupId</span><span style="color:#E1E4E8;">&gt;            </span></span>
<span class="line"><span style="color:#E1E4E8;">            &lt;</span><span style="color:#85E89D;">artifactId</span><span style="color:#E1E4E8;">&gt;slf4j-api&lt;/</span><span style="color:#85E89D;">artifactId</span><span style="color:#E1E4E8;">&gt;            </span></span>
<span class="line"><span style="color:#E1E4E8;">            &lt;</span><span style="color:#85E89D;">version</span><span style="color:#E1E4E8;">&gt;1.7.24&lt;/</span><span style="color:#85E89D;">version</span><span style="color:#E1E4E8;">&gt;        </span></span>
<span class="line"><span style="color:#E1E4E8;">        &lt;/</span><span style="color:#85E89D;">dependency</span><span style="color:#E1E4E8;">&gt;        </span></span>
<span class="line"><span style="color:#E1E4E8;">        &lt;</span><span style="color:#85E89D;">dependency</span><span style="color:#E1E4E8;">&gt;            </span></span>
<span class="line"><span style="color:#E1E4E8;">            &lt;</span><span style="color:#85E89D;">groupId</span><span style="color:#E1E4E8;">&gt;org.slf4j&lt;/</span><span style="color:#85E89D;">groupId</span><span style="color:#E1E4E8;">&gt;            </span></span>
<span class="line"><span style="color:#E1E4E8;">            &lt;</span><span style="color:#85E89D;">artifactId</span><span style="color:#E1E4E8;">&gt;slf4j-simple&lt;/</span><span style="color:#85E89D;">artifactId</span><span style="color:#E1E4E8;">&gt;            </span></span>
<span class="line"><span style="color:#E1E4E8;">            &lt;</span><span style="color:#85E89D;">version</span><span style="color:#E1E4E8;">&gt;1.7.21&lt;/</span><span style="color:#85E89D;">version</span><span style="color:#E1E4E8;">&gt;        </span></span>
<span class="line"><span style="color:#E1E4E8;">        &lt;/</span><span style="color:#85E89D;">dependency</span><span style="color:#E1E4E8;">&gt;        </span></span>
<span class="line"><span style="color:#E1E4E8;">        &lt;</span><span style="color:#85E89D;">dependency</span><span style="color:#E1E4E8;">&gt;            </span></span>
<span class="line"><span style="color:#E1E4E8;">            &lt;</span><span style="color:#85E89D;">groupId</span><span style="color:#E1E4E8;">&gt;log4j&lt;/</span><span style="color:#85E89D;">groupId</span><span style="color:#E1E4E8;">&gt;            </span></span>
<span class="line"><span style="color:#E1E4E8;">            &lt;</span><span style="color:#85E89D;">artifactId</span><span style="color:#E1E4E8;">&gt;log4j&lt;/</span><span style="color:#85E89D;">artifactId</span><span style="color:#E1E4E8;">&gt;            </span></span>
<span class="line"><span style="color:#E1E4E8;">            &lt;</span><span style="color:#85E89D;">version</span><span style="color:#E1E4E8;">&gt;1.2.12&lt;/</span><span style="color:#85E89D;">version</span><span style="color:#E1E4E8;">&gt;        </span></span>
<span class="line"><span style="color:#E1E4E8;">        &lt;/</span><span style="color:#85E89D;">dependency</span><span style="color:#E1E4E8;">&gt;        </span></span>
<span class="line"><span style="color:#E1E4E8;">        &lt;</span><span style="color:#85E89D;">dependency</span><span style="color:#E1E4E8;">&gt;            </span></span>
<span class="line"><span style="color:#E1E4E8;">            &lt;</span><span style="color:#85E89D;">groupId</span><span style="color:#E1E4E8;">&gt;junit&lt;/</span><span style="color:#85E89D;">groupId</span><span style="color:#E1E4E8;">&gt;            </span></span>
<span class="line"><span style="color:#E1E4E8;">            &lt;</span><span style="color:#85E89D;">artifactId</span><span style="color:#E1E4E8;">&gt;junit&lt;/</span><span style="color:#85E89D;">artifactId</span><span style="color:#E1E4E8;">&gt;            </span></span>
<span class="line"><span style="color:#E1E4E8;">            &lt;</span><span style="color:#85E89D;">version</span><span style="color:#E1E4E8;">&gt;4.12&lt;/</span><span style="color:#85E89D;">version</span><span style="color:#E1E4E8;">&gt;        </span></span>
<span class="line"><span style="color:#E1E4E8;">        &lt;/</span><span style="color:#85E89D;">dependency</span><span style="color:#E1E4E8;">&gt;        </span></span>
<span class="line"><span style="color:#E1E4E8;">        &lt;</span><span style="color:#85E89D;">dependency</span><span style="color:#E1E4E8;">&gt;            </span></span>
<span class="line"><span style="color:#E1E4E8;">            &lt;</span><span style="color:#85E89D;">groupId</span><span style="color:#E1E4E8;">&gt;com.fasterxml.jackson.core&lt;/</span><span style="color:#85E89D;">groupId</span><span style="color:#E1E4E8;">&gt;            </span></span>
<span class="line"><span style="color:#E1E4E8;">            &lt;</span><span style="color:#85E89D;">artifactId</span><span style="color:#E1E4E8;">&gt;jackson-core&lt;/</span><span style="color:#85E89D;">artifactId</span><span style="color:#E1E4E8;">&gt;            </span></span>
<span class="line"><span style="color:#E1E4E8;">            &lt;</span><span style="color:#85E89D;">version</span><span style="color:#E1E4E8;">&gt;2.8.1&lt;/</span><span style="color:#85E89D;">version</span><span style="color:#E1E4E8;">&gt;        </span></span>
<span class="line"><span style="color:#E1E4E8;">        &lt;/</span><span style="color:#85E89D;">dependency</span><span style="color:#E1E4E8;">&gt;        </span></span>
<span class="line"><span style="color:#E1E4E8;">        &lt;</span><span style="color:#85E89D;">dependency</span><span style="color:#E1E4E8;">&gt;            </span></span>
<span class="line"><span style="color:#E1E4E8;">            &lt;</span><span style="color:#85E89D;">groupId</span><span style="color:#E1E4E8;">&gt;com.fasterxml.jackson.core&lt;/</span><span style="color:#85E89D;">groupId</span><span style="color:#E1E4E8;">&gt;            </span></span>
<span class="line"><span style="color:#E1E4E8;">            &lt;</span><span style="color:#85E89D;">artifactId</span><span style="color:#E1E4E8;">&gt;jackson-databind&lt;/</span><span style="color:#85E89D;">artifactId</span><span style="color:#E1E4E8;">&gt;            </span></span>
<span class="line"><span style="color:#E1E4E8;">            &lt;</span><span style="color:#85E89D;">version</span><span style="color:#E1E4E8;">&gt;2.8.1&lt;/</span><span style="color:#85E89D;">version</span><span style="color:#E1E4E8;">&gt;        </span></span>
<span class="line"><span style="color:#E1E4E8;">        &lt;/</span><span style="color:#85E89D;">dependency</span><span style="color:#E1E4E8;">&gt;        </span></span>
<span class="line"><span style="color:#E1E4E8;">        &lt;</span><span style="color:#85E89D;">dependency</span><span style="color:#E1E4E8;">&gt;            </span></span>
<span class="line"><span style="color:#E1E4E8;">            &lt;</span><span style="color:#85E89D;">groupId</span><span style="color:#E1E4E8;">&gt;com.fasterxml.jackson.core&lt;/</span><span style="color:#85E89D;">groupId</span><span style="color:#E1E4E8;">&gt;           </span></span>
<span class="line"><span style="color:#E1E4E8;">            &lt;</span><span style="color:#85E89D;">artifactId</span><span style="color:#E1E4E8;">&gt;jackson-annotations&lt;/</span><span style="color:#85E89D;">artifactId</span><span style="color:#E1E4E8;">&gt;            </span></span>
<span class="line"><span style="color:#E1E4E8;">            &lt;</span><span style="color:#85E89D;">version</span><span style="color:#E1E4E8;">&gt;2.8.1&lt;/</span><span style="color:#85E89D;">version</span><span style="color:#E1E4E8;">&gt;        </span></span>
<span class="line"><span style="color:#E1E4E8;">        &lt;/</span><span style="color:#85E89D;">dependency</span><span style="color:#E1E4E8;">&gt;        </span></span>
<span class="line"><span style="color:#E1E4E8;">        &lt;</span><span style="color:#85E89D;">dependency</span><span style="color:#E1E4E8;">&gt;            </span></span>
<span class="line"><span style="color:#E1E4E8;">            &lt;</span><span style="color:#85E89D;">groupId</span><span style="color:#E1E4E8;">&gt;org.springframework.data&lt;/</span><span style="color:#85E89D;">groupId</span><span style="color:#E1E4E8;">&gt;            </span></span>
<span class="line"><span style="color:#E1E4E8;">            &lt;</span><span style="color:#85E89D;">artifactId</span><span style="color:#E1E4E8;">&gt;spring-data-elasticsearch&lt;/</span><span style="color:#85E89D;">artifactId</span><span style="color:#E1E4E8;">&gt;            </span></span>
<span class="line"><span style="color:#E1E4E8;">            &lt;</span><span style="color:#85E89D;">version</span><span style="color:#E1E4E8;">&gt;3.0.5.RELEASE&lt;/</span><span style="color:#85E89D;">version</span><span style="color:#E1E4E8;">&gt;            </span></span>
<span class="line"><span style="color:#E1E4E8;">            &lt;</span><span style="color:#85E89D;">exclusions</span><span style="color:#E1E4E8;">&gt;                </span></span>
<span class="line"><span style="color:#E1E4E8;">                &lt;</span><span style="color:#85E89D;">exclusion</span><span style="color:#E1E4E8;">&gt;                    </span></span>
<span class="line"><span style="color:#E1E4E8;">                    &lt;</span><span style="color:#85E89D;">groupId</span><span style="color:#E1E4E8;">&gt;org.elasticsearch.plugin&lt;/</span><span style="color:#85E89D;">groupId</span><span style="color:#E1E4E8;">&gt;                    </span></span>
<span class="line"><span style="color:#E1E4E8;">                    &lt;</span><span style="color:#85E89D;">artifactId</span><span style="color:#E1E4E8;">&gt;transport-netty4-client&lt;/</span><span style="color:#85E89D;">artifactId</span><span style="color:#E1E4E8;">&gt;                </span></span>
<span class="line"><span style="color:#E1E4E8;">                &lt;/</span><span style="color:#85E89D;">exclusion</span><span style="color:#E1E4E8;">&gt;            </span></span>
<span class="line"><span style="color:#E1E4E8;">            &lt;/</span><span style="color:#85E89D;">exclusions</span><span style="color:#E1E4E8;">&gt;        </span></span>
<span class="line"><span style="color:#E1E4E8;">        &lt;/</span><span style="color:#85E89D;">dependency</span><span style="color:#E1E4E8;">&gt;        </span></span>
<span class="line"><span style="color:#E1E4E8;">        &lt;</span><span style="color:#85E89D;">dependency</span><span style="color:#E1E4E8;">&gt;           </span></span>
<span class="line"><span style="color:#E1E4E8;">            &lt;</span><span style="color:#85E89D;">groupId</span><span style="color:#E1E4E8;">&gt;org.springframework&lt;/</span><span style="color:#85E89D;">groupId</span><span style="color:#E1E4E8;">&gt;            </span></span>
<span class="line"><span style="color:#E1E4E8;">            &lt;</span><span style="color:#85E89D;">artifactId</span><span style="color:#E1E4E8;">&gt;spring-test&lt;/</span><span style="color:#85E89D;">artifactId</span><span style="color:#E1E4E8;">&gt;           </span></span>
<span class="line"><span style="color:#E1E4E8;">            &lt;</span><span style="color:#85E89D;">version</span><span style="color:#E1E4E8;">&gt;5.0.4.RELEASE&lt;/</span><span style="color:#85E89D;">version</span><span style="color:#E1E4E8;">&gt;       </span></span>
<span class="line"><span style="color:#E1E4E8;">        &lt;/</span><span style="color:#85E89D;">dependency</span><span style="color:#E1E4E8;">&gt;   </span></span>
<span class="line"><span style="color:#E1E4E8;">    &lt;/</span><span style="color:#85E89D;">dependencies</span><span style="color:#E1E4E8;">&gt;    </span></span>
<span class="line"><span style="color:#E1E4E8;">&lt;/</span><span style="color:#85E89D;">project</span><span style="color:#E1E4E8;">&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">&lt;?</span><span style="color:#22863A;">xml</span><span style="color:#6F42C1;"> version</span><span style="color:#24292E;">=</span><span style="color:#032F62;">&quot;1.0&quot;</span><span style="color:#6F42C1;"> encoding</span><span style="color:#24292E;">=</span><span style="color:#032F62;">&quot;UTF-8&quot;</span><span style="color:#24292E;">?&gt;</span></span>
<span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">project</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">xmlns</span><span style="color:#24292E;">=</span><span style="color:#032F62;">&quot;http://maven.apache.org/POM/4.0.0&quot;</span><span style="color:#24292E;">         </span></span>
<span class="line"><span style="color:#24292E;">         </span><span style="color:#6F42C1;">xmlns:xsi</span><span style="color:#24292E;">=</span><span style="color:#032F62;">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><span style="color:#24292E;">         </span></span>
<span class="line"><span style="color:#24292E;">         </span><span style="color:#6F42C1;">xsi:schemaLocation</span><span style="color:#24292E;">=</span><span style="color:#032F62;">&quot;http://maven.apache.org/POM/4.0.0 </span></span>
<span class="line"><span style="color:#032F62;">                             http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span><span style="color:#24292E;">&gt;    </span></span>
<span class="line"><span style="color:#24292E;">    &lt;</span><span style="color:#22863A;">modelVersion</span><span style="color:#24292E;">&gt;4.0.0&lt;/</span><span style="color:#22863A;">modelVersion</span><span style="color:#24292E;">&gt;    </span></span>
<span class="line"><span style="color:#24292E;">    &lt;</span><span style="color:#22863A;">groupId</span><span style="color:#24292E;">&gt;com.itheima&lt;/</span><span style="color:#22863A;">groupId</span><span style="color:#24292E;">&gt;    </span></span>
<span class="line"><span style="color:#24292E;">    &lt;</span><span style="color:#22863A;">artifactId</span><span style="color:#24292E;">&gt;itheima_elasticsearch_demo3&lt;/</span><span style="color:#22863A;">artifactId</span><span style="color:#24292E;">&gt;    </span></span>
<span class="line"><span style="color:#24292E;">    &lt;</span><span style="color:#22863A;">version</span><span style="color:#24292E;">&gt;1.0-SNAPSHOT&lt;/</span><span style="color:#22863A;">version</span><span style="color:#24292E;">&gt;    </span></span>
<span class="line"><span style="color:#24292E;">    &lt;</span><span style="color:#22863A;">dependencies</span><span style="color:#24292E;">&gt;        </span></span>
<span class="line"><span style="color:#24292E;">        &lt;</span><span style="color:#22863A;">dependency</span><span style="color:#24292E;">&gt;            </span></span>
<span class="line"><span style="color:#24292E;">            &lt;</span><span style="color:#22863A;">groupId</span><span style="color:#24292E;">&gt;org.elasticsearch&lt;/</span><span style="color:#22863A;">groupId</span><span style="color:#24292E;">&gt;            </span></span>
<span class="line"><span style="color:#24292E;">            &lt;</span><span style="color:#22863A;">artifactId</span><span style="color:#24292E;">&gt;elasticsearch&lt;/</span><span style="color:#22863A;">artifactId</span><span style="color:#24292E;">&gt;            </span></span>
<span class="line"><span style="color:#24292E;">            &lt;</span><span style="color:#22863A;">version</span><span style="color:#24292E;">&gt;5.6.8&lt;/</span><span style="color:#22863A;">version</span><span style="color:#24292E;">&gt;        </span></span>
<span class="line"><span style="color:#24292E;">        &lt;/</span><span style="color:#22863A;">dependency</span><span style="color:#24292E;">&gt;        </span></span>
<span class="line"><span style="color:#24292E;">        &lt;</span><span style="color:#22863A;">dependency</span><span style="color:#24292E;">&gt;            </span></span>
<span class="line"><span style="color:#24292E;">            &lt;</span><span style="color:#22863A;">groupId</span><span style="color:#24292E;">&gt;org.elasticsearch.client&lt;/</span><span style="color:#22863A;">groupId</span><span style="color:#24292E;">&gt;            </span></span>
<span class="line"><span style="color:#24292E;">            &lt;</span><span style="color:#22863A;">artifactId</span><span style="color:#24292E;">&gt;transport&lt;/</span><span style="color:#22863A;">artifactId</span><span style="color:#24292E;">&gt;            </span></span>
<span class="line"><span style="color:#24292E;">            &lt;</span><span style="color:#22863A;">version</span><span style="color:#24292E;">&gt;5.6.8&lt;/</span><span style="color:#22863A;">version</span><span style="color:#24292E;">&gt;        </span></span>
<span class="line"><span style="color:#24292E;">        &lt;/</span><span style="color:#22863A;">dependency</span><span style="color:#24292E;">&gt;        </span></span>
<span class="line"><span style="color:#24292E;">        &lt;</span><span style="color:#22863A;">dependency</span><span style="color:#24292E;">&gt;            </span></span>
<span class="line"><span style="color:#24292E;">            &lt;</span><span style="color:#22863A;">groupId</span><span style="color:#24292E;">&gt;org.apache.logging.log4j&lt;/</span><span style="color:#22863A;">groupId</span><span style="color:#24292E;">&gt;            </span></span>
<span class="line"><span style="color:#24292E;">            &lt;</span><span style="color:#22863A;">artifactId</span><span style="color:#24292E;">&gt;log4j-to-slf4j&lt;/</span><span style="color:#22863A;">artifactId</span><span style="color:#24292E;">&gt;            </span></span>
<span class="line"><span style="color:#24292E;">            &lt;</span><span style="color:#22863A;">version</span><span style="color:#24292E;">&gt;2.9.1&lt;/</span><span style="color:#22863A;">version</span><span style="color:#24292E;">&gt;        </span></span>
<span class="line"><span style="color:#24292E;">        &lt;/</span><span style="color:#22863A;">dependency</span><span style="color:#24292E;">&gt;        </span></span>
<span class="line"><span style="color:#24292E;">        &lt;</span><span style="color:#22863A;">dependency</span><span style="color:#24292E;">&gt;            </span></span>
<span class="line"><span style="color:#24292E;">            &lt;</span><span style="color:#22863A;">groupId</span><span style="color:#24292E;">&gt;org.slf4j&lt;/</span><span style="color:#22863A;">groupId</span><span style="color:#24292E;">&gt;            </span></span>
<span class="line"><span style="color:#24292E;">            &lt;</span><span style="color:#22863A;">artifactId</span><span style="color:#24292E;">&gt;slf4j-api&lt;/</span><span style="color:#22863A;">artifactId</span><span style="color:#24292E;">&gt;            </span></span>
<span class="line"><span style="color:#24292E;">            &lt;</span><span style="color:#22863A;">version</span><span style="color:#24292E;">&gt;1.7.24&lt;/</span><span style="color:#22863A;">version</span><span style="color:#24292E;">&gt;        </span></span>
<span class="line"><span style="color:#24292E;">        &lt;/</span><span style="color:#22863A;">dependency</span><span style="color:#24292E;">&gt;        </span></span>
<span class="line"><span style="color:#24292E;">        &lt;</span><span style="color:#22863A;">dependency</span><span style="color:#24292E;">&gt;            </span></span>
<span class="line"><span style="color:#24292E;">            &lt;</span><span style="color:#22863A;">groupId</span><span style="color:#24292E;">&gt;org.slf4j&lt;/</span><span style="color:#22863A;">groupId</span><span style="color:#24292E;">&gt;            </span></span>
<span class="line"><span style="color:#24292E;">            &lt;</span><span style="color:#22863A;">artifactId</span><span style="color:#24292E;">&gt;slf4j-simple&lt;/</span><span style="color:#22863A;">artifactId</span><span style="color:#24292E;">&gt;            </span></span>
<span class="line"><span style="color:#24292E;">            &lt;</span><span style="color:#22863A;">version</span><span style="color:#24292E;">&gt;1.7.21&lt;/</span><span style="color:#22863A;">version</span><span style="color:#24292E;">&gt;        </span></span>
<span class="line"><span style="color:#24292E;">        &lt;/</span><span style="color:#22863A;">dependency</span><span style="color:#24292E;">&gt;        </span></span>
<span class="line"><span style="color:#24292E;">        &lt;</span><span style="color:#22863A;">dependency</span><span style="color:#24292E;">&gt;            </span></span>
<span class="line"><span style="color:#24292E;">            &lt;</span><span style="color:#22863A;">groupId</span><span style="color:#24292E;">&gt;log4j&lt;/</span><span style="color:#22863A;">groupId</span><span style="color:#24292E;">&gt;            </span></span>
<span class="line"><span style="color:#24292E;">            &lt;</span><span style="color:#22863A;">artifactId</span><span style="color:#24292E;">&gt;log4j&lt;/</span><span style="color:#22863A;">artifactId</span><span style="color:#24292E;">&gt;            </span></span>
<span class="line"><span style="color:#24292E;">            &lt;</span><span style="color:#22863A;">version</span><span style="color:#24292E;">&gt;1.2.12&lt;/</span><span style="color:#22863A;">version</span><span style="color:#24292E;">&gt;        </span></span>
<span class="line"><span style="color:#24292E;">        &lt;/</span><span style="color:#22863A;">dependency</span><span style="color:#24292E;">&gt;        </span></span>
<span class="line"><span style="color:#24292E;">        &lt;</span><span style="color:#22863A;">dependency</span><span style="color:#24292E;">&gt;            </span></span>
<span class="line"><span style="color:#24292E;">            &lt;</span><span style="color:#22863A;">groupId</span><span style="color:#24292E;">&gt;junit&lt;/</span><span style="color:#22863A;">groupId</span><span style="color:#24292E;">&gt;            </span></span>
<span class="line"><span style="color:#24292E;">            &lt;</span><span style="color:#22863A;">artifactId</span><span style="color:#24292E;">&gt;junit&lt;/</span><span style="color:#22863A;">artifactId</span><span style="color:#24292E;">&gt;            </span></span>
<span class="line"><span style="color:#24292E;">            &lt;</span><span style="color:#22863A;">version</span><span style="color:#24292E;">&gt;4.12&lt;/</span><span style="color:#22863A;">version</span><span style="color:#24292E;">&gt;        </span></span>
<span class="line"><span style="color:#24292E;">        &lt;/</span><span style="color:#22863A;">dependency</span><span style="color:#24292E;">&gt;        </span></span>
<span class="line"><span style="color:#24292E;">        &lt;</span><span style="color:#22863A;">dependency</span><span style="color:#24292E;">&gt;            </span></span>
<span class="line"><span style="color:#24292E;">            &lt;</span><span style="color:#22863A;">groupId</span><span style="color:#24292E;">&gt;com.fasterxml.jackson.core&lt;/</span><span style="color:#22863A;">groupId</span><span style="color:#24292E;">&gt;            </span></span>
<span class="line"><span style="color:#24292E;">            &lt;</span><span style="color:#22863A;">artifactId</span><span style="color:#24292E;">&gt;jackson-core&lt;/</span><span style="color:#22863A;">artifactId</span><span style="color:#24292E;">&gt;            </span></span>
<span class="line"><span style="color:#24292E;">            &lt;</span><span style="color:#22863A;">version</span><span style="color:#24292E;">&gt;2.8.1&lt;/</span><span style="color:#22863A;">version</span><span style="color:#24292E;">&gt;        </span></span>
<span class="line"><span style="color:#24292E;">        &lt;/</span><span style="color:#22863A;">dependency</span><span style="color:#24292E;">&gt;        </span></span>
<span class="line"><span style="color:#24292E;">        &lt;</span><span style="color:#22863A;">dependency</span><span style="color:#24292E;">&gt;            </span></span>
<span class="line"><span style="color:#24292E;">            &lt;</span><span style="color:#22863A;">groupId</span><span style="color:#24292E;">&gt;com.fasterxml.jackson.core&lt;/</span><span style="color:#22863A;">groupId</span><span style="color:#24292E;">&gt;            </span></span>
<span class="line"><span style="color:#24292E;">            &lt;</span><span style="color:#22863A;">artifactId</span><span style="color:#24292E;">&gt;jackson-databind&lt;/</span><span style="color:#22863A;">artifactId</span><span style="color:#24292E;">&gt;            </span></span>
<span class="line"><span style="color:#24292E;">            &lt;</span><span style="color:#22863A;">version</span><span style="color:#24292E;">&gt;2.8.1&lt;/</span><span style="color:#22863A;">version</span><span style="color:#24292E;">&gt;        </span></span>
<span class="line"><span style="color:#24292E;">        &lt;/</span><span style="color:#22863A;">dependency</span><span style="color:#24292E;">&gt;        </span></span>
<span class="line"><span style="color:#24292E;">        &lt;</span><span style="color:#22863A;">dependency</span><span style="color:#24292E;">&gt;            </span></span>
<span class="line"><span style="color:#24292E;">            &lt;</span><span style="color:#22863A;">groupId</span><span style="color:#24292E;">&gt;com.fasterxml.jackson.core&lt;/</span><span style="color:#22863A;">groupId</span><span style="color:#24292E;">&gt;           </span></span>
<span class="line"><span style="color:#24292E;">            &lt;</span><span style="color:#22863A;">artifactId</span><span style="color:#24292E;">&gt;jackson-annotations&lt;/</span><span style="color:#22863A;">artifactId</span><span style="color:#24292E;">&gt;            </span></span>
<span class="line"><span style="color:#24292E;">            &lt;</span><span style="color:#22863A;">version</span><span style="color:#24292E;">&gt;2.8.1&lt;/</span><span style="color:#22863A;">version</span><span style="color:#24292E;">&gt;        </span></span>
<span class="line"><span style="color:#24292E;">        &lt;/</span><span style="color:#22863A;">dependency</span><span style="color:#24292E;">&gt;        </span></span>
<span class="line"><span style="color:#24292E;">        &lt;</span><span style="color:#22863A;">dependency</span><span style="color:#24292E;">&gt;            </span></span>
<span class="line"><span style="color:#24292E;">            &lt;</span><span style="color:#22863A;">groupId</span><span style="color:#24292E;">&gt;org.springframework.data&lt;/</span><span style="color:#22863A;">groupId</span><span style="color:#24292E;">&gt;            </span></span>
<span class="line"><span style="color:#24292E;">            &lt;</span><span style="color:#22863A;">artifactId</span><span style="color:#24292E;">&gt;spring-data-elasticsearch&lt;/</span><span style="color:#22863A;">artifactId</span><span style="color:#24292E;">&gt;            </span></span>
<span class="line"><span style="color:#24292E;">            &lt;</span><span style="color:#22863A;">version</span><span style="color:#24292E;">&gt;3.0.5.RELEASE&lt;/</span><span style="color:#22863A;">version</span><span style="color:#24292E;">&gt;            </span></span>
<span class="line"><span style="color:#24292E;">            &lt;</span><span style="color:#22863A;">exclusions</span><span style="color:#24292E;">&gt;                </span></span>
<span class="line"><span style="color:#24292E;">                &lt;</span><span style="color:#22863A;">exclusion</span><span style="color:#24292E;">&gt;                    </span></span>
<span class="line"><span style="color:#24292E;">                    &lt;</span><span style="color:#22863A;">groupId</span><span style="color:#24292E;">&gt;org.elasticsearch.plugin&lt;/</span><span style="color:#22863A;">groupId</span><span style="color:#24292E;">&gt;                    </span></span>
<span class="line"><span style="color:#24292E;">                    &lt;</span><span style="color:#22863A;">artifactId</span><span style="color:#24292E;">&gt;transport-netty4-client&lt;/</span><span style="color:#22863A;">artifactId</span><span style="color:#24292E;">&gt;                </span></span>
<span class="line"><span style="color:#24292E;">                &lt;/</span><span style="color:#22863A;">exclusion</span><span style="color:#24292E;">&gt;            </span></span>
<span class="line"><span style="color:#24292E;">            &lt;/</span><span style="color:#22863A;">exclusions</span><span style="color:#24292E;">&gt;        </span></span>
<span class="line"><span style="color:#24292E;">        &lt;/</span><span style="color:#22863A;">dependency</span><span style="color:#24292E;">&gt;        </span></span>
<span class="line"><span style="color:#24292E;">        &lt;</span><span style="color:#22863A;">dependency</span><span style="color:#24292E;">&gt;           </span></span>
<span class="line"><span style="color:#24292E;">            &lt;</span><span style="color:#22863A;">groupId</span><span style="color:#24292E;">&gt;org.springframework&lt;/</span><span style="color:#22863A;">groupId</span><span style="color:#24292E;">&gt;            </span></span>
<span class="line"><span style="color:#24292E;">            &lt;</span><span style="color:#22863A;">artifactId</span><span style="color:#24292E;">&gt;spring-test&lt;/</span><span style="color:#22863A;">artifactId</span><span style="color:#24292E;">&gt;           </span></span>
<span class="line"><span style="color:#24292E;">            &lt;</span><span style="color:#22863A;">version</span><span style="color:#24292E;">&gt;5.0.4.RELEASE&lt;/</span><span style="color:#22863A;">version</span><span style="color:#24292E;">&gt;       </span></span>
<span class="line"><span style="color:#24292E;">        &lt;/</span><span style="color:#22863A;">dependency</span><span style="color:#24292E;">&gt;   </span></span>
<span class="line"><span style="color:#24292E;">    &lt;/</span><span style="color:#22863A;">dependencies</span><span style="color:#24292E;">&gt;    </span></span>
<span class="line"><span style="color:#24292E;">&lt;/</span><span style="color:#22863A;">project</span><span style="color:#24292E;">&gt;</span></span></code></pre></div><p>2）创建applicationContext.xml配置文件，引入elasticsearch命名空间</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">&lt;?</span><span style="color:#85E89D;">xml</span><span style="color:#B392F0;"> version</span><span style="color:#E1E4E8;">=</span><span style="color:#9ECBFF;">&quot;1.0&quot;</span><span style="color:#B392F0;"> encoding</span><span style="color:#E1E4E8;">=</span><span style="color:#9ECBFF;">&quot;UTF-8&quot;</span><span style="color:#E1E4E8;">?&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">&lt;</span><span style="color:#85E89D;">beans</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">xmlns</span><span style="color:#E1E4E8;">=</span><span style="color:#9ECBFF;">&quot;http://www.springframework.org/schema/beans&quot;</span><span style="color:#E1E4E8;">	</span></span>
<span class="line"><span style="color:#E1E4E8;">       </span><span style="color:#B392F0;">xmlns:xsi</span><span style="color:#E1E4E8;">=</span><span style="color:#9ECBFF;">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><span style="color:#E1E4E8;">	</span></span>
<span class="line"><span style="color:#E1E4E8;">       </span><span style="color:#B392F0;">xmlns:context</span><span style="color:#E1E4E8;">=</span><span style="color:#9ECBFF;">&quot;http://www.springframework.org/schema/context&quot;</span><span style="color:#E1E4E8;">	</span></span>
<span class="line"><span style="color:#E1E4E8;">       </span><span style="color:#B392F0;">xmlns:elasticsearch</span><span style="color:#E1E4E8;">=</span><span style="color:#9ECBFF;">&quot;http://www.springframework.org/schema/data/elasticsearch&quot;</span><span style="color:#E1E4E8;">	</span></span>
<span class="line"><span style="color:#E1E4E8;">       </span><span style="color:#B392F0;">xsi:schemaLocation</span><span style="color:#E1E4E8;">=</span><span style="color:#9ECBFF;">&quot;http://www.springframework.org/schema/beans 		http://www.springframework.org/schema/beans/spring-beans.xsd		http://www.springframework.org/schema/context 		http://www.springframework.org/schema/context/spring-context.xsd		http://www.springframework.org/schema/data/elasticsearch		http://www.springframework.org/schema/data/elasticsearch/spring-elasticsearch-1.0.xsd		&quot;</span><span style="color:#E1E4E8;">&gt;		</span></span>
<span class="line"><span style="color:#E1E4E8;">&lt;/</span><span style="color:#85E89D;">beans</span><span style="color:#E1E4E8;">&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">&lt;?</span><span style="color:#22863A;">xml</span><span style="color:#6F42C1;"> version</span><span style="color:#24292E;">=</span><span style="color:#032F62;">&quot;1.0&quot;</span><span style="color:#6F42C1;"> encoding</span><span style="color:#24292E;">=</span><span style="color:#032F62;">&quot;UTF-8&quot;</span><span style="color:#24292E;">?&gt;</span></span>
<span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">beans</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">xmlns</span><span style="color:#24292E;">=</span><span style="color:#032F62;">&quot;http://www.springframework.org/schema/beans&quot;</span><span style="color:#24292E;">	</span></span>
<span class="line"><span style="color:#24292E;">       </span><span style="color:#6F42C1;">xmlns:xsi</span><span style="color:#24292E;">=</span><span style="color:#032F62;">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><span style="color:#24292E;">	</span></span>
<span class="line"><span style="color:#24292E;">       </span><span style="color:#6F42C1;">xmlns:context</span><span style="color:#24292E;">=</span><span style="color:#032F62;">&quot;http://www.springframework.org/schema/context&quot;</span><span style="color:#24292E;">	</span></span>
<span class="line"><span style="color:#24292E;">       </span><span style="color:#6F42C1;">xmlns:elasticsearch</span><span style="color:#24292E;">=</span><span style="color:#032F62;">&quot;http://www.springframework.org/schema/data/elasticsearch&quot;</span><span style="color:#24292E;">	</span></span>
<span class="line"><span style="color:#24292E;">       </span><span style="color:#6F42C1;">xsi:schemaLocation</span><span style="color:#24292E;">=</span><span style="color:#032F62;">&quot;http://www.springframework.org/schema/beans 		http://www.springframework.org/schema/beans/spring-beans.xsd		http://www.springframework.org/schema/context 		http://www.springframework.org/schema/context/spring-context.xsd		http://www.springframework.org/schema/data/elasticsearch		http://www.springframework.org/schema/data/elasticsearch/spring-elasticsearch-1.0.xsd		&quot;</span><span style="color:#24292E;">&gt;		</span></span>
<span class="line"><span style="color:#24292E;">&lt;/</span><span style="color:#22863A;">beans</span><span style="color:#24292E;">&gt;</span></span></code></pre></div><p>3）编写实体Article</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">package</span><span style="color:#E1E4E8;"> com.itheima.domain;</span></span>
<span class="line"><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Article</span><span style="color:#E1E4E8;"> {    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">private</span><span style="color:#E1E4E8;"> Integer id;    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">private</span><span style="color:#E1E4E8;"> String title;    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">private</span><span style="color:#E1E4E8;"> String content;    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// Setter Getter toString</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">package</span><span style="color:#24292E;"> com.itheima.domain;</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Article</span><span style="color:#24292E;"> {    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> Integer id;    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> String title;    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> String content;    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// Setter Getter toString</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p>4）编写Dao</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">package</span><span style="color:#E1E4E8;"> com.itheima.dao;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> com.itheima.domain.Article;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> org.springframework.data.elasticsearch.repository.ElasticsearchRepository;</span></span>
<span class="line"><span style="color:#E1E4E8;">@</span><span style="color:#F97583;">Repository</span></span>
<span class="line"><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">interface</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">ArticleRepository</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">extends</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">ElasticsearchRepository</span><span style="color:#E1E4E8;">&lt;</span><span style="color:#F97583;">Article</span><span style="color:#E1E4E8;">, </span><span style="color:#F97583;">Integer</span><span style="color:#E1E4E8;">&gt; {}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">package</span><span style="color:#24292E;"> com.itheima.dao;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> com.itheima.domain.Article;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> org.springframework.data.elasticsearch.repository.ElasticsearchRepository;</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Repository</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">interface</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ArticleRepository</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">extends</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ElasticsearchRepository</span><span style="color:#24292E;">&lt;</span><span style="color:#D73A49;">Article</span><span style="color:#24292E;">, </span><span style="color:#D73A49;">Integer</span><span style="color:#24292E;">&gt; {}</span></span></code></pre></div><p>5）编写Service</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">package</span><span style="color:#E1E4E8;"> com.itheima.service;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> com.itheima.domain.Article;</span></span>
<span class="line"><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">interface</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">ArticleService</span><span style="color:#E1E4E8;"> {    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">save</span><span style="color:#E1E4E8;">(Article </span><span style="color:#FFAB70;">article</span><span style="color:#E1E4E8;">);    </span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">package</span><span style="color:#24292E;"> com.itheima.service;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> com.itheima.domain.Article;</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">interface</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ArticleService</span><span style="color:#24292E;"> {    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">save</span><span style="color:#24292E;">(Article </span><span style="color:#E36209;">article</span><span style="color:#24292E;">);    </span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">package</span><span style="color:#E1E4E8;"> com.itheima.service.impl;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> com.itheima.dao.ArticleRepository;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> com.itheima.domain.Article;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> com.itheima.service.ArticleService;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> org.springframework.beans.factory.annotation.Autowired;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> org.springframework.stereotype.Service;</span></span>
<span class="line"><span style="color:#E1E4E8;">@</span><span style="color:#F97583;">Service</span></span>
<span class="line"><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">ArticleServiceImpl</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">implements</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">ArticleService</span><span style="color:#E1E4E8;"> {    </span></span>
<span class="line"><span style="color:#E1E4E8;">    @</span><span style="color:#F97583;">Autowired</span><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">private</span><span style="color:#E1E4E8;"> ArticleRepository articleRepository;    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">save</span><span style="color:#E1E4E8;">(Article </span><span style="color:#FFAB70;">article</span><span style="color:#E1E4E8;">) {        </span></span>
<span class="line"><span style="color:#E1E4E8;">        articleRepository.</span><span style="color:#B392F0;">save</span><span style="color:#E1E4E8;">(article);    </span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">package</span><span style="color:#24292E;"> com.itheima.service.impl;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> com.itheima.dao.ArticleRepository;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> com.itheima.domain.Article;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> com.itheima.service.ArticleService;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> org.springframework.beans.factory.annotation.Autowired;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> org.springframework.stereotype.Service;</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Service</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ArticleServiceImpl</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">implements</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ArticleService</span><span style="color:#24292E;"> {    </span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Autowired</span><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> ArticleRepository articleRepository;    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">save</span><span style="color:#24292E;">(Article </span><span style="color:#E36209;">article</span><span style="color:#24292E;">) {        </span></span>
<span class="line"><span style="color:#24292E;">        articleRepository.</span><span style="color:#6F42C1;">save</span><span style="color:#24292E;">(article);    </span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p>6） 配置applicationContext.xml</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">&lt;?</span><span style="color:#85E89D;">xml</span><span style="color:#B392F0;"> version</span><span style="color:#E1E4E8;">=</span><span style="color:#9ECBFF;">&quot;1.0&quot;</span><span style="color:#B392F0;"> encoding</span><span style="color:#E1E4E8;">=</span><span style="color:#9ECBFF;">&quot;UTF-8&quot;</span><span style="color:#E1E4E8;">?&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">&lt;</span><span style="color:#85E89D;">beans</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">xmlns</span><span style="color:#E1E4E8;">=</span><span style="color:#9ECBFF;">&quot;http://www.springframework.org/schema/beans&quot;</span><span style="color:#E1E4E8;">       </span><span style="color:#B392F0;">xmlns:xsi</span><span style="color:#E1E4E8;">=</span><span style="color:#9ECBFF;">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><span style="color:#E1E4E8;">       </span><span style="color:#B392F0;">xmlns:context</span><span style="color:#E1E4E8;">=</span><span style="color:#9ECBFF;">&quot;http://www.springframework.org/schema/context&quot;</span><span style="color:#E1E4E8;">       </span><span style="color:#B392F0;">xmlns:elasticsearch</span><span style="color:#E1E4E8;">=</span><span style="color:#9ECBFF;">&quot;http://www.springframework.org/schema/data/elasticsearch&quot;</span><span style="color:#E1E4E8;">       </span><span style="color:#B392F0;">xsi:schemaLocation</span><span style="color:#E1E4E8;">=</span><span style="color:#9ECBFF;">&quot;http://www.springframework.org/schema/beans		http://www.springframework.org/schema/beans/spring-beans.xsd		http://www.springframework.org/schema/context		http://www.springframework.org/schema/context/spring-context.xsd		http://www.springframework.org/schema/data/elasticsearch		http://www.springframework.org/schema/data/elasticsearch/spring-elasticsearch-1.0.xsd		&quot;</span><span style="color:#E1E4E8;">&gt;        </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">&lt;!-- 扫描Dao包，自动创建实例 --&gt;</span><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    &lt;</span><span style="color:#85E89D;">elasticsearch:repositories</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">base-package</span><span style="color:#E1E4E8;">=</span><span style="color:#9ECBFF;">&quot;com.itheima.dao&quot;</span><span style="color:#E1E4E8;">/&gt;    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">&lt;!-- 扫描Service包，创建Service的实体 --&gt;</span><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    &lt;</span><span style="color:#85E89D;">context:component-scan</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">base-package</span><span style="color:#E1E4E8;">=</span><span style="color:#9ECBFF;">&quot;com.itheima.service&quot;</span><span style="color:#E1E4E8;">/&gt;    </span></span>
<span class="line"><span style="color:#E1E4E8;">     </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">&lt;!-- 配置elasticSearch的连接 --&gt;</span><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    &lt;</span><span style="color:#85E89D;">elasticsearch:transport-client</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">id</span><span style="color:#E1E4E8;">=</span><span style="color:#9ECBFF;">&quot;client&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">cluster-nodes</span><span style="color:#E1E4E8;">=</span><span style="color:#9ECBFF;">&quot;localhost:9300&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">cluster-name</span><span style="color:#E1E4E8;">=</span><span style="color:#9ECBFF;">&quot;my-elasticsearch&quot;</span><span style="color:#E1E4E8;">/&gt;    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">&lt;!-- ElasticSearch模版对象 --&gt;</span><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    &lt;</span><span style="color:#85E89D;">bean</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">id</span><span style="color:#E1E4E8;">=</span><span style="color:#9ECBFF;">&quot;elasticsearchTemplate&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">class</span><span style="color:#E1E4E8;">=</span><span style="color:#9ECBFF;">&quot;org.springframework.data.elasticsearch.core.ElasticsearchTemplate&quot;</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">        &lt;</span><span style="color:#85E89D;">constructor-arg</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">name</span><span style="color:#E1E4E8;">=</span><span style="color:#9ECBFF;">&quot;client&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">ref</span><span style="color:#E1E4E8;">=</span><span style="color:#9ECBFF;">&quot;client&quot;</span><span style="color:#E1E4E8;">&gt;&lt;/</span><span style="color:#85E89D;">constructor-arg</span><span style="color:#E1E4E8;">&gt;    </span></span>
<span class="line"><span style="color:#E1E4E8;">    &lt;/</span><span style="color:#85E89D;">bean</span><span style="color:#E1E4E8;">&gt; </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">&lt;/</span><span style="color:#85E89D;">beans</span><span style="color:#E1E4E8;">&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">&lt;?</span><span style="color:#22863A;">xml</span><span style="color:#6F42C1;"> version</span><span style="color:#24292E;">=</span><span style="color:#032F62;">&quot;1.0&quot;</span><span style="color:#6F42C1;"> encoding</span><span style="color:#24292E;">=</span><span style="color:#032F62;">&quot;UTF-8&quot;</span><span style="color:#24292E;">?&gt;</span></span>
<span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">beans</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">xmlns</span><span style="color:#24292E;">=</span><span style="color:#032F62;">&quot;http://www.springframework.org/schema/beans&quot;</span><span style="color:#24292E;">       </span><span style="color:#6F42C1;">xmlns:xsi</span><span style="color:#24292E;">=</span><span style="color:#032F62;">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><span style="color:#24292E;">       </span><span style="color:#6F42C1;">xmlns:context</span><span style="color:#24292E;">=</span><span style="color:#032F62;">&quot;http://www.springframework.org/schema/context&quot;</span><span style="color:#24292E;">       </span><span style="color:#6F42C1;">xmlns:elasticsearch</span><span style="color:#24292E;">=</span><span style="color:#032F62;">&quot;http://www.springframework.org/schema/data/elasticsearch&quot;</span><span style="color:#24292E;">       </span><span style="color:#6F42C1;">xsi:schemaLocation</span><span style="color:#24292E;">=</span><span style="color:#032F62;">&quot;http://www.springframework.org/schema/beans		http://www.springframework.org/schema/beans/spring-beans.xsd		http://www.springframework.org/schema/context		http://www.springframework.org/schema/context/spring-context.xsd		http://www.springframework.org/schema/data/elasticsearch		http://www.springframework.org/schema/data/elasticsearch/spring-elasticsearch-1.0.xsd		&quot;</span><span style="color:#24292E;">&gt;        </span></span>
<span class="line"><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">&lt;!-- 扫描Dao包，自动创建实例 --&gt;</span><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    &lt;</span><span style="color:#22863A;">elasticsearch:repositories</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">base-package</span><span style="color:#24292E;">=</span><span style="color:#032F62;">&quot;com.itheima.dao&quot;</span><span style="color:#24292E;">/&gt;    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">&lt;!-- 扫描Service包，创建Service的实体 --&gt;</span><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    &lt;</span><span style="color:#22863A;">context:component-scan</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">base-package</span><span style="color:#24292E;">=</span><span style="color:#032F62;">&quot;com.itheima.service&quot;</span><span style="color:#24292E;">/&gt;    </span></span>
<span class="line"><span style="color:#24292E;">     </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">&lt;!-- 配置elasticSearch的连接 --&gt;</span><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    &lt;</span><span style="color:#22863A;">elasticsearch:transport-client</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">id</span><span style="color:#24292E;">=</span><span style="color:#032F62;">&quot;client&quot;</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">cluster-nodes</span><span style="color:#24292E;">=</span><span style="color:#032F62;">&quot;localhost:9300&quot;</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">cluster-name</span><span style="color:#24292E;">=</span><span style="color:#032F62;">&quot;my-elasticsearch&quot;</span><span style="color:#24292E;">/&gt;    </span></span>
<span class="line"><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">&lt;!-- ElasticSearch模版对象 --&gt;</span><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    &lt;</span><span style="color:#22863A;">bean</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">id</span><span style="color:#24292E;">=</span><span style="color:#032F62;">&quot;elasticsearchTemplate&quot;</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">class</span><span style="color:#24292E;">=</span><span style="color:#032F62;">&quot;org.springframework.data.elasticsearch.core.ElasticsearchTemplate&quot;</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">        &lt;</span><span style="color:#22863A;">constructor-arg</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">name</span><span style="color:#24292E;">=</span><span style="color:#032F62;">&quot;client&quot;</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ref</span><span style="color:#24292E;">=</span><span style="color:#032F62;">&quot;client&quot;</span><span style="color:#24292E;">&gt;&lt;/</span><span style="color:#22863A;">constructor-arg</span><span style="color:#24292E;">&gt;    </span></span>
<span class="line"><span style="color:#24292E;">    &lt;/</span><span style="color:#22863A;">bean</span><span style="color:#24292E;">&gt; </span></span>
<span class="line"><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">&lt;/</span><span style="color:#22863A;">beans</span><span style="color:#24292E;">&gt;</span></span></code></pre></div><p>7）配置实体</p><p>基于spring data elasticsearch注解配置索引、映射和实体的关系</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">package</span><span style="color:#E1E4E8;"> com.itheima.domain;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> org.springframework.data.annotation.Id;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> org.springframework.data.elasticsearch.annotations.Document;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> org.springframework.data.elasticsearch.annotations.Field;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> org.springframework.data.elasticsearch.annotations.FieldType;</span></span>
<span class="line"><span style="color:#6A737D;">//@Document 文档对象 （索引信息、文档类型 ）</span></span>
<span class="line"><span style="color:#E1E4E8;">@</span><span style="color:#F97583;">Document</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">indexName</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;blog3&quot;</span><span style="color:#E1E4E8;">,</span><span style="color:#79B8FF;">type</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;article&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Article</span><span style="color:#E1E4E8;"> {    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//@Id 文档主键 唯一标识    </span></span>
<span class="line"><span style="color:#E1E4E8;">    @</span><span style="color:#F97583;">Id</span><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//@Field 每个文档的字段配置（类型、是否分词、是否存储、分词器 ）    </span></span>
<span class="line"><span style="color:#E1E4E8;">    @</span><span style="color:#F97583;">Field</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">store</span><span style="color:#F97583;">=</span><span style="color:#79B8FF;">true</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">index</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">false</span><span style="color:#E1E4E8;">,</span><span style="color:#79B8FF;">type</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> FieldType.Integer)    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">private</span><span style="color:#E1E4E8;"> Integer id;    </span></span>
<span class="line"><span style="color:#E1E4E8;">    @</span><span style="color:#F97583;">Field</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">index</span><span style="color:#F97583;">=</span><span style="color:#79B8FF;">true</span><span style="color:#E1E4E8;">,</span><span style="color:#79B8FF;">analyzer</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;ik_smart&quot;</span><span style="color:#E1E4E8;">,</span><span style="color:#79B8FF;">store</span><span style="color:#F97583;">=</span><span style="color:#79B8FF;">true</span><span style="color:#E1E4E8;">,</span><span style="color:#79B8FF;">searchAnalyzer</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;ik_smart&quot;</span><span style="color:#E1E4E8;">,</span><span style="color:#79B8FF;">type</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> FieldType.text)    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">private</span><span style="color:#E1E4E8;"> String title;    </span></span>
<span class="line"><span style="color:#E1E4E8;">    @</span><span style="color:#F97583;">Field</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">index</span><span style="color:#F97583;">=</span><span style="color:#79B8FF;">true</span><span style="color:#E1E4E8;">,</span><span style="color:#79B8FF;">analyzer</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;ik_smart&quot;</span><span style="color:#E1E4E8;">,</span><span style="color:#79B8FF;">store</span><span style="color:#F97583;">=</span><span style="color:#79B8FF;">true</span><span style="color:#E1E4E8;">,</span><span style="color:#79B8FF;">searchAnalyzer</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;ik_smart&quot;</span><span style="color:#E1E4E8;">,</span><span style="color:#79B8FF;">type</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> FieldType.text)    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">private</span><span style="color:#E1E4E8;"> String content;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> Integer </span><span style="color:#B392F0;">getId</span><span style="color:#E1E4E8;">() {        </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> id;    }    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">setId</span><span style="color:#E1E4E8;">(Integer </span><span style="color:#FFAB70;">id</span><span style="color:#E1E4E8;">) {        </span><span style="color:#79B8FF;">this</span><span style="color:#E1E4E8;">.id </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> id;    }    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> String </span><span style="color:#B392F0;">getTitle</span><span style="color:#E1E4E8;">() {        </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> title;    }    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">setTitle</span><span style="color:#E1E4E8;">(String </span><span style="color:#FFAB70;">title</span><span style="color:#E1E4E8;">) {        </span><span style="color:#79B8FF;">this</span><span style="color:#E1E4E8;">.title </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> title;    }    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> String </span><span style="color:#B392F0;">getContent</span><span style="color:#E1E4E8;">() {        </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> content;    }    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">setContent</span><span style="color:#E1E4E8;">(String </span><span style="color:#FFAB70;">content</span><span style="color:#E1E4E8;">) {        </span><span style="color:#79B8FF;">this</span><span style="color:#E1E4E8;">.content </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> content;    }    </span></span>
<span class="line"><span style="color:#E1E4E8;">    @</span><span style="color:#F97583;">Override</span><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> String </span><span style="color:#B392F0;">toString</span><span style="color:#E1E4E8;">() {        </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;Article [id=&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> id </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;, title=&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> title </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;, content=&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> content </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;]&quot;</span><span style="color:#E1E4E8;">;    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">package</span><span style="color:#24292E;"> com.itheima.domain;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> org.springframework.data.annotation.Id;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> org.springframework.data.elasticsearch.annotations.Document;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> org.springframework.data.elasticsearch.annotations.Field;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> org.springframework.data.elasticsearch.annotations.FieldType;</span></span>
<span class="line"><span style="color:#6A737D;">//@Document 文档对象 （索引信息、文档类型 ）</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Document</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">indexName</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;blog3&quot;</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">type</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;article&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Article</span><span style="color:#24292E;"> {    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//@Id 文档主键 唯一标识    </span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Id</span><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//@Field 每个文档的字段配置（类型、是否分词、是否存储、分词器 ）    </span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Field</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">store</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">true</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">index</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">false</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">type</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> FieldType.Integer)    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> Integer id;    </span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Field</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">index</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">true</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">analyzer</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;ik_smart&quot;</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">store</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">true</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">searchAnalyzer</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;ik_smart&quot;</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">type</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> FieldType.text)    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> String title;    </span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Field</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">index</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">true</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">analyzer</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;ik_smart&quot;</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">store</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">true</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">searchAnalyzer</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;ik_smart&quot;</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">type</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> FieldType.text)    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> String content;</span></span>
<span class="line"><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> Integer </span><span style="color:#6F42C1;">getId</span><span style="color:#24292E;">() {        </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> id;    }    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">setId</span><span style="color:#24292E;">(Integer </span><span style="color:#E36209;">id</span><span style="color:#24292E;">) {        </span><span style="color:#005CC5;">this</span><span style="color:#24292E;">.id </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> id;    }    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> String </span><span style="color:#6F42C1;">getTitle</span><span style="color:#24292E;">() {        </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> title;    }    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">setTitle</span><span style="color:#24292E;">(String </span><span style="color:#E36209;">title</span><span style="color:#24292E;">) {        </span><span style="color:#005CC5;">this</span><span style="color:#24292E;">.title </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> title;    }    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> String </span><span style="color:#6F42C1;">getContent</span><span style="color:#24292E;">() {        </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> content;    }    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">setContent</span><span style="color:#24292E;">(String </span><span style="color:#E36209;">content</span><span style="color:#24292E;">) {        </span><span style="color:#005CC5;">this</span><span style="color:#24292E;">.content </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> content;    }    </span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Override</span><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> String </span><span style="color:#6F42C1;">toString</span><span style="color:#24292E;">() {        </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;Article [id=&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> id </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;, title=&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> title </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;, content=&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> content </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;]&quot;</span><span style="color:#24292E;">;    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">其中，注解解释如下：</span></span>
<span class="line"><span style="color:#e1e4e8;">@Document(indexName=&quot;blob3&quot;,type=&quot;article&quot;)：    </span></span>
<span class="line"><span style="color:#e1e4e8;">	indexName：索引的名称（必填项）    </span></span>
<span class="line"><span style="color:#e1e4e8;">	type：索引的类型@Id：主键的唯一标识@Field(index=true,analyzer=&quot;ik_smart&quot;,store=true,searchAnalyzer=&quot;ik_smart&quot;,type = FieldType.text)    </span></span>
<span class="line"><span style="color:#e1e4e8;">	index：是否设置分词    </span></span>
<span class="line"><span style="color:#e1e4e8;">	analyzer：存储时使用的分词器    </span></span>
<span class="line"><span style="color:#e1e4e8;">	searchAnalyze：搜索时使用的分词器    </span></span>
<span class="line"><span style="color:#e1e4e8;">	store：是否存储    </span></span>
<span class="line"><span style="color:#e1e4e8;">	type: 数据类型</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">其中，注解解释如下：</span></span>
<span class="line"><span style="color:#24292e;">@Document(indexName=&quot;blob3&quot;,type=&quot;article&quot;)：    </span></span>
<span class="line"><span style="color:#24292e;">	indexName：索引的名称（必填项）    </span></span>
<span class="line"><span style="color:#24292e;">	type：索引的类型@Id：主键的唯一标识@Field(index=true,analyzer=&quot;ik_smart&quot;,store=true,searchAnalyzer=&quot;ik_smart&quot;,type = FieldType.text)    </span></span>
<span class="line"><span style="color:#24292e;">	index：是否设置分词    </span></span>
<span class="line"><span style="color:#24292e;">	analyzer：存储时使用的分词器    </span></span>
<span class="line"><span style="color:#24292e;">	searchAnalyze：搜索时使用的分词器    </span></span>
<span class="line"><span style="color:#24292e;">	store：是否存储    </span></span>
<span class="line"><span style="color:#24292e;">	type: 数据类型</span></span></code></pre></div><p>8）创建测试类SpringDataESTest</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">package</span><span style="color:#E1E4E8;"> com.itheima.test;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> com.itheima.domain.Article;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> com.itheima.service.ArticleService;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> org.elasticsearch.client.transport.TransportClient;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> org.junit.Test;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> org.junit.runner.RunWith;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> org.springframework.beans.factory.annotation.Autowired;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> org.springframework.data.elasticsearch.core.ElasticsearchTemplate;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> org.springframework.test.context.ContextConfiguration;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> org.springframework.test.context.junit4.SpringJUnit4ClassRunner;</span></span>
<span class="line"><span style="color:#E1E4E8;">@</span><span style="color:#F97583;">RunWith</span><span style="color:#E1E4E8;">(SpringJUnit4ClassRunner.class)</span></span>
<span class="line"><span style="color:#E1E4E8;">@</span><span style="color:#F97583;">ContextConfiguration</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">locations</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;classpath:applicationContext.xml&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">SpringDataESTest</span><span style="color:#E1E4E8;"> {    </span></span>
<span class="line"><span style="color:#E1E4E8;">    @</span><span style="color:#F97583;">Autowired</span><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">private</span><span style="color:#E1E4E8;"> ArticleService articleService;    </span></span>
<span class="line"><span style="color:#E1E4E8;">    @</span><span style="color:#F97583;">Autowired</span><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">private</span><span style="color:#E1E4E8;"> TransportClient client;    </span></span>
<span class="line"><span style="color:#E1E4E8;">    @</span><span style="color:#F97583;">Autowired</span><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">private</span><span style="color:#E1E4E8;"> ElasticsearchTemplate elasticsearchTemplate;    </span></span>
<span class="line"><span style="color:#6A737D;">    /**创建索引和映射*/</span><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    @</span><span style="color:#F97583;">Test</span><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">createIndex</span><span style="color:#E1E4E8;">(){        </span></span>
<span class="line"><span style="color:#E1E4E8;">        elasticsearchTemplate.</span><span style="color:#B392F0;">createIndex</span><span style="color:#E1E4E8;">(Article.class);        </span></span>
<span class="line"><span style="color:#E1E4E8;">        elasticsearchTemplate.</span><span style="color:#B392F0;">putMapping</span><span style="color:#E1E4E8;">(Article.class);    </span></span>
<span class="line"><span style="color:#E1E4E8;">    }    </span></span>
<span class="line"><span style="color:#6A737D;">    /**测试-保存文档*/</span><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    @</span><span style="color:#F97583;">Test</span><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">saveArticle</span><span style="color:#E1E4E8;">(){        </span></span>
<span class="line"><span style="color:#E1E4E8;">        Article article </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Article</span><span style="color:#E1E4E8;">();        </span></span>
<span class="line"><span style="color:#E1E4E8;">        article.</span><span style="color:#B392F0;">setId</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">100</span><span style="color:#E1E4E8;">);        </span></span>
<span class="line"><span style="color:#E1E4E8;">        article.</span><span style="color:#B392F0;">setTitle</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;测试SpringData ElasticSearch&quot;</span><span style="color:#E1E4E8;">);        </span></span>
<span class="line"><span style="color:#E1E4E8;">        article.</span><span style="color:#B392F0;">setContent</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;Spring Data ElasticSearch 基于 spring data API 简化 elasticSearch操作，将原始操作elasticSearch的客户端API 进行封装 </span><span style="color:#79B8FF;">\\n</span><span style="color:#9ECBFF;">&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;">                </span><span style="color:#9ECBFF;">&quot;    Spring Data为Elasticsearch Elasticsearch项目提供集成搜索引擎&quot;</span><span style="color:#E1E4E8;">);        </span></span>
<span class="line"><span style="color:#E1E4E8;">        articleService.</span><span style="color:#B392F0;">save</span><span style="color:#E1E4E8;">(article);    </span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">package</span><span style="color:#24292E;"> com.itheima.test;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> com.itheima.domain.Article;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> com.itheima.service.ArticleService;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> org.elasticsearch.client.transport.TransportClient;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> org.junit.Test;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> org.junit.runner.RunWith;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> org.springframework.beans.factory.annotation.Autowired;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> org.springframework.data.elasticsearch.core.ElasticsearchTemplate;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> org.springframework.test.context.ContextConfiguration;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> org.springframework.test.context.junit4.SpringJUnit4ClassRunner;</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">RunWith</span><span style="color:#24292E;">(SpringJUnit4ClassRunner.class)</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">ContextConfiguration</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">locations</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;classpath:applicationContext.xml&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">SpringDataESTest</span><span style="color:#24292E;"> {    </span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Autowired</span><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> ArticleService articleService;    </span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Autowired</span><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> TransportClient client;    </span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Autowired</span><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> ElasticsearchTemplate elasticsearchTemplate;    </span></span>
<span class="line"><span style="color:#6A737D;">    /**创建索引和映射*/</span><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Test</span><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">createIndex</span><span style="color:#24292E;">(){        </span></span>
<span class="line"><span style="color:#24292E;">        elasticsearchTemplate.</span><span style="color:#6F42C1;">createIndex</span><span style="color:#24292E;">(Article.class);        </span></span>
<span class="line"><span style="color:#24292E;">        elasticsearchTemplate.</span><span style="color:#6F42C1;">putMapping</span><span style="color:#24292E;">(Article.class);    </span></span>
<span class="line"><span style="color:#24292E;">    }    </span></span>
<span class="line"><span style="color:#6A737D;">    /**测试-保存文档*/</span><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Test</span><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">saveArticle</span><span style="color:#24292E;">(){        </span></span>
<span class="line"><span style="color:#24292E;">        Article article </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Article</span><span style="color:#24292E;">();        </span></span>
<span class="line"><span style="color:#24292E;">        article.</span><span style="color:#6F42C1;">setId</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">100</span><span style="color:#24292E;">);        </span></span>
<span class="line"><span style="color:#24292E;">        article.</span><span style="color:#6F42C1;">setTitle</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;测试SpringData ElasticSearch&quot;</span><span style="color:#24292E;">);        </span></span>
<span class="line"><span style="color:#24292E;">        article.</span><span style="color:#6F42C1;">setContent</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;Spring Data ElasticSearch 基于 spring data API 简化 elasticSearch操作，将原始操作elasticSearch的客户端API 进行封装 </span><span style="color:#005CC5;">\\n</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;">                </span><span style="color:#032F62;">&quot;    Spring Data为Elasticsearch Elasticsearch项目提供集成搜索引擎&quot;</span><span style="color:#24292E;">);        </span></span>
<span class="line"><span style="color:#24292E;">        articleService.</span><span style="color:#6F42C1;">save</span><span style="color:#24292E;">(article);    </span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h2 id="_8-3-spring-data-elasticsearch的常用操作" tabindex="-1">8.3 Spring Data ElasticSearch的常用操作 <a class="header-anchor" href="#_8-3-spring-data-elasticsearch的常用操作" aria-label="Permalink to &quot;8.3 Spring Data ElasticSearch的常用操作&quot;">​</a></h2><h3 id="_8-3-1-增删改查方法测试" tabindex="-1">8.3.1 增删改查方法测试 <a class="header-anchor" href="#_8-3-1-增删改查方法测试" aria-label="Permalink to &quot;8.3.1 增删改查方法测试&quot;">​</a></h3><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">package</span><span style="color:#E1E4E8;"> com.itheima.service;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> com.itheima.domain.Article;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> org.springframework.data.domain.Page;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> org.springframework.data.domain.Pageable;</span></span>
<span class="line"><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">interface</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">ArticleService</span><span style="color:#E1E4E8;"> {    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//保存    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">save</span><span style="color:#E1E4E8;">(Article </span><span style="color:#FFAB70;">article</span><span style="color:#E1E4E8;">);    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//删除    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">delete</span><span style="color:#E1E4E8;">(Article </span><span style="color:#FFAB70;">article</span><span style="color:#E1E4E8;">);    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//查询全部    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> Iterable&lt;</span><span style="color:#F97583;">Article</span><span style="color:#E1E4E8;">&gt; </span><span style="color:#B392F0;">findAll</span><span style="color:#E1E4E8;">();    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//分页查询    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> Page&lt;</span><span style="color:#F97583;">Article</span><span style="color:#E1E4E8;">&gt; </span><span style="color:#B392F0;">findAll</span><span style="color:#E1E4E8;">(Pageable </span><span style="color:#FFAB70;">pageable</span><span style="color:#E1E4E8;">);}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">package</span><span style="color:#24292E;"> com.itheima.service;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> com.itheima.domain.Article;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> org.springframework.data.domain.Page;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> org.springframework.data.domain.Pageable;</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">interface</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ArticleService</span><span style="color:#24292E;"> {    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//保存    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">save</span><span style="color:#24292E;">(Article </span><span style="color:#E36209;">article</span><span style="color:#24292E;">);    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//删除    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">delete</span><span style="color:#24292E;">(Article </span><span style="color:#E36209;">article</span><span style="color:#24292E;">);    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//查询全部    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> Iterable&lt;</span><span style="color:#D73A49;">Article</span><span style="color:#24292E;">&gt; </span><span style="color:#6F42C1;">findAll</span><span style="color:#24292E;">();    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//分页查询    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> Page&lt;</span><span style="color:#D73A49;">Article</span><span style="color:#24292E;">&gt; </span><span style="color:#6F42C1;">findAll</span><span style="color:#24292E;">(Pageable </span><span style="color:#E36209;">pageable</span><span style="color:#24292E;">);}</span></span></code></pre></div><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">package</span><span style="color:#E1E4E8;"> com.itheima.service.impl;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> com.itheima.dao.ArticleRepository;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> com.itheima.domain.Article;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> com.itheima.service.ArticleService;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> org.springframework.beans.factory.annotation.Autowired;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> org.springframework.data.domain.Page;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> org.springframework.data.domain.Pageable;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> org.springframework.stereotype.Service;</span></span>
<span class="line"><span style="color:#E1E4E8;">@</span><span style="color:#F97583;">Servicepublic</span><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">ArticleServiceImpl</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">implements</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">ArticleService</span><span style="color:#E1E4E8;"> {    </span></span>
<span class="line"><span style="color:#E1E4E8;">    @</span><span style="color:#F97583;">Autowired</span><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">private</span><span style="color:#E1E4E8;"> ArticleRepository articleRepository;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">save</span><span style="color:#E1E4E8;">(Article </span><span style="color:#FFAB70;">article</span><span style="color:#E1E4E8;">) {        </span></span>
<span class="line"><span style="color:#E1E4E8;">        articleRepository.</span><span style="color:#B392F0;">save</span><span style="color:#E1E4E8;">(article);    </span></span>
<span class="line"><span style="color:#E1E4E8;">    }    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">delete</span><span style="color:#E1E4E8;">(Article </span><span style="color:#FFAB70;">article</span><span style="color:#E1E4E8;">) {        </span></span>
<span class="line"><span style="color:#E1E4E8;">        articleRepository.</span><span style="color:#B392F0;">delete</span><span style="color:#E1E4E8;">(article);    </span></span>
<span class="line"><span style="color:#E1E4E8;">    }    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> Iterable&lt;</span><span style="color:#F97583;">Article</span><span style="color:#E1E4E8;">&gt; </span><span style="color:#B392F0;">findAll</span><span style="color:#E1E4E8;">() {        </span></span>
<span class="line"><span style="color:#E1E4E8;">        Iterable&lt;</span><span style="color:#F97583;">Article</span><span style="color:#E1E4E8;">&gt; iter </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> articleRepository.</span><span style="color:#B392F0;">findAll</span><span style="color:#E1E4E8;">();        </span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> iter;    </span></span>
<span class="line"><span style="color:#E1E4E8;">    }    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> Page&lt;</span><span style="color:#F97583;">Article</span><span style="color:#E1E4E8;">&gt; </span><span style="color:#B392F0;">findAll</span><span style="color:#E1E4E8;">(Pageable </span><span style="color:#FFAB70;">pageable</span><span style="color:#E1E4E8;">) {       </span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> articleRepository.</span><span style="color:#B392F0;">findAll</span><span style="color:#E1E4E8;">(pageable);   </span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">package</span><span style="color:#24292E;"> com.itheima.service.impl;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> com.itheima.dao.ArticleRepository;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> com.itheima.domain.Article;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> com.itheima.service.ArticleService;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> org.springframework.beans.factory.annotation.Autowired;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> org.springframework.data.domain.Page;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> org.springframework.data.domain.Pageable;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> org.springframework.stereotype.Service;</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Servicepublic</span><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ArticleServiceImpl</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">implements</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ArticleService</span><span style="color:#24292E;"> {    </span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Autowired</span><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> ArticleRepository articleRepository;</span></span>
<span class="line"><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">save</span><span style="color:#24292E;">(Article </span><span style="color:#E36209;">article</span><span style="color:#24292E;">) {        </span></span>
<span class="line"><span style="color:#24292E;">        articleRepository.</span><span style="color:#6F42C1;">save</span><span style="color:#24292E;">(article);    </span></span>
<span class="line"><span style="color:#24292E;">    }    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">delete</span><span style="color:#24292E;">(Article </span><span style="color:#E36209;">article</span><span style="color:#24292E;">) {        </span></span>
<span class="line"><span style="color:#24292E;">        articleRepository.</span><span style="color:#6F42C1;">delete</span><span style="color:#24292E;">(article);    </span></span>
<span class="line"><span style="color:#24292E;">    }    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> Iterable&lt;</span><span style="color:#D73A49;">Article</span><span style="color:#24292E;">&gt; </span><span style="color:#6F42C1;">findAll</span><span style="color:#24292E;">() {        </span></span>
<span class="line"><span style="color:#24292E;">        Iterable&lt;</span><span style="color:#D73A49;">Article</span><span style="color:#24292E;">&gt; iter </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> articleRepository.</span><span style="color:#6F42C1;">findAll</span><span style="color:#24292E;">();        </span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> iter;    </span></span>
<span class="line"><span style="color:#24292E;">    }    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> Page&lt;</span><span style="color:#D73A49;">Article</span><span style="color:#24292E;">&gt; </span><span style="color:#6F42C1;">findAll</span><span style="color:#24292E;">(Pageable </span><span style="color:#E36209;">pageable</span><span style="color:#24292E;">) {       </span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> articleRepository.</span><span style="color:#6F42C1;">findAll</span><span style="color:#24292E;">(pageable);   </span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">package</span><span style="color:#E1E4E8;"> com.itheima.test;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> com.itheima.domain.Article;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> com.itheima.service.ArticleService;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> org.elasticsearch.client.transport.TransportClient;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> org.junit.Test;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> org.junit.runner.RunWith;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> org.springframework.beans.factory.annotation.Autowired;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> org.springframework.data.domain.Page;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> org.springframework.data.domain.PageRequest;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> org.springframework.data.domain.Pageable;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> org.springframework.data.elasticsearch.core.ElasticsearchTemplate;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> org.springframework.test.context.ContextConfiguration;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> org.springframework.test.context.junit4.SpringJUnit4ClassRunner;</span></span>
<span class="line"><span style="color:#E1E4E8;">@</span><span style="color:#F97583;">RunWith</span><span style="color:#E1E4E8;">(SpringJUnit4ClassRunner.class)</span></span>
<span class="line"><span style="color:#E1E4E8;">@</span><span style="color:#F97583;">ContextConfiguration</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">locations</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;classpath:applicationContext.xml&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">SpringDataESTest</span><span style="color:#E1E4E8;"> {    </span></span>
<span class="line"><span style="color:#E1E4E8;">    @</span><span style="color:#F97583;">Autowired</span><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">private</span><span style="color:#E1E4E8;"> ArticleService articleService;    </span></span>
<span class="line"><span style="color:#E1E4E8;">    @</span><span style="color:#F97583;">Autowired</span><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">private</span><span style="color:#E1E4E8;"> TransportClient client;    </span></span>
<span class="line"><span style="color:#E1E4E8;">    @</span><span style="color:#F97583;">Autowired</span><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">private</span><span style="color:#E1E4E8;"> ElasticsearchTemplate elasticsearchTemplate;    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#6A737D;">    /**创建索引和映射*/</span><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    @</span><span style="color:#F97583;">Test</span><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">createIndex</span><span style="color:#E1E4E8;">(){        </span></span>
<span class="line"><span style="color:#E1E4E8;">        elasticsearchTemplate.</span><span style="color:#B392F0;">createIndex</span><span style="color:#E1E4E8;">(Article.class);        </span></span>
<span class="line"><span style="color:#E1E4E8;">        elasticsearchTemplate.</span><span style="color:#B392F0;">putMapping</span><span style="color:#E1E4E8;">(Article.class);    </span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#6A737D;">    /**测试保存文档*/</span><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    @</span><span style="color:#F97583;">Test</span><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">saveArticle</span><span style="color:#E1E4E8;">(){        </span></span>
<span class="line"><span style="color:#E1E4E8;">        Article article </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Article</span><span style="color:#E1E4E8;">();        </span></span>
<span class="line"><span style="color:#E1E4E8;">        article.</span><span style="color:#B392F0;">setId</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">100</span><span style="color:#E1E4E8;">);        </span></span>
<span class="line"><span style="color:#E1E4E8;">        article.</span><span style="color:#B392F0;">setTitle</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;测试SpringData ElasticSearch&quot;</span><span style="color:#E1E4E8;">);        </span></span>
<span class="line"><span style="color:#E1E4E8;">        article.</span><span style="color:#B392F0;">setContent</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;Spring Data ElasticSearch 基于 spring data API 简化 elasticSearch操作，将原始操作elasticSearch的客户端API 进行封装 </span><span style="color:#79B8FF;">\\n</span><span style="color:#9ECBFF;">&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;">                </span><span style="color:#9ECBFF;">&quot;    Spring Data为Elasticsearch Elasticsearch项目提供集成搜索引擎&quot;</span><span style="color:#E1E4E8;">);        </span></span>
<span class="line"><span style="color:#E1E4E8;">        articleService.</span><span style="color:#B392F0;">save</span><span style="color:#E1E4E8;">(article);    </span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#6A737D;">    /**测试保存*/</span><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    @</span><span style="color:#F97583;">Test</span><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">save</span><span style="color:#E1E4E8;">(){        </span></span>
<span class="line"><span style="color:#E1E4E8;">        Article article </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Article</span><span style="color:#E1E4E8;">();        </span></span>
<span class="line"><span style="color:#E1E4E8;">        article.</span><span style="color:#B392F0;">setId</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">1001</span><span style="color:#E1E4E8;">);        </span></span>
<span class="line"><span style="color:#E1E4E8;">        article.</span><span style="color:#B392F0;">setTitle</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;elasticSearch 3.0版本发布&quot;</span><span style="color:#E1E4E8;">);        </span></span>
<span class="line"><span style="color:#E1E4E8;">        article.</span><span style="color:#B392F0;">setContent</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;ElasticSearch是一个基于Lucene的搜索服务器。它提供了一个分布式多用户能力的全文搜索引擎，基于RESTful web接口&quot;</span><span style="color:#E1E4E8;">);        </span></span>
<span class="line"><span style="color:#E1E4E8;">        articleService.</span><span style="color:#B392F0;">save</span><span style="color:#E1E4E8;">(article);    </span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#6A737D;">    /**测试更新*/</span><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    @</span><span style="color:#F97583;">Test</span><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">update</span><span style="color:#E1E4E8;">(){        </span></span>
<span class="line"><span style="color:#E1E4E8;">        Article article </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Article</span><span style="color:#E1E4E8;">();        </span></span>
<span class="line"><span style="color:#E1E4E8;">        article.</span><span style="color:#B392F0;">setId</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">1001</span><span style="color:#E1E4E8;">);        </span></span>
<span class="line"><span style="color:#E1E4E8;">        article.</span><span style="color:#B392F0;">setTitle</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;elasticSearch 3.0版本发布...更新&quot;</span><span style="color:#E1E4E8;">);        </span></span>
<span class="line"><span style="color:#E1E4E8;">        article.</span><span style="color:#B392F0;">setContent</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;ElasticSearch是一个基于Lucene的搜索服务器。它提供了一个分布式多用户能力的全文搜索引擎，基于RESTful web接口&quot;</span><span style="color:#E1E4E8;">);        </span></span>
<span class="line"><span style="color:#E1E4E8;">        articleService.</span><span style="color:#B392F0;">save</span><span style="color:#E1E4E8;">(article);    </span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#6A737D;">    /**测试删除*/</span><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    @</span><span style="color:#F97583;">Test</span><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">delete</span><span style="color:#E1E4E8;">(){        </span></span>
<span class="line"><span style="color:#E1E4E8;">        Article article </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Article</span><span style="color:#E1E4E8;">();        </span></span>
<span class="line"><span style="color:#E1E4E8;">        article.</span><span style="color:#B392F0;">setId</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">1001</span><span style="color:#E1E4E8;">);        </span></span>
<span class="line"><span style="color:#E1E4E8;">        articleService.</span><span style="color:#B392F0;">delete</span><span style="color:#E1E4E8;">(article);    </span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#6A737D;">    /**批量插入*/</span><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    @</span><span style="color:#F97583;">Test</span><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">save100</span><span style="color:#E1E4E8;">(){        </span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">for</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">int</span><span style="color:#E1E4E8;"> i</span><span style="color:#F97583;">=</span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">;i</span><span style="color:#F97583;">&lt;=</span><span style="color:#79B8FF;">100</span><span style="color:#E1E4E8;">;i</span><span style="color:#F97583;">++</span><span style="color:#E1E4E8;">){            </span></span>
<span class="line"><span style="color:#E1E4E8;">            Article article </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Article</span><span style="color:#E1E4E8;">();            </span></span>
<span class="line"><span style="color:#E1E4E8;">            article.</span><span style="color:#B392F0;">setId</span><span style="color:#E1E4E8;">(i);            </span></span>
<span class="line"><span style="color:#E1E4E8;">            article.</span><span style="color:#B392F0;">setTitle</span><span style="color:#E1E4E8;">(i</span><span style="color:#F97583;">+</span><span style="color:#9ECBFF;">&quot;elasticSearch 3.0版本发布..，更新&quot;</span><span style="color:#E1E4E8;">);            </span></span>
<span class="line"><span style="color:#E1E4E8;">            article.</span><span style="color:#B392F0;">setContent</span><span style="color:#E1E4E8;">(i</span><span style="color:#F97583;">+</span><span style="color:#9ECBFF;">&quot;ElasticSearch是一个基于Lucene的搜索服务器。它提供了一个分布式多用户能力的全文搜索引擎，基于RESTful web接口&quot;</span><span style="color:#E1E4E8;">);            </span></span>
<span class="line"><span style="color:#E1E4E8;">            articleService.</span><span style="color:#B392F0;">save</span><span style="color:#E1E4E8;">(article);        </span></span>
<span class="line"><span style="color:#E1E4E8;">        }    </span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#6A737D;">    /**分页查询*/</span><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    @</span><span style="color:#F97583;">Test</span><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">findAllPage</span><span style="color:#E1E4E8;">(){        </span></span>
<span class="line"><span style="color:#E1E4E8;">        Pageable pageable </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> PageRequest.</span><span style="color:#B392F0;">of</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">,</span><span style="color:#79B8FF;">10</span><span style="color:#E1E4E8;">);        </span></span>
<span class="line"><span style="color:#E1E4E8;">        Page&lt;</span><span style="color:#F97583;">Article</span><span style="color:#E1E4E8;">&gt; page </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> articleService.</span><span style="color:#B392F0;">findAll</span><span style="color:#E1E4E8;">(pageable);        </span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">for</span><span style="color:#E1E4E8;">(Article article</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;">page.</span><span style="color:#B392F0;">getContent</span><span style="color:#E1E4E8;">()){            </span></span>
<span class="line"><span style="color:#E1E4E8;">            System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(article);        </span></span>
<span class="line"><span style="color:#E1E4E8;">        }    </span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">package</span><span style="color:#24292E;"> com.itheima.test;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> com.itheima.domain.Article;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> com.itheima.service.ArticleService;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> org.elasticsearch.client.transport.TransportClient;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> org.junit.Test;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> org.junit.runner.RunWith;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> org.springframework.beans.factory.annotation.Autowired;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> org.springframework.data.domain.Page;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> org.springframework.data.domain.PageRequest;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> org.springframework.data.domain.Pageable;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> org.springframework.data.elasticsearch.core.ElasticsearchTemplate;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> org.springframework.test.context.ContextConfiguration;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> org.springframework.test.context.junit4.SpringJUnit4ClassRunner;</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">RunWith</span><span style="color:#24292E;">(SpringJUnit4ClassRunner.class)</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">ContextConfiguration</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">locations</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;classpath:applicationContext.xml&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">SpringDataESTest</span><span style="color:#24292E;"> {    </span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Autowired</span><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> ArticleService articleService;    </span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Autowired</span><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> TransportClient client;    </span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Autowired</span><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> ElasticsearchTemplate elasticsearchTemplate;    </span></span>
<span class="line"><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#6A737D;">    /**创建索引和映射*/</span><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Test</span><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">createIndex</span><span style="color:#24292E;">(){        </span></span>
<span class="line"><span style="color:#24292E;">        elasticsearchTemplate.</span><span style="color:#6F42C1;">createIndex</span><span style="color:#24292E;">(Article.class);        </span></span>
<span class="line"><span style="color:#24292E;">        elasticsearchTemplate.</span><span style="color:#6F42C1;">putMapping</span><span style="color:#24292E;">(Article.class);    </span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#6A737D;">    /**测试保存文档*/</span><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Test</span><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">saveArticle</span><span style="color:#24292E;">(){        </span></span>
<span class="line"><span style="color:#24292E;">        Article article </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Article</span><span style="color:#24292E;">();        </span></span>
<span class="line"><span style="color:#24292E;">        article.</span><span style="color:#6F42C1;">setId</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">100</span><span style="color:#24292E;">);        </span></span>
<span class="line"><span style="color:#24292E;">        article.</span><span style="color:#6F42C1;">setTitle</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;测试SpringData ElasticSearch&quot;</span><span style="color:#24292E;">);        </span></span>
<span class="line"><span style="color:#24292E;">        article.</span><span style="color:#6F42C1;">setContent</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;Spring Data ElasticSearch 基于 spring data API 简化 elasticSearch操作，将原始操作elasticSearch的客户端API 进行封装 </span><span style="color:#005CC5;">\\n</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;">                </span><span style="color:#032F62;">&quot;    Spring Data为Elasticsearch Elasticsearch项目提供集成搜索引擎&quot;</span><span style="color:#24292E;">);        </span></span>
<span class="line"><span style="color:#24292E;">        articleService.</span><span style="color:#6F42C1;">save</span><span style="color:#24292E;">(article);    </span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#6A737D;">    /**测试保存*/</span><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Test</span><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">save</span><span style="color:#24292E;">(){        </span></span>
<span class="line"><span style="color:#24292E;">        Article article </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Article</span><span style="color:#24292E;">();        </span></span>
<span class="line"><span style="color:#24292E;">        article.</span><span style="color:#6F42C1;">setId</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">1001</span><span style="color:#24292E;">);        </span></span>
<span class="line"><span style="color:#24292E;">        article.</span><span style="color:#6F42C1;">setTitle</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;elasticSearch 3.0版本发布&quot;</span><span style="color:#24292E;">);        </span></span>
<span class="line"><span style="color:#24292E;">        article.</span><span style="color:#6F42C1;">setContent</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;ElasticSearch是一个基于Lucene的搜索服务器。它提供了一个分布式多用户能力的全文搜索引擎，基于RESTful web接口&quot;</span><span style="color:#24292E;">);        </span></span>
<span class="line"><span style="color:#24292E;">        articleService.</span><span style="color:#6F42C1;">save</span><span style="color:#24292E;">(article);    </span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#6A737D;">    /**测试更新*/</span><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Test</span><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">update</span><span style="color:#24292E;">(){        </span></span>
<span class="line"><span style="color:#24292E;">        Article article </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Article</span><span style="color:#24292E;">();        </span></span>
<span class="line"><span style="color:#24292E;">        article.</span><span style="color:#6F42C1;">setId</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">1001</span><span style="color:#24292E;">);        </span></span>
<span class="line"><span style="color:#24292E;">        article.</span><span style="color:#6F42C1;">setTitle</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;elasticSearch 3.0版本发布...更新&quot;</span><span style="color:#24292E;">);        </span></span>
<span class="line"><span style="color:#24292E;">        article.</span><span style="color:#6F42C1;">setContent</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;ElasticSearch是一个基于Lucene的搜索服务器。它提供了一个分布式多用户能力的全文搜索引擎，基于RESTful web接口&quot;</span><span style="color:#24292E;">);        </span></span>
<span class="line"><span style="color:#24292E;">        articleService.</span><span style="color:#6F42C1;">save</span><span style="color:#24292E;">(article);    </span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#6A737D;">    /**测试删除*/</span><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Test</span><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">delete</span><span style="color:#24292E;">(){        </span></span>
<span class="line"><span style="color:#24292E;">        Article article </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Article</span><span style="color:#24292E;">();        </span></span>
<span class="line"><span style="color:#24292E;">        article.</span><span style="color:#6F42C1;">setId</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">1001</span><span style="color:#24292E;">);        </span></span>
<span class="line"><span style="color:#24292E;">        articleService.</span><span style="color:#6F42C1;">delete</span><span style="color:#24292E;">(article);    </span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#6A737D;">    /**批量插入*/</span><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Test</span><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">save100</span><span style="color:#24292E;">(){        </span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">for</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> i</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">;i</span><span style="color:#D73A49;">&lt;=</span><span style="color:#005CC5;">100</span><span style="color:#24292E;">;i</span><span style="color:#D73A49;">++</span><span style="color:#24292E;">){            </span></span>
<span class="line"><span style="color:#24292E;">            Article article </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Article</span><span style="color:#24292E;">();            </span></span>
<span class="line"><span style="color:#24292E;">            article.</span><span style="color:#6F42C1;">setId</span><span style="color:#24292E;">(i);            </span></span>
<span class="line"><span style="color:#24292E;">            article.</span><span style="color:#6F42C1;">setTitle</span><span style="color:#24292E;">(i</span><span style="color:#D73A49;">+</span><span style="color:#032F62;">&quot;elasticSearch 3.0版本发布..，更新&quot;</span><span style="color:#24292E;">);            </span></span>
<span class="line"><span style="color:#24292E;">            article.</span><span style="color:#6F42C1;">setContent</span><span style="color:#24292E;">(i</span><span style="color:#D73A49;">+</span><span style="color:#032F62;">&quot;ElasticSearch是一个基于Lucene的搜索服务器。它提供了一个分布式多用户能力的全文搜索引擎，基于RESTful web接口&quot;</span><span style="color:#24292E;">);            </span></span>
<span class="line"><span style="color:#24292E;">            articleService.</span><span style="color:#6F42C1;">save</span><span style="color:#24292E;">(article);        </span></span>
<span class="line"><span style="color:#24292E;">        }    </span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#6A737D;">    /**分页查询*/</span><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Test</span><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">findAllPage</span><span style="color:#24292E;">(){        </span></span>
<span class="line"><span style="color:#24292E;">        Pageable pageable </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> PageRequest.</span><span style="color:#6F42C1;">of</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">10</span><span style="color:#24292E;">);        </span></span>
<span class="line"><span style="color:#24292E;">        Page&lt;</span><span style="color:#D73A49;">Article</span><span style="color:#24292E;">&gt; page </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> articleService.</span><span style="color:#6F42C1;">findAll</span><span style="color:#24292E;">(pageable);        </span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">for</span><span style="color:#24292E;">(Article article</span><span style="color:#D73A49;">:</span><span style="color:#24292E;">page.</span><span style="color:#6F42C1;">getContent</span><span style="color:#24292E;">()){            </span></span>
<span class="line"><span style="color:#24292E;">            System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(article);        </span></span>
<span class="line"><span style="color:#24292E;">        }    </span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h3 id="_8-3-2-自定义查询-命名规则" tabindex="-1">8.3.2 自定义查询-命名规则 <a class="header-anchor" href="#_8-3-2-自定义查询-命名规则" aria-label="Permalink to &quot;8.3.2 自定义查询-命名规则&quot;">​</a></h3><table><thead><tr><th>IDEA关键字</th><th>命名规则</th><th>解释</th><th>示例</th></tr></thead><tbody><tr><td>and</td><td>findByField1AndField2</td><td>根据Field1和Field2获得数据</td><td>findByTitleAndContent</td></tr><tr><td>or</td><td>findByField1OrField2</td><td>根据Field1或Field2获得数据</td><td>findByTitleOrContent</td></tr><tr><td>is</td><td>findByField</td><td>根据Field获得数据</td><td>findByTitle</td></tr><tr><td>not</td><td>findByFieldNot</td><td>根据Field获得补集数据</td><td>findByTitleNot</td></tr><tr><td>between</td><td>findByFieldBetween</td><td>获得指定范围的数据</td><td>findByPriceBetween</td></tr><tr><td>lessThanEqual</td><td>findByFieldLessThan</td><td>获得小于等于指定值的数据</td><td>findByPriceLessThan</td></tr></tbody></table><h3 id="_8-3-3-自定义查询方法测试" tabindex="-1">8.3.3 自定义查询方法测试 <a class="header-anchor" href="#_8-3-3-自定义查询方法测试" aria-label="Permalink to &quot;8.3.3 自定义查询方法测试&quot;">​</a></h3><p>1）dao层实现</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">package</span><span style="color:#E1E4E8;"> com.itheima.dao;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> com.itheima.domain.Article;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> org.springframework.data.domain.Page;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> org.springframework.data.domain.Pageable;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> org.springframework.data.elasticsearch.repository.ElasticsearchRepository;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> java.util.List;</span></span>
<span class="line"><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">interface</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">ArticleRepository</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">extends</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">ElasticsearchRepository</span><span style="color:#E1E4E8;">&lt;</span><span style="color:#F97583;">Article</span><span style="color:#E1E4E8;">, </span><span style="color:#F97583;">Integer</span><span style="color:#E1E4E8;">&gt; {    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//根据标题查询    </span></span>
<span class="line"><span style="color:#E1E4E8;">    List&lt;</span><span style="color:#F97583;">Article</span><span style="color:#E1E4E8;">&gt; </span><span style="color:#B392F0;">findByTitle</span><span style="color:#E1E4E8;">(String </span><span style="color:#FFAB70;">condition</span><span style="color:#E1E4E8;">);    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//根据标题查询(含分页)    </span></span>
<span class="line"><span style="color:#E1E4E8;">    Page&lt;</span><span style="color:#F97583;">Article</span><span style="color:#E1E4E8;">&gt; </span><span style="color:#B392F0;">findByTitle</span><span style="color:#E1E4E8;">(String </span><span style="color:#FFAB70;">condition</span><span style="color:#E1E4E8;">, Pageable </span><span style="color:#FFAB70;">pageable</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">package</span><span style="color:#24292E;"> com.itheima.dao;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> com.itheima.domain.Article;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> org.springframework.data.domain.Page;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> org.springframework.data.domain.Pageable;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> org.springframework.data.elasticsearch.repository.ElasticsearchRepository;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> java.util.List;</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">interface</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ArticleRepository</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">extends</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ElasticsearchRepository</span><span style="color:#24292E;">&lt;</span><span style="color:#D73A49;">Article</span><span style="color:#24292E;">, </span><span style="color:#D73A49;">Integer</span><span style="color:#24292E;">&gt; {    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//根据标题查询    </span></span>
<span class="line"><span style="color:#24292E;">    List&lt;</span><span style="color:#D73A49;">Article</span><span style="color:#24292E;">&gt; </span><span style="color:#6F42C1;">findByTitle</span><span style="color:#24292E;">(String </span><span style="color:#E36209;">condition</span><span style="color:#24292E;">);    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//根据标题查询(含分页)    </span></span>
<span class="line"><span style="color:#24292E;">    Page&lt;</span><span style="color:#D73A49;">Article</span><span style="color:#24292E;">&gt; </span><span style="color:#6F42C1;">findByTitle</span><span style="color:#24292E;">(String </span><span style="color:#E36209;">condition</span><span style="color:#24292E;">, Pageable </span><span style="color:#E36209;">pageable</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p>2）service层实现</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">interface</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">ArticleService</span><span style="color:#E1E4E8;"> {    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//根据标题查询    </span></span>
<span class="line"><span style="color:#E1E4E8;">    List&lt;</span><span style="color:#F97583;">Article</span><span style="color:#E1E4E8;">&gt; </span><span style="color:#B392F0;">findByTitle</span><span style="color:#E1E4E8;">(String </span><span style="color:#FFAB70;">condition</span><span style="color:#E1E4E8;">);    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//根据标题查询(含分页)    </span></span>
<span class="line"><span style="color:#E1E4E8;">    Page&lt;</span><span style="color:#F97583;">Article</span><span style="color:#E1E4E8;">&gt; </span><span style="color:#B392F0;">findByTitle</span><span style="color:#E1E4E8;">(String </span><span style="color:#FFAB70;">condition</span><span style="color:#E1E4E8;">, Pageable </span><span style="color:#FFAB70;">pageable</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">interface</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ArticleService</span><span style="color:#24292E;"> {    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//根据标题查询    </span></span>
<span class="line"><span style="color:#24292E;">    List&lt;</span><span style="color:#D73A49;">Article</span><span style="color:#24292E;">&gt; </span><span style="color:#6F42C1;">findByTitle</span><span style="color:#24292E;">(String </span><span style="color:#E36209;">condition</span><span style="color:#24292E;">);    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//根据标题查询(含分页)    </span></span>
<span class="line"><span style="color:#24292E;">    Page&lt;</span><span style="color:#D73A49;">Article</span><span style="color:#24292E;">&gt; </span><span style="color:#6F42C1;">findByTitle</span><span style="color:#24292E;">(String </span><span style="color:#E36209;">condition</span><span style="color:#24292E;">, Pageable </span><span style="color:#E36209;">pageable</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">package</span><span style="color:#E1E4E8;"> com.itheima.service.impl;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> com.itheima.dao.ArticleRepository;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> com.itheima.domain.Article;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> com.itheima.service.ArticleService;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> org.springframework.beans.factory.annotation.Autowired;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> org.springframework.data.domain.Page;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> org.springframework.data.domain.Pageable;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> org.springframework.stereotype.Service;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> java.util.List;</span></span>
<span class="line"><span style="color:#E1E4E8;">@</span><span style="color:#F97583;">Servicepublic</span><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">ArticleServiceImpl</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">implements</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">ArticleService</span><span style="color:#E1E4E8;"> {    </span></span>
<span class="line"><span style="color:#E1E4E8;">    @</span><span style="color:#F97583;">Autowired</span><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">private</span><span style="color:#E1E4E8;"> ArticleRepository articleRepository;    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> List&lt;</span><span style="color:#F97583;">Article</span><span style="color:#E1E4E8;">&gt; </span><span style="color:#B392F0;">findByTitle</span><span style="color:#E1E4E8;">(String </span><span style="color:#FFAB70;">condition</span><span style="color:#E1E4E8;">) {        </span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> articleRepository.</span><span style="color:#B392F0;">findByTitle</span><span style="color:#E1E4E8;">(condition);    </span></span>
<span class="line"><span style="color:#E1E4E8;">    }    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> Page&lt;</span><span style="color:#F97583;">Article</span><span style="color:#E1E4E8;">&gt; </span><span style="color:#B392F0;">findByTitle</span><span style="color:#E1E4E8;">(String </span><span style="color:#FFAB70;">condition</span><span style="color:#E1E4E8;">, Pageable </span><span style="color:#FFAB70;">pageable</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> articleRepository.</span><span style="color:#B392F0;">findByTitle</span><span style="color:#E1E4E8;">(condition,pageable);    </span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">package</span><span style="color:#24292E;"> com.itheima.service.impl;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> com.itheima.dao.ArticleRepository;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> com.itheima.domain.Article;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> com.itheima.service.ArticleService;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> org.springframework.beans.factory.annotation.Autowired;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> org.springframework.data.domain.Page;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> org.springframework.data.domain.Pageable;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> org.springframework.stereotype.Service;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> java.util.List;</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Servicepublic</span><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ArticleServiceImpl</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">implements</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ArticleService</span><span style="color:#24292E;"> {    </span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Autowired</span><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> ArticleRepository articleRepository;    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> List&lt;</span><span style="color:#D73A49;">Article</span><span style="color:#24292E;">&gt; </span><span style="color:#6F42C1;">findByTitle</span><span style="color:#24292E;">(String </span><span style="color:#E36209;">condition</span><span style="color:#24292E;">) {        </span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> articleRepository.</span><span style="color:#6F42C1;">findByTitle</span><span style="color:#24292E;">(condition);    </span></span>
<span class="line"><span style="color:#24292E;">    }    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> Page&lt;</span><span style="color:#D73A49;">Article</span><span style="color:#24292E;">&gt; </span><span style="color:#6F42C1;">findByTitle</span><span style="color:#24292E;">(String </span><span style="color:#E36209;">condition</span><span style="color:#24292E;">, Pageable </span><span style="color:#E36209;">pageable</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> articleRepository.</span><span style="color:#6F42C1;">findByTitle</span><span style="color:#24292E;">(condition,pageable);    </span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p>3）测试代码</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">package</span><span style="color:#E1E4E8;"> com.itheima.test;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> com.itheima.domain.Article;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> com.itheima.service.ArticleService;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> org.elasticsearch.client.transport.TransportClient;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> org.junit.Test;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> org.junit.runner.RunWith;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> org.springframework.beans.factory.annotation.Autowired;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> org.springframework.data.domain.Page;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> org.springframework.data.domain.PageRequest;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> org.springframework.data.domain.Pageable;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> org.springframework.data.elasticsearch.core.ElasticsearchTemplate;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> org.springframework.test.context.ContextConfiguration;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> org.springframework.test.context.junit4.SpringJUnit4ClassRunner;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> java.util.List;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">@</span><span style="color:#F97583;">RunWith</span><span style="color:#E1E4E8;">(SpringJUnit4ClassRunner.class)</span></span>
<span class="line"><span style="color:#E1E4E8;">@</span><span style="color:#F97583;">ContextConfiguration</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">locations</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;classpath:applicationContext.xml&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">SpringDataESTest</span><span style="color:#E1E4E8;"> {    </span></span>
<span class="line"><span style="color:#E1E4E8;">    @</span><span style="color:#F97583;">Autowired</span><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">private</span><span style="color:#E1E4E8;"> ArticleService articleService;    </span></span>
<span class="line"><span style="color:#E1E4E8;">    @</span><span style="color:#F97583;">Autowired</span><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">private</span><span style="color:#E1E4E8;"> TransportClient client;    </span></span>
<span class="line"><span style="color:#E1E4E8;">    @</span><span style="color:#F97583;">Autowired</span><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">private</span><span style="color:#E1E4E8;"> ElasticsearchTemplate elasticsearchTemplate;    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#6A737D;">    /**条件查询*/</span><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    @</span><span style="color:#F97583;">Test</span><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">findByTitle</span><span style="color:#E1E4E8;">(){        </span></span>
<span class="line"><span style="color:#E1E4E8;">        String condition </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;版本&quot;</span><span style="color:#E1E4E8;">;        </span></span>
<span class="line"><span style="color:#E1E4E8;">        List&lt;</span><span style="color:#F97583;">Article</span><span style="color:#E1E4E8;">&gt; articleList </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> articleService.</span><span style="color:#B392F0;">findByTitle</span><span style="color:#E1E4E8;">(condition);</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">for</span><span style="color:#E1E4E8;">(Article article</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;">articleList){            </span></span>
<span class="line"><span style="color:#E1E4E8;">            System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(article);        </span></span>
<span class="line"><span style="color:#E1E4E8;">        }</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#6A737D;">    /**条件分页查询*/</span></span>
<span class="line"><span style="color:#E1E4E8;">    @</span><span style="color:#F97583;">Test</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">findByTitlePage</span><span style="color:#E1E4E8;">(){</span></span>
<span class="line"><span style="color:#E1E4E8;">        String condition </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;版本&quot;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">        Pageable pageable </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> PageRequest.</span><span style="color:#B392F0;">of</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;">,</span><span style="color:#79B8FF;">10</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">        Page&lt;</span><span style="color:#F97583;">Article</span><span style="color:#E1E4E8;">&gt; page </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> articleService.</span><span style="color:#B392F0;">findByTitle</span><span style="color:#E1E4E8;">(condition,pageable);</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">for</span><span style="color:#E1E4E8;">(Article article</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;">page.</span><span style="color:#B392F0;">getContent</span><span style="color:#E1E4E8;">()){            </span></span>
<span class="line"><span style="color:#E1E4E8;">            System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(article);        </span></span>
<span class="line"><span style="color:#E1E4E8;">        }    </span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">package</span><span style="color:#24292E;"> com.itheima.test;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> com.itheima.domain.Article;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> com.itheima.service.ArticleService;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> org.elasticsearch.client.transport.TransportClient;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> org.junit.Test;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> org.junit.runner.RunWith;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> org.springframework.beans.factory.annotation.Autowired;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> org.springframework.data.domain.Page;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> org.springframework.data.domain.PageRequest;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> org.springframework.data.domain.Pageable;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> org.springframework.data.elasticsearch.core.ElasticsearchTemplate;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> org.springframework.test.context.ContextConfiguration;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> org.springframework.test.context.junit4.SpringJUnit4ClassRunner;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> java.util.List;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">RunWith</span><span style="color:#24292E;">(SpringJUnit4ClassRunner.class)</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">ContextConfiguration</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">locations</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;classpath:applicationContext.xml&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">SpringDataESTest</span><span style="color:#24292E;"> {    </span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Autowired</span><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> ArticleService articleService;    </span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Autowired</span><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> TransportClient client;    </span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Autowired</span><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> ElasticsearchTemplate elasticsearchTemplate;    </span></span>
<span class="line"><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#6A737D;">    /**条件查询*/</span><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Test</span><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">findByTitle</span><span style="color:#24292E;">(){        </span></span>
<span class="line"><span style="color:#24292E;">        String condition </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;版本&quot;</span><span style="color:#24292E;">;        </span></span>
<span class="line"><span style="color:#24292E;">        List&lt;</span><span style="color:#D73A49;">Article</span><span style="color:#24292E;">&gt; articleList </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> articleService.</span><span style="color:#6F42C1;">findByTitle</span><span style="color:#24292E;">(condition);</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">for</span><span style="color:#24292E;">(Article article</span><span style="color:#D73A49;">:</span><span style="color:#24292E;">articleList){            </span></span>
<span class="line"><span style="color:#24292E;">            System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(article);        </span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#6A737D;">    /**条件分页查询*/</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Test</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">findByTitlePage</span><span style="color:#24292E;">(){</span></span>
<span class="line"><span style="color:#24292E;">        String condition </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;版本&quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">        Pageable pageable </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> PageRequest.</span><span style="color:#6F42C1;">of</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">2</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">10</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">        Page&lt;</span><span style="color:#D73A49;">Article</span><span style="color:#24292E;">&gt; page </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> articleService.</span><span style="color:#6F42C1;">findByTitle</span><span style="color:#24292E;">(condition,pageable);</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">for</span><span style="color:#24292E;">(Article article</span><span style="color:#D73A49;">:</span><span style="color:#24292E;">page.</span><span style="color:#6F42C1;">getContent</span><span style="color:#24292E;">()){            </span></span>
<span class="line"><span style="color:#24292E;">            System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(article);        </span></span>
<span class="line"><span style="color:#24292E;">        }    </span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h3 id="_8-3-4-使用es的原生查询对象进行查询。" tabindex="-1">8.3.4 使用ES的原生查询对象进行查询。 <a class="header-anchor" href="#_8-3-4-使用es的原生查询对象进行查询。" aria-label="Permalink to &quot;8.3.4 使用ES的原生查询对象进行查询。&quot;">​</a></h3><p>自定义查询方法问题：对搜索内容先分词，再查询。但是，每个词之间都是and的关系。</p><p>因此，需要使用ES的QueryString查询方法。</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">@</span><span style="color:#F97583;">Test</span><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">findByNativeQuery</span><span style="color:#E1E4E8;">() {        </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//创建一个SearchQuery对象        </span></span>
<span class="line"><span style="color:#E1E4E8;">    SearchQuery searchQuery </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">NativeSearchQueryBuilder</span><span style="color:#E1E4E8;">()                </span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#6A737D;">//设置查询条件，此处可以使用QueryBuilders创建多种查询                </span></span>
<span class="line"><span style="color:#E1E4E8;">        .</span><span style="color:#B392F0;">withQuery</span><span style="color:#E1E4E8;">(QueryBuilders</span></span>
<span class="line"><span style="color:#E1E4E8;">                   .</span><span style="color:#B392F0;">queryStringQuery</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;备份节点上没有数据&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">                   .</span><span style="color:#B392F0;">defaultField</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;title&quot;</span><span style="color:#E1E4E8;">))                </span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#6A737D;">//还可以设置分页信息                </span></span>
<span class="line"><span style="color:#E1E4E8;">        .</span><span style="color:#B392F0;">withPageable</span><span style="color:#E1E4E8;">(PageRequest.</span><span style="color:#B392F0;">of</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;">))                </span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#6A737D;">//创建SearchQuery对象                </span></span>
<span class="line"><span style="color:#E1E4E8;">        .</span><span style="color:#B392F0;">build</span><span style="color:#E1E4E8;">();        </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//使用模板对象执行查询        </span></span>
<span class="line"><span style="color:#E1E4E8;">    elasticsearchTemplate</span></span>
<span class="line"><span style="color:#E1E4E8;">        .</span><span style="color:#B392F0;">queryForList</span><span style="color:#E1E4E8;">(searchQuery, Article.class)</span></span>
<span class="line"><span style="color:#E1E4E8;">        .</span><span style="color:#B392F0;">forEach</span><span style="color:#E1E4E8;">(a</span><span style="color:#F97583;">-&gt;</span><span style="color:#E1E4E8;"> System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(a));    </span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Test</span><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">findByNativeQuery</span><span style="color:#24292E;">() {        </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//创建一个SearchQuery对象        </span></span>
<span class="line"><span style="color:#24292E;">    SearchQuery searchQuery </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">NativeSearchQueryBuilder</span><span style="color:#24292E;">()                </span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//设置查询条件，此处可以使用QueryBuilders创建多种查询                </span></span>
<span class="line"><span style="color:#24292E;">        .</span><span style="color:#6F42C1;">withQuery</span><span style="color:#24292E;">(QueryBuilders</span></span>
<span class="line"><span style="color:#24292E;">                   .</span><span style="color:#6F42C1;">queryStringQuery</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;备份节点上没有数据&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">                   .</span><span style="color:#6F42C1;">defaultField</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;title&quot;</span><span style="color:#24292E;">))                </span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//还可以设置分页信息                </span></span>
<span class="line"><span style="color:#24292E;">        .</span><span style="color:#6F42C1;">withPageable</span><span style="color:#24292E;">(PageRequest.</span><span style="color:#6F42C1;">of</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">5</span><span style="color:#24292E;">))                </span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//创建SearchQuery对象                </span></span>
<span class="line"><span style="color:#24292E;">        .</span><span style="color:#6F42C1;">build</span><span style="color:#24292E;">();        </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//使用模板对象执行查询        </span></span>
<span class="line"><span style="color:#24292E;">    elasticsearchTemplate</span></span>
<span class="line"><span style="color:#24292E;">        .</span><span style="color:#6F42C1;">queryForList</span><span style="color:#24292E;">(searchQuery, Article.class)</span></span>
<span class="line"><span style="color:#24292E;">        .</span><span style="color:#6F42C1;">forEach</span><span style="color:#24292E;">(a</span><span style="color:#D73A49;">-&gt;</span><span style="color:#24292E;"> System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(a));    </span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div>`,263),t=[e];function c(r,E,y,i,u,d){return n(),a("div",null,t)}const q=s(o,[["render",c]]);export{g as __pageData,q as default};
